<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>xbo&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="xbo&#39;s Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="xbo&#39;s Blog">
<meta property="og:locale">
<meta property="article:author" content="xbo">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="xbo's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">xbo&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Python Cheatsheet" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/Python%20Cheatsheet/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.937Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Comprehensive-Python-Cheatsheet"><a href="#Comprehensive-Python-Cheatsheet" class="headerlink" title="Comprehensive Python Cheatsheet"></a>Comprehensive Python Cheatsheet</h1><p><sup><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/gto76/python-cheatsheet/master/README.md">Download text file</a>, <a target="_blank" rel="noopener" href="https://github.com/gto76/python-cheatsheet">Fork me on GitHub</a> or <a target="_blank" rel="noopener" href="https://github.com/gto76/python-cheatsheet/wiki/Frequently-Asked-Questions">Check out FAQ</a>.<br></sup></p>
<h2 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h2><p><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>1. Collections:</strong> <strong>&nbsp;</strong> <strong><a href="#list"><code>List</code></a></strong><strong>,</strong> <strong><a href="#dictionary"><code>Dictionary </code></a></strong><strong>,</strong> <strong><a href="#set"><code>Set</code></a></strong><strong>,</strong> <strong><a href="#tuple"><code>Tuple</code></a></strong><strong>,</strong> <strong><a href="#range"><code>Range</code></a></strong><strong>,</strong> <strong><a href="#enumerate"><code>Enumerate</code></a></strong><strong>,</strong> <strong><a href="#iterator"><code>Iterator</code></a></strong><strong>,</strong> <strong><a href="#generator"><code>Generator</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>2. Types:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#type"><code>Type</code></a></strong><strong>,</strong> <strong><a href="#string"><code>String</code></a></strong><strong>,</strong> <strong><a href="#regex"><code>Regular_Exp</code></a></strong><strong>,</strong> <strong><a href="#format"><code>Format</code></a></strong><strong>,</strong> <strong><a href="#numbers"><code>Numbers</code></a></strong><strong>,</strong> <strong><a href="#combinatorics"><code>Combinatorics</code></a></strong><strong>,</strong> <strong><a href="#datetime"><code>Datetime</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>3. Syntax:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#arguments"><code>Args</code></a></strong><strong>,</strong> <strong><a href="#inline"><code>Inline</code></a></strong><strong>,</strong> <strong><a href="#closure"><code>Closure</code></a></strong><strong>,</strong> <strong><a href="#decorator"><code>Decorator</code></a></strong><strong>,</strong> <strong><a href="#class"><code>Class</code></a></strong><strong>,</strong> <strong><a href="#duck-types"><code>Duck_Types</code></a></strong><strong>,</strong> <strong><a href="#enum"><code>Enum</code></a></strong><strong>,</strong> <strong><a href="#exceptions"><code>Exceptions</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>4. System:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#print"><code>Print</code></a></strong><strong>,</strong> <strong><a href="#input"><code>Input</code></a></strong><strong>,</strong> <strong><a href="#command-line-arguments"><code>Command_Line_Arguments</code></a></strong><strong>,</strong> <strong><a href="#open"><code>Open</code></a></strong><strong>,</strong> <strong><a href="#path"><code>Path</code></a></strong><strong>,</strong> <strong><a href="#command-execution"><code>Command_Execution</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>5. Data:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#csv"><code>CSV</code></a></strong><strong>,</strong> <strong><a href="#json"><code>JSON</code></a></strong><strong>,</strong> <strong><a href="#pickle"><code>Pickle</code></a></strong><strong>,</strong> <strong><a href="#sqlite"><code>SQLite</code></a></strong><strong>,</strong> <strong><a href="#bytes"><code>Bytes</code></a></strong><strong>,</strong> <strong><a href="#struct"><code>Struct</code></a></strong><strong>,</strong> <strong><a href="#array"><code>Array</code></a></strong><strong>,</strong> <strong><a href="#memory-view"><code>MemoryView</code></a></strong><strong>,</strong> <strong><a href="#deque"><code>Deque</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>6. Advanced:</strong> <strong>&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#threading"><code>Threading</code></a></strong><strong>,</strong> <strong><a href="#introspection"><code>Introspection</code></a></strong><strong>,</strong> <strong><a href="#metaprograming"><code>Metaprograming</code></a></strong><strong>,</strong> <strong><a href="#operator"><code>Operator</code></a></strong><strong>,</strong> <strong><a href="#eval"><code>Eval</code></a></strong><strong>,</strong> <strong><a href="#coroutine"><code>Coroutine</code></a></strong><strong>.</strong><br><strong>&nbsp;&nbsp;&nbsp;</strong> <strong>7. Libraries:</strong> <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>  <strong><a href="#progress-bar"><code>Progress_Bar</code></a></strong><strong>,</strong> <strong><a href="#plot"><code>Plot</code></a></strong><strong>,</strong> <strong><a href="#table"><code>Table</code></a></strong><strong>,</strong> <strong><a href="#curses"><code>Curses</code></a></strong><strong>,</strong> <strong><a href="#logging"><code>Logging</code></a></strong><strong>,</strong> <strong><a href="#scraping"><code>Scraping</code></a></strong><strong>,</strong> <strong><a href="#web"><code>Web</code></a></strong><strong>,</strong> <strong><a href="#profile"><code>Profile</code></a></strong><strong>,</strong><br><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong> <strong><a href="#numpy"><code>NumPy</code></a></strong><strong>,</strong> <strong><a href="#image"><code>Image</code></a></strong><strong>,</strong> <strong><a href="#audio"><code>Audio</code></a></strong><strong>.</strong></p>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:     <span class="comment"># Runs main() if file wasn&#x27;t imported.</span></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt; = &lt;<span class="built_in">list</span>&gt;[from_inclusive : to_exclusive : Â±step_size]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt;.append(&lt;el&gt;)            <span class="comment"># Or: &lt;list&gt; += [&lt;el&gt;]</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;.extend(&lt;collection&gt;)    <span class="comment"># Or: &lt;list&gt; += &lt;collection&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt;.sort()</span><br><span class="line">&lt;<span class="built_in">list</span>&gt;.reverse()</span><br><span class="line">&lt;<span class="built_in">list</span>&gt; = <span class="built_in">sorted</span>(&lt;collection&gt;)</span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = <span class="built_in">reversed</span>(&lt;<span class="built_in">list</span>&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sum_of_elements  = <span class="built_in">sum</span>(&lt;collection&gt;)</span><br><span class="line">elementwise_sum  = [<span class="built_in">sum</span>(pair) <span class="keyword">for</span> pair <span class="keyword">in</span> <span class="built_in">zip</span>(list_a, list_b)]</span><br><span class="line">sorted_by_second = <span class="built_in">sorted</span>(&lt;collection&gt;, key=<span class="keyword">lambda</span> el: el[<span class="number">1</span>])</span><br><span class="line">sorted_by_both   = <span class="built_in">sorted</span>(&lt;collection&gt;, key=<span class="keyword">lambda</span> el: (el[<span class="number">1</span>], el[<span class="number">0</span>]))</span><br><span class="line">flatter_list     = <span class="built_in">list</span>(itertools.chain.from_iterable(&lt;<span class="built_in">list</span>&gt;))</span><br><span class="line">product_of_elems = functools.reduce(<span class="keyword">lambda</span> out, x: out * x, &lt;collection&gt;)</span><br><span class="line">list_of_chars    = <span class="built_in">list</span>(&lt;<span class="built_in">str</span>&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">index = &lt;<span class="built_in">list</span>&gt;.index(&lt;el&gt;)     <span class="comment"># Returns index of first occurrence or raises ValueError.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;.insert(index, &lt;el&gt;)     <span class="comment"># Inserts item at index and moves the rest to the right.</span></span><br><span class="line">&lt;el&gt; = &lt;<span class="built_in">list</span>&gt;.pop([index])     <span class="comment"># Removes and returns item at index or from the end.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;.remove(&lt;el&gt;)            <span class="comment"># Removes first occurrence of item or raises ValueError.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;.clear()                 <span class="comment"># Removes all items. Also works on dict and set.</span></span><br></pre></td></tr></table></figure>


<h2 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a>Dictionary</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt; = &lt;<span class="built_in">dict</span>&gt;.keys()                          <span class="comment"># Coll. of keys that reflects changes.</span></span><br><span class="line">&lt;view&gt; = &lt;<span class="built_in">dict</span>&gt;.values()                        <span class="comment"># Coll. of values that reflects changes.</span></span><br><span class="line">&lt;view&gt; = &lt;<span class="built_in">dict</span>&gt;.items()                         <span class="comment"># Coll. of key-value tuples.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">value  = &lt;<span class="built_in">dict</span>&gt;.get(key, default=<span class="literal">None</span>)          <span class="comment"># Returns default if key does not exist.</span></span><br><span class="line">value  = &lt;<span class="built_in">dict</span>&gt;.setdefault(key, default=<span class="literal">None</span>)   <span class="comment"># Same, but also adds default to dict.</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = collections.defaultdict(&lt;<span class="built_in">type</span>&gt;)        <span class="comment"># Creates a dict with default value of type.</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = collections.defaultdict(<span class="keyword">lambda</span>: <span class="number">1</span>)     <span class="comment"># Creates a dict with default value 1.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">dict</span>&gt;.update(&lt;<span class="built_in">dict</span>&gt;)</span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = <span class="built_in">dict</span>(&lt;collection&gt;)                     <span class="comment"># Creates a dict from coll. of key-value pairs.</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = <span class="built_in">dict</span>(<span class="built_in">zip</span>(keys, values))                <span class="comment"># Creates a dict from two collections.</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = <span class="built_in">dict</span>.fromkeys(keys [, value])          <span class="comment"># Creates a dict from collection of keys.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">value = &lt;<span class="built_in">dict</span>&gt;.pop(key)                         <span class="comment"># Removes item from dictionary.</span></span><br><span class="line">&#123;k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> &lt;<span class="built_in">dict</span>&gt;.items() <span class="keyword">if</span> k <span class="keyword">in</span> keys&#125;  <span class="comment"># Filters dictionary by keys.</span></span><br></pre></td></tr></table></figure>

<h3 id="Counter"><a href="#Counter" class="headerlink" title="Counter"></a>Counter</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>colors = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;yellow&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = Counter(colors)</span><br><span class="line">Counter(&#123;<span class="string">&#x27;blue&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;red&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;yellow&#x27;</span>: <span class="number">1</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter.most_common()[<span class="number">0</span>]</span><br><span class="line">(<span class="string">&#x27;blue&#x27;</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">set</span>&gt; = <span class="built_in">set</span>()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">set</span>&gt;.add(&lt;el&gt;)                               <span class="comment"># Or: &lt;set&gt; |= &#123;&lt;el&gt;&#125;</span></span><br><span class="line">&lt;<span class="built_in">set</span>&gt;.update(&lt;collection&gt;)                    <span class="comment"># Or: &lt;set&gt; |= &lt;set&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">set</span>&gt;  = &lt;<span class="built_in">set</span>&gt;.union(&lt;coll.&gt;)                 <span class="comment"># Or: &lt;set&gt; | &lt;set&gt;</span></span><br><span class="line">&lt;<span class="built_in">set</span>&gt;  = &lt;<span class="built_in">set</span>&gt;.intersection(&lt;coll.&gt;)          <span class="comment"># Or: &lt;set&gt; &amp; &lt;set&gt;</span></span><br><span class="line">&lt;<span class="built_in">set</span>&gt;  = &lt;<span class="built_in">set</span>&gt;.difference(&lt;coll.&gt;)            <span class="comment"># Or: &lt;set&gt; - &lt;set&gt;</span></span><br><span class="line">&lt;<span class="built_in">set</span>&gt;  = &lt;<span class="built_in">set</span>&gt;.symmetric_difference(&lt;coll.&gt;)  <span class="comment"># Or: &lt;set&gt; ^ &lt;set&gt;</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;<span class="built_in">set</span>&gt;.issubset(&lt;coll.&gt;)              <span class="comment"># Or: &lt;set&gt; &lt;= &lt;set&gt;</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;<span class="built_in">set</span>&gt;.issuperset(&lt;coll.&gt;)            <span class="comment"># Or: &lt;set&gt; &gt;= &lt;set&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">set</span>&gt;.remove(&lt;el&gt;)                            <span class="comment"># Raises KeyError.</span></span><br><span class="line">&lt;<span class="built_in">set</span>&gt;.discard(&lt;el&gt;)                           <span class="comment"># Doesn&#x27;t raise an error.</span></span><br></pre></td></tr></table></figure>

<h3 id="Frozen-Set"><a href="#Frozen-Set" class="headerlink" title="Frozen Set"></a>Frozen Set</h3><ul>
<li><strong>Is immutable and hashable.</strong></li>
<li><strong>That means it can be used as a key in a dictionary or as an element in a set.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">frozenset</span>&gt; = <span class="built_in">frozenset</span>(&lt;collection&gt;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Tuple"><a href="#Tuple" class="headerlink" title="Tuple"></a>Tuple</h2><p><strong>Tuple is an immutable and hashable list.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">tuple</span>&gt; = ()</span><br><span class="line">&lt;<span class="built_in">tuple</span>&gt; = (&lt;el&gt;, )</span><br><span class="line">&lt;<span class="built_in">tuple</span>&gt; = (&lt;el_1&gt;, &lt;el_2&gt;, ...)</span><br></pre></td></tr></table></figure>

<h3 id="Named-Tuple"><a href="#Named-Tuple" class="headerlink" title="Named Tuple"></a>Named Tuple</h3><p><strong>Tupleâs subclass with named elements.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Point = namedtuple(<span class="string">&#x27;Point&#x27;</span>, <span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Point(<span class="number">1</span>, y=<span class="number">2</span>)</span><br><span class="line">Point(x=<span class="number">1</span>, y=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p[<span class="number">0</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.x</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(p, <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p._fields  <span class="comment"># Or: Point._fields</span></span><br><span class="line">(<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Range"><a href="#Range" class="headerlink" title="Range"></a>Range</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">range</span>&gt; = <span class="built_in">range</span>(to_exclusive)</span><br><span class="line">&lt;<span class="built_in">range</span>&gt; = <span class="built_in">range</span>(from_inclusive, to_exclusive)</span><br><span class="line">&lt;<span class="built_in">range</span>&gt; = <span class="built_in">range</span>(from_inclusive, to_exclusive, Â±step_size)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from_inclusive = &lt;<span class="built_in">range</span>&gt;.start</span><br><span class="line">to_exclusive   = &lt;<span class="built_in">range</span>&gt;.stop</span><br></pre></td></tr></table></figure>


<h2 id="Enumerate"><a href="#Enumerate" class="headerlink" title="Enumerate"></a>Enumerate</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, el <span class="keyword">in</span> <span class="built_in">enumerate</span>(&lt;collection&gt; [, i_start]):</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>


<h2 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a>Iterator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">iter</span>&gt; = <span class="built_in">iter</span>(&lt;collection&gt;)                 <span class="comment"># Calling `iter(&lt;iter&gt;)` returns unmodified iterator.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = <span class="built_in">iter</span>(&lt;function&gt;, to_exclusive)     <span class="comment"># Sequence of return values until &#x27;to_exclusive&#x27;.</span></span><br><span class="line">&lt;el&gt;   = <span class="built_in">next</span>(&lt;<span class="built_in">iter</span>&gt; [, default])           <span class="comment"># Raises StopIteration or returns &#x27;default&#x27; on end.</span></span><br></pre></td></tr></table></figure>

<h3 id="Itertools"><a href="#Itertools" class="headerlink" title="Itertools"></a>Itertools</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> count, repeat, cycle, chain, islice</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">iter</span>&gt; = count(start=<span class="number">0</span>, step=<span class="number">1</span>)             <span class="comment"># Returns incremented value endlessly.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = repeat(&lt;el&gt; [, times])             <span class="comment"># Returns element endlessly or &#x27;times&#x27; times.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = cycle(&lt;collection&gt;)                <span class="comment"># Repeats the sequence indefinitely.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">iter</span>&gt; = chain(&lt;coll.&gt;, &lt;coll.&gt; [, ...])    <span class="comment"># Empties collections in order.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = chain.from_iterable(&lt;collection&gt;)  <span class="comment"># Empties collections inside a collection in order.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">iter</span>&gt; = islice(&lt;collection&gt;, to_exclusive)</span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = islice(&lt;collection&gt;, from_inclusive, to_exclusive)</span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = islice(&lt;collection&gt;, from_inclusive, to_exclusive, +step_size)</span><br></pre></td></tr></table></figure>


<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><ul>
<li><strong>Convenient way to implement the iterator protocol.</strong></li>
<li><strong>Any function that contains a yield statement returns a generator object.</strong></li>
<li><strong>Generators and iterators are interchangeable.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>(<span class="params">start, step</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> start</span><br><span class="line">        start += step</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = count(<span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">next</span>(counter), <span class="built_in">next</span>(counter), <span class="built_in">next</span>(counter)</span><br><span class="line">(<span class="number">10</span>, <span class="number">12</span>, <span class="number">14</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h2><ul>
<li><strong>Everything is an object.</strong></li>
<li><strong>Every object has a type.</strong></li>
<li><strong>Type and class are synonymous.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">type</span>&gt; = <span class="built_in">type</span>(&lt;el&gt;)                <span class="comment"># Or: &lt;el&gt;.__class__</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = <span class="built_in">isinstance</span>(&lt;el&gt;, &lt;<span class="built_in">type</span>&gt;)  <span class="comment"># Or: issubclass(type(&lt;el&gt;), &lt;type&gt;)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="string">&#x27;a&#x27;</span>), <span class="string">&#x27;a&#x27;</span>.__class__, <span class="built_in">str</span></span><br><span class="line">(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;)</span><br></pre></td></tr></table></figure>

<h4 id="Some-types-do-not-have-builtin-names-so-they-must-be-imported"><a href="#Some-types-do-not-have-builtin-names-so-they-must-be-imported" class="headerlink" title="Some types do not have builtin names, so they must be imported:"></a>Some types do not have builtin names, so they must be imported:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> FunctionType, MethodType, LambdaType, GeneratorType</span><br></pre></td></tr></table></figure>

<h3 id="ABC"><a href="#ABC" class="headerlink" title="ABC"></a>ABC</h3><p><strong>An abstract base class introduces virtual subclasses, that donât inherit from it but are still recognized by isinstance() and issubclass().</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections.abc <span class="keyword">import</span> <span class="type">Sequence</span>, Collection, Iterable</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">isinstance</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], Iterable)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------------------+----------+------------+----------+</span><br><span class="line">|                  | Sequence | Collection | Iterable |</span><br><span class="line">+------------------+----------+------------+----------+</span><br><span class="line">| list, range, str |   yes    |    yes     |   yes    |</span><br><span class="line">| dict, set        |          |    yes     |   yes    |</span><br><span class="line">| iter             |          |            |   yes    |</span><br><span class="line">+------------------+----------+------------+----------+</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> numbers <span class="keyword">import</span> Integral, Rational, Real, Complex, Number</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">isinstance</span>(<span class="number">123</span>, Number)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+--------------------+----------+----------+------+---------+--------+</span><br><span class="line">|                    | Integral | Rational | Real | Complex | Number |</span><br><span class="line">+--------------------+----------+----------+------+---------+--------+</span><br><span class="line">| int                |   yes    |   yes    | yes  |   yes   |  yes   |</span><br><span class="line">| fractions.Fraction |          |   yes    | yes  |   yes   |  yes   |</span><br><span class="line">| float              |          |          | yes  |   yes   |  yes   |</span><br><span class="line">| complex            |          |          |      |   yes   |  yes   |</span><br><span class="line">+--------------------+----------+----------+------+---------+--------+</span><br></pre></td></tr></table></figure>


<h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;<span class="built_in">str</span>&gt;.strip()                       <span class="comment"># Strips all whitespace characters from both ends.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;<span class="built_in">str</span>&gt;.strip(<span class="string">&#x27;&lt;chars&gt;&#x27;</span>)              <span class="comment"># Strips all passed characters from both ends.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt; = &lt;<span class="built_in">str</span>&gt;.split()                       <span class="comment"># Splits on one or more whitespace characters.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt; = &lt;<span class="built_in">str</span>&gt;.split(sep=<span class="literal">None</span>, maxsplit=-<span class="number">1</span>)  <span class="comment"># Splits on &#x27;sep&#x27; str at most &#x27;maxsplit&#x27; times.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt; = &lt;<span class="built_in">str</span>&gt;.splitlines(keepends=<span class="literal">False</span>)    <span class="comment"># Splits on line breaks. Keeps them if &#x27;keepends&#x27;.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;<span class="built_in">str</span>&gt;.join(&lt;coll_of_strings&gt;)       <span class="comment"># Joins elements using string as separator.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;sub_str&gt; <span class="keyword">in</span> &lt;<span class="built_in">str</span>&gt;                  <span class="comment"># Checks if string contains a substring.</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;<span class="built_in">str</span>&gt;.startswith(&lt;sub_str&gt;)         <span class="comment"># Pass tuple of strings for multiple options.</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;<span class="built_in">str</span>&gt;.endswith(&lt;sub_str&gt;)           <span class="comment"># Pass tuple of strings for multiple options.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;  = &lt;<span class="built_in">str</span>&gt;.find(&lt;sub_str&gt;)               <span class="comment"># Returns start index of first match or -1.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;  = &lt;<span class="built_in">str</span>&gt;.index(&lt;sub_str&gt;)              <span class="comment"># Same but raises ValueError.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;<span class="built_in">str</span>&gt;.replace(old, new [, count])   <span class="comment"># Replaces &#x27;old&#x27; with &#x27;new&#x27; at most &#x27;count&#x27; times.</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;<span class="built_in">str</span>&gt;.isnumeric()                   <span class="comment"># True if str contains only numeric characters.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt; = textwrap.wrap(&lt;<span class="built_in">str</span>&gt;, width)         <span class="comment"># Nicely breaks string into lines.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Also: <code>&#39;lstrip()&#39;</code>, <code>&#39;rstrip()&#39;</code>.</strong></li>
<li><strong>Also: <code>&#39;lower()&#39;</code>, <code>&#39;upper()&#39;</code>, <code>&#39;capitalize()&#39;</code> and <code>&#39;title()&#39;</code>.</strong></li>
</ul>
<h3 id="Char"><a href="#Char" class="headerlink" title="Char"></a>Char</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt; = <span class="built_in">chr</span>(&lt;<span class="built_in">int</span>&gt;)  <span class="comment"># Converts int to unicode char.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt; = <span class="built_in">ord</span>(&lt;<span class="built_in">str</span>&gt;)  <span class="comment"># Converts unicode char to int.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">(<span class="number">48</span>, <span class="number">57</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">(<span class="number">65</span>, <span class="number">90</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">(<span class="number">97</span>, <span class="number">122</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Regex"><a href="#Regex" class="headerlink" title="Regex"></a>Regex</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">&lt;<span class="built_in">str</span>&gt;   = re.sub(&lt;regex&gt;, new, text, count=<span class="number">0</span>)  <span class="comment"># Substitutes all occurrences.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;  = re.findall(&lt;regex&gt;, text)            <span class="comment"># Returns all occurrences.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;  = re.split(&lt;regex&gt;, text, maxsplit=<span class="number">0</span>)  <span class="comment"># Use brackets in regex to keep the matches.</span></span><br><span class="line">&lt;Match&gt; = re.search(&lt;regex&gt;, text)             <span class="comment"># Searches for first occurrence of pattern.</span></span><br><span class="line">&lt;Match&gt; = re.match(&lt;regex&gt;, text)              <span class="comment"># Searches only at the beginning of the text.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt;  = re.finditer(&lt;regex&gt;, text)           <span class="comment"># Returns all occurrences as match objects.</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Argument <code>&#39;flags=re.IGNORECASE&#39;</code> can be used with all functions.</strong></li>
<li><strong>Argument <code>&#39;flags=re.MULTILINE&#39;</code> makes <code>&#39;^&#39;</code> and <code>&#39;$&#39;</code> match the start/end of each line.</strong></li>
<li><strong>Argument <code>&#39;flags=re.DOTALL&#39;</code> makes dot also accept newline.</strong></li>
<li><strong>Use <code>r&#39;\1&#39;</code> or <code>&#39;\\1&#39;</code> for backreference.</strong></li>
<li><strong>Use <code>&#39;?&#39;</code> to make an operator non-greedy.</strong></li>
</ul>
<h3 id="Match-Object"><a href="#Match-Object" class="headerlink" title="Match Object"></a>Match Object</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;   = &lt;Match&gt;.group()   <span class="comment"># Whole match. Also group(0).</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;   = &lt;Match&gt;.group(<span class="number">1</span>)  <span class="comment"># Part in first bracket.</span></span><br><span class="line">&lt;<span class="built_in">tuple</span>&gt; = &lt;Match&gt;.groups()  <span class="comment"># All bracketed parts.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;   = &lt;Match&gt;.start()   <span class="comment"># Start index of a match.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;   = &lt;Match&gt;.end()     <span class="comment"># Exclusive end index of a match.</span></span><br></pre></td></tr></table></figure>

<h3 id="Special-Sequences"><a href="#Special-Sequences" class="headerlink" title="Special Sequences"></a>Special Sequences</h3><ul>
<li><strong>By default digits, whitespaces and alphanumerics from all alphabets are matched, unless <code>&#39;flags=re.ASCII&#39;</code> argument is used.</strong></li>
<li><strong>Use capital letters for negation.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;\d&#x27;</span> == <span class="string">&#x27;[0-9]&#x27;</span>             <span class="comment"># Digit</span></span><br><span class="line"><span class="string">&#x27;\s&#x27;</span> == <span class="string">&#x27;[ \t\n\r\f\v]&#x27;</span>     <span class="comment"># Whitespace</span></span><br><span class="line"><span class="string">&#x27;\w&#x27;</span> == <span class="string">&#x27;[a-zA-Z0-9_]&#x27;</span>      <span class="comment"># Alphanumeric</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Format"><a href="#Format" class="headerlink" title="Format"></a>Format</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt; = <span class="string">f&#x27;<span class="subst">&#123;&lt;el_1&gt;&#125;</span>, <span class="subst">&#123;&lt;el_2&gt;&#125;</span>&#x27;</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt; = <span class="string">&#x27;&#123;&#125;, &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(&lt;el_1&gt;, &lt;el_2&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Attributes"><a href="#Attributes" class="headerlink" title="Attributes"></a>Attributes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Person = namedtuple(<span class="string">&#x27;Person&#x27;</span>, <span class="string">&#x27;name height&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>person = Person(<span class="string">&#x27;Jean-Luc&#x27;</span>, <span class="number">187</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f&#x27;<span class="subst">&#123;person.height&#125;</span>&#x27;</span></span><br><span class="line"><span class="string">&#x27;187&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#123;p.height&#125;&#x27;</span>.<span class="built_in">format</span>(p=person)</span><br><span class="line"><span class="string">&#x27;187&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="General-Options"><a href="#General-Options" class="headerlink" title="General Options"></a>General Options</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&lt;el&gt;:&lt;<span class="number">10</span>&#125;       <span class="comment"># &#x27;&lt;el&gt;      &#x27;</span></span><br><span class="line">&#123;&lt;el&gt;:^<span class="number">10</span>&#125;       <span class="comment"># &#x27;   &lt;el&gt;   &#x27;</span></span><br><span class="line">&#123;&lt;el&gt;:&gt;<span class="number">10</span>&#125;       <span class="comment"># &#x27;      &lt;el&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&lt;el&gt;:.&lt;<span class="number">10</span>&#125;      <span class="comment"># &#x27;&lt;el&gt;......&#x27;</span></span><br><span class="line">&#123;&lt;el&gt;:&gt;<span class="number">0</span>&#125;        <span class="comment"># &#x27;&lt;el&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h3><p><strong><code>&#39;!r&#39;</code> calls objectâs repr() method, instead of str(), to get a string.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;abcde&#x27;</span>!r:&lt;<span class="number">10</span>&#125;  <span class="comment"># &quot;&#x27;abcde&#x27;   &quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;abcde&#x27;</span>:<span class="number">.3</span>&#125;     <span class="comment"># &#x27;abc&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;abcde&#x27;</span>:<span class="number">10.3</span>&#125;   <span class="comment"># &#x27;abc       &#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Numbers"><a href="#Numbers" class="headerlink" title="Numbers"></a>Numbers</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="number">123456</span>:<span class="number">10</span>,&#125;    <span class="comment"># &#x27;   123,456&#x27;</span></span><br><span class="line">&#123; <span class="number">123456</span>:10_&#125;    <span class="comment"># &#x27;   123_456&#x27;</span></span><br><span class="line">&#123; <span class="number">123456</span>:+<span class="number">10</span>&#125;    <span class="comment"># &#x27;   +123456&#x27;</span></span><br><span class="line">&#123;-<span class="number">123456</span>:=<span class="number">10</span>&#125;    <span class="comment"># &#x27;-   123456&#x27;</span></span><br><span class="line">&#123; <span class="number">123456</span>: &#125;      <span class="comment"># &#x27; 123456&#x27;</span></span><br><span class="line">&#123;-<span class="number">123456</span>: &#125;      <span class="comment"># &#x27;-123456&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Floats"><a href="#Floats" class="headerlink" title="Floats"></a>Floats</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>&#125;   <span class="comment"># &#x27;      1.23&#x27;</span></span><br><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>f&#125;  <span class="comment"># &#x27;     1.235&#x27;</span></span><br><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>e&#125;  <span class="comment"># &#x27; 1.235e+00&#x27;</span></span><br><span class="line">&#123;<span class="number">1.23456</span>:<span class="number">10.3</span>%&#125;  <span class="comment"># &#x27;  123.456%&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="Comparison-of-float-presentation-types"><a href="#Comparison-of-float-presentation-types" class="headerlink" title="Comparison of float presentation types:"></a>Comparison of float presentation types:</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+----------------+----------------+---------------+----------------+-----------------+</span><br><span class="line">|                |    &#123;&lt;float&gt;&#125;   |  &#123;&lt;float&gt;:f&#125;  |   &#123;&lt;float&gt;:e&#125;  |   &#123;&lt;float&gt;:%&#125;   |</span><br><span class="line">+----------------+----------------+---------------+----------------+-----------------+</span><br><span class="line">|    0.000056789 |   &#x27;5.6789e-05&#x27; |    &#x27;0.000057&#x27; | &#x27;5.678900e-05&#x27; |     &#x27;0.005679%&#x27; |</span><br><span class="line">|    0.00056789  |   &#x27;0.00056789&#x27; |    &#x27;0.000568&#x27; | &#x27;5.678900e-04&#x27; |     &#x27;0.056789%&#x27; |</span><br><span class="line">|    0.0056789   |   &#x27;0.0056789&#x27;  |    &#x27;0.005679&#x27; | &#x27;5.678900e-03&#x27; |     &#x27;0.567890%&#x27; |</span><br><span class="line">|    0.056789    |   &#x27;0.056789&#x27;   |    &#x27;0.056789&#x27; | &#x27;5.678900e-02&#x27; |     &#x27;5.678900%&#x27; |</span><br><span class="line">|    0.56789     |   &#x27;0.56789&#x27;    |    &#x27;0.567890&#x27; | &#x27;5.678900e-01&#x27; |    &#x27;56.789000%&#x27; |</span><br><span class="line">|    5.6789      |   &#x27;5.6789&#x27;     |    &#x27;5.678900&#x27; | &#x27;5.678900e+00&#x27; |   &#x27;567.890000%&#x27; |</span><br><span class="line">|   56.789       |  &#x27;56.789&#x27;      |   &#x27;56.789000&#x27; | &#x27;5.678900e+01&#x27; |  &#x27;5678.900000%&#x27; |</span><br><span class="line">|  567.89        | &#x27;567.89&#x27;       |  &#x27;567.890000&#x27; | &#x27;5.678900e+02&#x27; | &#x27;56789.000000%&#x27; |</span><br><span class="line">+----------------+----------------+---------------+----------------+-----------------+</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+----------------+----------------+---------------+----------------+-----------------+</span><br><span class="line">|                |  &#123;&lt;float&gt;:.2&#125;  | &#123;&lt;float&gt;:.2f&#125; |  &#123;&lt;float&gt;:.2e&#125; |  &#123;&lt;float&gt;:.2%&#125;  |</span><br><span class="line">+----------------+----------------+---------------+----------------+-----------------+</span><br><span class="line">|    0.000056789 |   &#x27;5.7e-05&#x27;    |      &#x27;0.00&#x27;   |   &#x27;5.68e-05&#x27;   |       &#x27;0.01%&#x27;   |</span><br><span class="line">|    0.00056789  |   &#x27;0.00057&#x27;    |      &#x27;0.00&#x27;   |   &#x27;5.68e-04&#x27;   |       &#x27;0.06%&#x27;   |</span><br><span class="line">|    0.0056789   |   &#x27;0.0057&#x27;     |      &#x27;0.01&#x27;   |   &#x27;5.68e-03&#x27;   |       &#x27;0.57%&#x27;   |</span><br><span class="line">|    0.056789    |   &#x27;0.057&#x27;      |      &#x27;0.06&#x27;   |   &#x27;5.68e-02&#x27;   |       &#x27;5.68%&#x27;   |</span><br><span class="line">|    0.56789     |   &#x27;0.57&#x27;       |      &#x27;0.57&#x27;   |   &#x27;5.68e-01&#x27;   |      &#x27;56.79%&#x27;   |</span><br><span class="line">|    5.6789      |   &#x27;5.7&#x27;        |      &#x27;5.68&#x27;   |   &#x27;5.68e+00&#x27;   |     &#x27;567.89%&#x27;   |</span><br><span class="line">|   56.789       |   &#x27;5.7e+01&#x27;    |     &#x27;56.79&#x27;   |   &#x27;5.68e+01&#x27;   |    &#x27;5678.90%&#x27;   |</span><br><span class="line">|  567.89        |   &#x27;5.7e+02&#x27;    |    &#x27;567.89&#x27;   |   &#x27;5.68e+02&#x27;   |   &#x27;56789.00%&#x27;   |</span><br><span class="line">+----------------+----------------+---------------+----------------+-----------------+</span><br></pre></td></tr></table></figure>

<h3 id="Ints"><a href="#Ints" class="headerlink" title="Ints"></a>Ints</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">90</span>:c&#125;           <span class="comment"># &#x27;Z&#x27;</span></span><br><span class="line">&#123;<span class="number">90</span>:X&#125;           <span class="comment"># &#x27;5A&#x27;</span></span><br><span class="line">&#123;<span class="number">90</span>:b&#125;           <span class="comment"># &#x27;1011010&#x27;</span></span><br></pre></td></tr></table></figure>


<h2 id="Numbers-1"><a href="#Numbers-1" class="headerlink" title="Numbers"></a>Numbers</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">int</span>&gt;      = <span class="built_in">int</span>(&lt;<span class="built_in">float</span>/<span class="built_in">str</span>/<span class="built_in">bool</span>&gt;)    <span class="comment"># Or: math.floor(&lt;float&gt;)</span></span><br><span class="line">&lt;<span class="built_in">float</span>&gt;    = <span class="built_in">float</span>(&lt;<span class="built_in">int</span>/<span class="built_in">str</span>/<span class="built_in">bool</span>&gt;)</span><br><span class="line">&lt;<span class="built_in">complex</span>&gt;  = <span class="built_in">complex</span>(real=<span class="number">0</span>, imag=<span class="number">0</span>)  <span class="comment"># Or: &lt;real&gt; + &lt;real&gt;j</span></span><br><span class="line">&lt;Fraction&gt; = fractions.Fraction(numerator=<span class="number">0</span>, denominator=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>&#39;int(&lt;str&gt;)&#39;</code> and <code>&#39;float(&lt;str&gt;)&#39;</code> raise âValueErrorâ on malformed strings.</strong></li>
</ul>
<h3 id="Basic-Functions"><a href="#Basic-Functions" class="headerlink" title="Basic Functions"></a>Basic Functions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;num&gt;  = <span class="built_in">pow</span>(&lt;num&gt;, &lt;num&gt;)            <span class="comment"># Or: &lt;num&gt; ** &lt;num&gt;</span></span><br><span class="line">&lt;real&gt; = <span class="built_in">abs</span>(&lt;num&gt;)</span><br><span class="line">&lt;<span class="built_in">int</span>&gt;  = <span class="built_in">round</span>(&lt;real&gt;)</span><br><span class="line">&lt;real&gt; = <span class="built_in">round</span>(&lt;real&gt;, Â±ndigits)      <span class="comment"># `round(126, -1) == 130`</span></span><br></pre></td></tr></table></figure>

<h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> e, pi, inf, nan</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> cos, acos, sin, asin, tan, atan, degrees, radians</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log, log10, log2</span><br></pre></td></tr></table></figure>

<h3 id="Statistics"><a href="#Statistics" class="headerlink" title="Statistics"></a>Statistics</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statistics <span class="keyword">import</span> mean, median, variance, pvariance, pstdev</span><br></pre></td></tr></table></figure>

<h3 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> random, randint, choice, shuffle</span><br><span class="line">&lt;<span class="built_in">float</span>&gt; = random()</span><br><span class="line">&lt;<span class="built_in">int</span>&gt;   = randint(from_inclusive, to_inclusive)</span><br><span class="line">&lt;el&gt;    = choice(&lt;<span class="built_in">list</span>&gt;)</span><br><span class="line">shuffle(&lt;<span class="built_in">list</span>&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Bin-Hex"><a href="#Bin-Hex" class="headerlink" title="Bin, Hex"></a>Bin, Hex</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">int</span>&gt;     = 0b&lt;<span class="built_in">bin</span>&gt;            <span class="comment"># Or: 0x&lt;hex&gt;</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = <span class="built_in">int</span>(<span class="string">&#x27;0b&lt;bin&gt;&#x27;</span>, <span class="number">0</span>)  <span class="comment"># Or: int(&#x27;0x&lt;hex&gt;&#x27;, 0)</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = <span class="built_in">int</span>(<span class="string">&#x27;&lt;bin&gt;&#x27;</span>, <span class="number">2</span>)    <span class="comment"># Or: int(&#x27;&lt;hex&gt;&#x27;, 16)</span></span><br><span class="line"><span class="string">&#x27;0b&lt;bin&gt;&#x27;</span> = <span class="built_in">bin</span>(&lt;<span class="built_in">int</span>&gt;)         <span class="comment"># Or: &#x27;0x&lt;hex&gt;&#x27; = hex(&lt;int&gt;)</span></span><br></pre></td></tr></table></figure>

<h3 id="Bitwise-Operators"><a href="#Bitwise-Operators" class="headerlink" title="Bitwise Operators"></a>Bitwise Operators</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">int</span>&gt;     = &lt;<span class="built_in">int</span>&gt; &amp; &lt;<span class="built_in">int</span>&gt;      <span class="comment"># And</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = &lt;<span class="built_in">int</span>&gt; | &lt;<span class="built_in">int</span>&gt;      <span class="comment"># Or</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = &lt;<span class="built_in">int</span>&gt; ^ &lt;<span class="built_in">int</span>&gt;      <span class="comment"># Xor (0 if both bits equal)</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = &lt;<span class="built_in">int</span>&gt; &lt;&lt; n_bits    <span class="comment"># Shift left</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = &lt;<span class="built_in">int</span>&gt; &gt;&gt; n_bits    <span class="comment"># Shift right</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;     = ~&lt;<span class="built_in">int</span>&gt;             <span class="comment"># Compliment (flips bits)</span></span><br></pre></td></tr></table></figure>


<h2 id="Combinatorics"><a href="#Combinatorics" class="headerlink" title="Combinatorics"></a>Combinatorics</h2><ul>
<li><strong>Every function returns an iterator.</strong></li>
<li><strong>If you want to print the iterator, you need to pass it to the list() function!</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product, combinations, combinations_with_replacement, permutations</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>product([<span class="number">0</span>, <span class="number">1</span>], repeat=<span class="number">3</span>)</span><br><span class="line">[(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>), (<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line"> (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>product(<span class="string">&#x27;ab&#x27;</span>, <span class="string">&#x27;12&#x27;</span>)</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1&#x27;</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;2&#x27;</span>),</span><br><span class="line"> (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;1&#x27;</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>combinations(<span class="string">&#x27;abc&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>combinations_with_replacement(<span class="string">&#x27;abc&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>),</span><br><span class="line"> (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>),</span><br><span class="line"> (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>permutations(<span class="string">&#x27;abc&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>),</span><br><span class="line"> (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>),</span><br><span class="line"> (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>)]</span><br></pre></td></tr></table></figure>


<h2 id="Datetime"><a href="#Datetime" class="headerlink" title="Datetime"></a>Datetime</h2><ul>
<li><strong>Module âdatetimeâ provides âdateâ <code>&lt;D&gt;</code>, âtimeâ <code>&lt;T&gt;</code>, âdatetimeâ <code>&lt;DT&gt;</code> and âtimedeltaâ <code>&lt;TD&gt;</code> classes. All are immutable and hashable.</strong></li>
<li><strong>Time and datetime can be âawareâ <code>&lt;a&gt;</code>, meaning they have defined timezone, or ânaiveâ <code>&lt;n&gt;</code>, meaning they donât.</strong></li>
<li><strong>If object is naive it is presumed to be in systemâs timezone.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date, time, datetime, timedelta</span><br><span class="line"><span class="keyword">from</span> dateutil.tz <span class="keyword">import</span> UTC, tzlocal, gettz</span><br></pre></td></tr></table></figure>

<h3 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;D&gt;  = date(year, month, day)</span><br><span class="line">&lt;T&gt;  = time(hour=<span class="number">0</span>, minute=<span class="number">0</span>, second=<span class="number">0</span>, microsecond=<span class="number">0</span>, tzinfo=<span class="literal">None</span>, fold=<span class="number">0</span>)</span><br><span class="line">&lt;DT&gt; = datetime(year, month, day, hour=<span class="number">0</span>, minute=<span class="number">0</span>, second=<span class="number">0</span>, ...)</span><br><span class="line">&lt;TD&gt; = timedelta(days=<span class="number">0</span>, seconds=<span class="number">0</span>, microseconds=<span class="number">0</span>, milliseconds=<span class="number">0</span>,</span><br><span class="line">                 minutes=<span class="number">0</span>, hours=<span class="number">0</span>, weeks=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Use <code>&#39;&lt;D/DT&gt;.weekday()&#39;</code> to get the day of the week (Mon == 0).</strong></li>
<li><strong><code>&#39;fold=1&#39;</code> means second pass in case of time jumping back for one hour.</strong></li>
</ul>
<h3 id="Now"><a href="#Now" class="headerlink" title="Now"></a>Now</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;D/DTn&gt;  = D/DT.today()                     <span class="comment"># Current local date or naive datetime.</span></span><br><span class="line">&lt;DTn&gt;    = DT.utcnow()                      <span class="comment"># Naive datetime from current UTC time.</span></span><br><span class="line">&lt;DTa&gt;    = DT.now(&lt;tzinfo&gt;)                 <span class="comment"># Aware datetime from current tz time.</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>To extract time use <code>&#39;&lt;DTn&gt;.time()&#39;</code>, <code>&#39;&lt;DTa&gt;.time()&#39;</code> or <code>&#39;&lt;DTa&gt;.timetz()&#39;</code>.</strong></li>
</ul>
<h3 id="Timezone"><a href="#Timezone" class="headerlink" title="Timezone"></a>Timezone</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;tzinfo&gt; = UTC                              <span class="comment"># UTC timezone. London without DST.</span></span><br><span class="line">&lt;tzinfo&gt; = tzlocal()                        <span class="comment"># Local timezone. Also gettz().</span></span><br><span class="line">&lt;tzinfo&gt; = gettz(<span class="string">&#x27;&lt;Cont.&gt;/&lt;City&gt;&#x27;</span>)          <span class="comment"># Timezone from &#x27;Continent/City_Name&#x27; str.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;DTa&gt;    = &lt;DT&gt;.astimezone(&lt;tzinfo&gt;)        <span class="comment"># Datetime, converted to passed timezone.</span></span><br><span class="line">&lt;Ta/DTa&gt; = &lt;T/DT&gt;.replace(tzinfo=&lt;tzinfo&gt;)  <span class="comment"># Unconverted object with new timezone.</span></span><br></pre></td></tr></table></figure>

<h3 id="Encode"><a href="#Encode" class="headerlink" title="Encode"></a>Encode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;D/T/DT&gt; = D/T/DT.fromisoformat(<span class="string">&#x27;&lt;iso&gt;&#x27;</span>)    <span class="comment"># Object from ISO string.</span></span><br><span class="line">&lt;DT&gt;     = DT.strptime(&lt;<span class="built_in">str</span>&gt;, <span class="string">&#x27;&lt;format&gt;&#x27;</span>)   <span class="comment"># Datetime from str, according to format.</span></span><br><span class="line">&lt;D/DTn&gt;  = D/DT.fromordinal(&lt;<span class="built_in">int</span>&gt;)          <span class="comment"># D/DTn from days since Christ, at midnight.</span></span><br><span class="line">&lt;DTn&gt;    = DT.fromtimestamp(&lt;real&gt;)         <span class="comment"># Local time DTn from seconds since Epoch.</span></span><br><span class="line">&lt;DTa&gt;    = DT.fromtimestamp(&lt;real&gt;, &lt;tz.&gt;)  <span class="comment"># Aware datetime from seconds since Epoch.</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ISO strings come in following forms: <code>&#39;YYYY-MM-DD&#39;</code>, <code>&#39;HH:MM:SS.ffffff[Â±&lt;offset&gt;]&#39;</code>, or both separated by <code>&#39;T&#39;</code>. Offset is formatted as: <code>&#39;HH:MM&#39;</code>.</strong></li>
<li><strong>On Unix systems Epoch is <code>&#39;1970-01-01 00:00 UTC&#39;</code>, <code>&#39;1970-01-01 01:00 CET&#39;</code>, â¦</strong></li>
</ul>
<h3 id="Decode"><a href="#Decode" class="headerlink" title="Decode"></a>Decode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;    = &lt;D/T/DT&gt;.isoformat()             <span class="comment"># ISO string representation.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;    = &lt;D/T/DT&gt;.strftime(<span class="string">&#x27;&lt;format&gt;&#x27;</span>)    <span class="comment"># Custom string representation.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;    = &lt;D/DT&gt;.toordinal()               <span class="comment"># Days since Christ, ignoring time and tz.</span></span><br><span class="line">&lt;<span class="built_in">float</span>&gt;  = &lt;DTn&gt;.timestamp()                <span class="comment"># Seconds since Epoch from DTn in local time.</span></span><br><span class="line">&lt;<span class="built_in">float</span>&gt;  = &lt;DTa&gt;.timestamp()                <span class="comment"># Seconds since Epoch from DTa.</span></span><br></pre></td></tr></table></figure>

<h3 id="Format-1"><a href="#Format-1" class="headerlink" title="Format"></a>Format</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt = datetime.strptime(<span class="string">&#x27;2015-05-14 23:39:00.00 +0200&#x27;</span>, <span class="string">&#x27;%Y-%m-%d %H:%M:%S.%f %z&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt.strftime(<span class="string">&quot;%A, %dth of %B &#x27;%y, %I:%M%p %Z&quot;</span>)</span><br><span class="line"><span class="string">&quot;Thursday, 14th of May &#x27;15, 11:39PM UTC+02:00&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>For abbreviated weekday and month use <code>&#39;%a&#39;</code> and <code>&#39;%b&#39;</code>.</strong></li>
<li><strong>When parsing, <code>&#39;%z&#39;</code> also accepts <code>&#39;Â±HH:MM&#39;</code>.</strong></li>
</ul>
<h3 id="Arithmetics"><a href="#Arithmetics" class="headerlink" title="Arithmetics"></a>Arithmetics</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;D/DT&gt;   = &lt;D/DT&gt; Â±  &lt;TD&gt;</span><br><span class="line">&lt;TD&gt;     = &lt;TD&gt;   Â±  &lt;TD&gt;</span><br><span class="line">&lt;TD&gt;     = &lt;TD&gt;   */ &lt;real&gt;</span><br><span class="line">&lt;<span class="built_in">float</span>&gt;  = &lt;TD&gt;   /  &lt;TD&gt;</span><br></pre></td></tr></table></figure>


<h2 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h2><h3 id="Inside-Function-Call"><a href="#Inside-Function-Call" class="headerlink" title="Inside Function Call"></a>Inside Function Call</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;function&gt;(&lt;positional_args&gt;)                  <span class="comment"># f(0, 0)</span></span><br><span class="line">&lt;function&gt;(&lt;keyword_args&gt;)                     <span class="comment"># f(x=0, y=0)</span></span><br><span class="line">&lt;function&gt;(&lt;positional_args&gt;, &lt;keyword_args&gt;)  <span class="comment"># f(0, y=0)</span></span><br></pre></td></tr></table></figure>

<h3 id="Inside-Function-Definition"><a href="#Inside-Function-Definition" class="headerlink" title="Inside Function Definition"></a>Inside Function Definition</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">&lt;nondefault_args&gt;</span>):</span>                      <span class="comment"># def f(x, y):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">&lt;default_args&gt;</span>):</span>                         <span class="comment"># def f(x=0, y=0):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">&lt;nondefault_args&gt;, &lt;default_args&gt;</span>):</span>      <span class="comment"># def f(x, y=0):</span></span><br></pre></td></tr></table></figure>


<h2 id="Splat-Operator"><a href="#Splat-Operator" class="headerlink" title="Splat Operator"></a>Splat Operator</h2><h3 id="Inside-Function-Call-1"><a href="#Inside-Function-Call-1" class="headerlink" title="Inside Function Call"></a>Inside Function Call</h3><p><strong>Splat expands a collection into positional arguments, while splatty-splat expands a dictionary into keyword arguments.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">args   = (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">kwargs = &#123;<span class="string">&#x27;x&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;y&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;z&#x27;</span>: <span class="number">5</span>&#125;</span><br><span class="line">func(*args, **kwargs)</span><br></pre></td></tr></table></figure>

<h4 id="Is-the-same-as"><a href="#Is-the-same-as" class="headerlink" title="Is the same as:"></a>Is the same as:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func(<span class="number">1</span>, <span class="number">2</span>, x=<span class="number">3</span>, y=<span class="number">4</span>, z=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Inside-Function-Definition-1"><a href="#Inside-Function-Definition-1" class="headerlink" title="Inside Function Definition"></a>Inside Function Definition</h3><p><strong>Splat combines zero or more positional arguments into a tuple, while splatty-splat combines zero or more keyword arguments into a dictionary.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">*a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(a)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>add(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>

<h4 id="Legal-argument-combinations"><a href="#Legal-argument-combinations" class="headerlink" title="Legal argument combinations:"></a>Legal argument combinations:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, y, z</span>):</span>                <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*, x, y, z</span>):</span>             <span class="comment"># f(x=1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, *, y, z</span>):</span>             <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, y, *, z</span>):</span>             <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*args</span>):</span>                  <span class="comment"># f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, *args</span>):</span>               <span class="comment"># f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*args, z</span>):</span>               <span class="comment"># f(1, 2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, *args, z</span>):</span>            <span class="comment"># f(1, 2, z=3)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">**kwargs</span>):</span>               <span class="comment"># f(x=1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, **kwargs</span>):</span>            <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*, x, **kwargs</span>):</span>         <span class="comment"># f(x=1, y=2, z=3)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*args, **kwargs</span>):</span>        <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, *args, **kwargs</span>):</span>     <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*args, y, **kwargs</span>):</span>     <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, *args, z, **kwargs</span>):</span>  <span class="comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span></span><br></pre></td></tr></table></figure>

<h3 id="Other-Uses"><a href="#Other-Uses" class="headerlink" title="Other Uses"></a>Other Uses</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt;  = [*&lt;collection&gt; [, ...]]</span><br><span class="line">&lt;<span class="built_in">set</span>&gt;   = &#123;*&lt;collection&gt; [, ...]&#125;</span><br><span class="line">&lt;<span class="built_in">tuple</span>&gt; = (*&lt;collection&gt;, [...])</span><br><span class="line">&lt;<span class="built_in">dict</span>&gt;  = &#123;**&lt;<span class="built_in">dict</span>&gt; [, ...]&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head, *body, tail = &lt;collection&gt;</span><br></pre></td></tr></table></figure>


<h2 id="Inline"><a href="#Inline" class="headerlink" title="Inline"></a>Inline</h2><h3 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;function&gt; = <span class="keyword">lambda</span>: &lt;return_value&gt;</span><br><span class="line">&lt;function&gt; = <span class="keyword">lambda</span> &lt;argument_1&gt;, &lt;argument_2&gt;: &lt;return_value&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Comprehension"><a href="#Comprehension" class="headerlink" title="Comprehension"></a>Comprehension</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt; = [i+<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]                   <span class="comment"># [1, 2, ..., 10]</span></span><br><span class="line">&lt;<span class="built_in">set</span>&gt;  = &#123;i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>) <span class="keyword">if</span> i &gt; <span class="number">5</span>&#125;            <span class="comment"># &#123;6, 7, 8, 9&#125;</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = (i+<span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>))                   <span class="comment"># (5, 6, ..., 14)</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = &#123;i: i*<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;                <span class="comment"># &#123;0: 0, 1: 2, ..., 9: 18&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out = [i+j <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br></pre></td></tr></table></figure>

<h4 id="Is-the-same-as-1"><a href="#Is-the-same-as-1" class="headerlink" title="Is the same as:"></a>Is the same as:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        out.append(i+j)</span><br></pre></td></tr></table></figure>

<h3 id="Map-Filter-Reduce"><a href="#Map-Filter-Reduce" class="headerlink" title="Map, Filter, Reduce"></a>Map, Filter, Reduce</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: x + <span class="number">1</span>, <span class="built_in">range</span>(<span class="number">10</span>))            <span class="comment"># (1, 2, ..., 10)</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = <span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x &gt; <span class="number">5</span>, <span class="built_in">range</span>(<span class="number">10</span>))         <span class="comment"># (6, 7, 8, 9)</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;  = reduce(<span class="keyword">lambda</span> out, x: out + x, <span class="built_in">range</span>(<span class="number">10</span>))  <span class="comment"># 45</span></span><br></pre></td></tr></table></figure>

<h3 id="Any-All"><a href="#Any-All" class="headerlink" title="Any, All"></a>Any, All</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bool</span>&gt; = <span class="built_in">any</span>(&lt;collection&gt;)                          <span class="comment"># False if empty.</span></span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = <span class="built_in">all</span>(el[<span class="number">1</span>] <span class="keyword">for</span> el <span class="keyword">in</span> &lt;collection&gt;)          <span class="comment"># True if empty.</span></span><br></pre></td></tr></table></figure>

<h3 id="If-Else"><a href="#If-Else" class="headerlink" title="If - Else"></a>If - Else</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;expression_if_true&gt; <span class="keyword">if</span> &lt;condition&gt; <span class="keyword">else</span> &lt;expression_if_false&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[a <span class="keyword">if</span> a <span class="keyword">else</span> <span class="string">&#x27;zero&#x27;</span> <span class="keyword">for</span> a <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>)]</span><br><span class="line">[<span class="string">&#x27;zero&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;zero&#x27;</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h3 id="Namedtuple-Enum-Dataclass"><a href="#Namedtuple-Enum-Dataclass" class="headerlink" title="Namedtuple, Enum, Dataclass"></a>Namedtuple, Enum, Dataclass</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">Point     = namedtuple(<span class="string">&#x27;Point&#x27;</span>, <span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line">point     = Point(<span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line">Direction = Enum(<span class="string">&#x27;Direction&#x27;</span>, <span class="string">&#x27;n e s w&#x27;</span>)</span><br><span class="line">direction = Direction.n</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> make_dataclass</span><br><span class="line">Creature  = make_dataclass(<span class="string">&#x27;Creature&#x27;</span>, [<span class="string">&#x27;location&#x27;</span>, <span class="string">&#x27;direction&#x27;</span>])</span><br><span class="line">creature  = Creature(Point(<span class="number">0</span>, <span class="number">0</span>), Direction.n)</span><br></pre></td></tr></table></figure>


<h2 id="Closure"><a href="#Closure" class="headerlink" title="Closure"></a>Closure</h2><p><strong>We have a closure in Python when:</strong></p>
<ul>
<li><strong>A nested function references a value of its enclosing function and then</strong></li>
<li><strong>the enclosing function returns the nested function.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_multiplier</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span>(<span class="params">b</span>):</span></span><br><span class="line">        <span class="keyword">return</span> a * b</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3 = get_multiplier(<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3(<span class="number">10</span>)</span><br><span class="line"><span class="number">30</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>If multiple nested functions within enclosing function reference the same value, that value gets shared.</strong></li>
<li><strong>To dynamically access functionâs first free variable use <code>&#39;&lt;function&gt;.__closure__[0].cell_contents&#39;</code>.</strong></li>
</ul>
<h3 id="Partial"><a href="#Partial" class="headerlink" title="Partial"></a>Partial</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">&lt;function&gt; = partial(&lt;function&gt; [, &lt;arg_1&gt;, &lt;arg_2&gt;, ...])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> operator <span class="keyword">as</span> op</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3 = partial(op.mul, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiply_by_3(<span class="number">10</span>)</span><br><span class="line"><span class="number">30</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Partial is also useful in cases when a function needs to be passed as an argument, because it enables us to set its arguments beforehand.</strong></li>
<li><strong>A few examples being <code>&#39;defaultdict(&lt;function&gt;)&#39;</code>, <code>&#39;iter(&lt;function&gt;, to_exclusive)&#39;</code> and dataclassâs <code>&#39;field(default_factory=&lt;function&gt;)&#39;</code>.</strong></li>
</ul>
<h3 id="Nonlocal"><a href="#Nonlocal" class="headerlink" title="Nonlocal"></a>Nonlocal</h3><p><strong>If variable is being assigned to anywhere in the scope, it is regarded as a local variable, unless it is declared as a âglobalâ or a ânonlocalâ.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_counter</span>():</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span>():</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = get_counter()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter(), counter(), counter()</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h2><p><strong>A decorator takes a function, adds some functionality and returns it.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@decorator_name</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_that_gets_passed_to_decorator</span>():</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h3 id="Debugger-Example"><a href="#Debugger-Example" class="headerlink" title="Debugger Example"></a>Debugger Example</h3><p><strong>Decorator that prints functionâs name every time it gets called.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="meta">@debug</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Wraps is a helper decorator that copies metadata of function add() to function out().</strong></li>
<li><strong>Without it <code>&#39;add.__name__&#39;</code> would return <code>&#39;out&#39;</code>.</strong></li>
</ul>
<h3 id="LRU-Cache"><a href="#LRU-Cache" class="headerlink" title="LRU Cache"></a>LRU Cache</h3><p><strong>Decorator that caches functionâs return values. All functionâs arguments must be hashable.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"></span><br><span class="line"><span class="meta">@lru_cache(<span class="params">maxsize=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> n <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> fib(n-<span class="number">2</span>) + fib(n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Recursion depth is limited to 1000 by default. To increase it use <code>&#39;sys.setrecursionlimit(&lt;depth&gt;)&#39;</code>.</strong></li>
</ul>
<h3 id="Parametrized-Decorator"><a href="#Parametrized-Decorator" class="headerlink" title="Parametrized Decorator"></a>Parametrized Decorator</h3><p><strong>A decorator that accepts arguments and returns a normal decorator that accepts a function.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span>(<span class="params">print_result=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">        @wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">out</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            result = func(*args, **kwargs)</span><br><span class="line">            <span class="built_in">print</span>(func.__name__, result <span class="keyword">if</span> print_result <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@debug(<span class="params">print_result=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>


<h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">name</span>&gt;:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        class_name = self.__class__.__name__</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;class_name&#125;</span>(<span class="subst">&#123;self.a!r&#125;</span>)&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(self.a)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_class_name</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="keyword">return</span> cls.__name__</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Return value of repr() should be unambiguous and of str() readable.</strong></li>
<li><strong>If only repr() is defined, it will be also used for str().</strong></li>
</ul>
<h4 id="Str-use-cases"><a href="#Str-use-cases" class="headerlink" title="Str() use cases:"></a>Str() use cases:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(&lt;el&gt;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;&lt;el&gt;&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="keyword">raise</span> Exception(&lt;el&gt;)</span><br><span class="line">logging.debug(&lt;el&gt;)</span><br><span class="line">csv.writer(&lt;file&gt;).writerow([&lt;el&gt;])</span><br></pre></td></tr></table></figure>

<h4 id="Repr-use-cases"><a href="#Repr-use-cases" class="headerlink" title="Repr() use cases:"></a>Repr() use cases:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>([&lt;el&gt;])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;&lt;el&gt;!r&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;el&gt;</span><br><span class="line">loguru.logger.exception()</span><br><span class="line">Z = dataclasses.make_dataclass(<span class="string">&#x27;Z&#x27;</span>, [<span class="string">&#x27;a&#x27;</span>]); <span class="built_in">print</span>(Z(&lt;el&gt;))</span><br></pre></td></tr></table></figure>

<h3 id="Constructor-Overloading"><a href="#Constructor-Overloading" class="headerlink" title="Constructor Overloading"></a>Constructor Overloading</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">name</span>&gt;:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a=<span class="literal">None</span></span>):</span></span><br><span class="line">        self.a = a</span><br></pre></td></tr></table></figure>

<h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age  = age</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span>(<span class="params">Person</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age, staff_num</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name, age)</span><br><span class="line">        self.staff_num = staff_num</span><br></pre></td></tr></table></figure>

<h3 id="Multiple-Inheritance"><a href="#Multiple-Inheritance" class="headerlink" title="Multiple Inheritance"></a>Multiple Inheritance</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span> <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span> <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">A, B</span>):</span> <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p><strong>MRO determines the order in which parent classes are traversed when searching for a method:</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>C.mro()</span><br><span class="line">[&lt;class &#x27;C&#x27;&gt;, &lt;class &#x27;A&#x27;&gt;, &lt;class &#x27;B&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;]</span><br></pre></td></tr></table></figure>

<h3 id="Property"><a href="#Property" class="headerlink" title="Property"></a>Property</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._a</span><br><span class="line"></span><br><span class="line"><span class="meta">    @a.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        self._a = value</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>el = MyClass()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>el.a = <span class="number">123</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>el.a</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>

<h3 id="Dataclass"><a href="#Dataclass" class="headerlink" title="Dataclass"></a>Dataclass</h3><p><strong>Decorator that automatically generates init(), repr() and eq() special methods.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass, field</span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass(<span class="params">order=<span class="literal">False</span>, frozen=<span class="literal">False</span></span>)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">class_name</span>&gt;:</span></span><br><span class="line">    &lt;attr_name_1&gt;: &lt;<span class="built_in">type</span>&gt;</span><br><span class="line">    &lt;attr_name_2&gt;: &lt;<span class="built_in">type</span>&gt; = &lt;default_value&gt;</span><br><span class="line">    &lt;attr_name_3&gt;: <span class="built_in">list</span>/<span class="built_in">dict</span>/<span class="built_in">set</span> = field(default_factory=<span class="built_in">list</span>/<span class="built_in">dict</span>/<span class="built_in">set</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>An object can be made sortable with <code>&#39;order=True&#39;</code> or immutable with <code>&#39;frozen=True&#39;</code>.</strong></li>
<li><strong>Function field() is needed because <code>&#39;&lt;attr_name&gt;: list = []&#39;</code> would make a list that is shared among all instances.</strong></li>
<li><strong>Default_factory can be any callable.</strong></li>
</ul>
<h3 id="Slots"><a href="#Slots" class="headerlink" title="Slots"></a>Slots</h3><p><strong>Mechanism that restricts objects to attributes listed in âslotsâ and significantly reduces their memory footprint.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClassWithSlots</span>:</span></span><br><span class="line">    __slots__ = [<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="Copy"><a href="#Copy" class="headerlink" title="Copy"></a>Copy</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> copy, deepcopy</span><br><span class="line">&lt;<span class="built_in">object</span>&gt; = copy(&lt;<span class="built_in">object</span>&gt;)</span><br><span class="line">&lt;<span class="built_in">object</span>&gt; = deepcopy(&lt;<span class="built_in">object</span>&gt;)</span><br></pre></td></tr></table></figure>


<h2 id="Duck-Types"><a href="#Duck-Types" class="headerlink" title="Duck Types"></a>Duck Types</h2><p><strong>A duck type is an implicit type that prescribes a set of special methods. Any object that has those methods defined is considered a member of that duck type.</strong></p>
<h3 id="Comparable"><a href="#Comparable" class="headerlink" title="Comparable"></a>Comparable</h3><ul>
<li><strong>If eq() method is not overridden, it returns <code>&#39;id(self) == id(other)&#39;</code>, which is the same as <code>&#39;self is other&#39;</code>.</strong></li>
<li><strong>That means all objects compare not equal by default.</strong></li>
<li><strong>Only left side object has eq() method called, unless it returns âNotImplementedâ, in which case the right object is consulted.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComparable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, <span class="built_in">type</span>(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a == other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br></pre></td></tr></table></figure>

<h3 id="Hashable"><a href="#Hashable" class="headerlink" title="Hashable"></a>Hashable</h3><ul>
<li><strong>Hashable object needs both hash() and eq() methods and its hash value should never change.</strong></li>
<li><strong>Hashable objects that compare equal must have the same hash value, meaning default hash() that returns <code>&#39;id(self)&#39;</code> will not do.</strong></li>
<li><strong>That is why Python automatically makes classes unhashable if you only implement eq().</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHashable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self._a = copy.deepcopy(a)</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">a</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, <span class="built_in">type</span>(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a == other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__hash__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>(self.a)</span><br></pre></td></tr></table></figure>

<h3 id="Sortable"><a href="#Sortable" class="headerlink" title="Sortable"></a>Sortable</h3><ul>
<li><strong>With âtotal_orderingâ decorator you only need to provide eq() and one of lt(), gt(), le() or ge() special methods.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> total_ordering</span><br><span class="line"></span><br><span class="line"><span class="meta">@total_ordering</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySortable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, <span class="built_in">type</span>(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a == other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, <span class="built_in">type</span>(self)):</span><br><span class="line">            <span class="keyword">return</span> self.a &lt; other.a</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Iterator-1"><a href="#Iterator-1" class="headerlink" title="Iterator"></a>Iterator</h3><ul>
<li><strong>Next() should return next item or raise âStopIterationâ.</strong></li>
<li><strong>Iter() should return âselfâ.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.i</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = Counter()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">next</span>(counter), <span class="built_in">next</span>(counter), <span class="built_in">next</span>(counter)</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.i</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter = Counter()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>counter(), counter(), counter()</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Context-Manager"><a href="#Context-Manager" class="headerlink" title="Context Manager"></a>Context Manager</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyOpen</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, filename</span>):</span></span><br><span class="line">        self.filename = filename</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.file = <span class="built_in">open</span>(self.filename)</span><br><span class="line">        <span class="keyword">return</span> self.file</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span>(<span class="params">self, *args</span>):</span></span><br><span class="line">        self.file.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line"><span class="meta">... </span>    file.write(<span class="string">&#x27;Hello World!&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> MyOpen(<span class="string">&#x27;test.txt&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(file.read())</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<h4 id="List-of-existing-context-managers"><a href="#List-of-existing-context-managers" class="headerlink" title="List of existing context managers:"></a>List of existing context managers:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;&lt;path&gt;&#x27;</span>, ...) <span class="keyword">as</span> file: ...</span><br><span class="line"><span class="keyword">with</span> wave.<span class="built_in">open</span>(<span class="string">&#x27;&lt;path&gt;&#x27;</span>, ...) <span class="keyword">as</span> wave_file: ...</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">memoryview</span>(&lt;<span class="built_in">bytes</span>/<span class="built_in">bytearray</span>/array&gt;) <span class="keyword">as</span> view: ...</span><br><span class="line">db = sqlite3.connect(<span class="string">&#x27;&lt;path&gt;&#x27;</span>); <span class="keyword">with</span> db: db.execute(<span class="string">&#x27;&lt;insert_query&gt;&#x27;</span>)</span><br><span class="line">lock = threading.RLock(); <span class="keyword">with</span> lock: ...</span><br></pre></td></tr></table></figure>


<h2 id="Iterable-Duck-Types"><a href="#Iterable-Duck-Types" class="headerlink" title="Iterable Duck Types"></a>Iterable Duck Types</h2><h3 id="Iterable"><a href="#Iterable" class="headerlink" title="Iterable"></a>Iterable</h3><ul>
<li><strong>Only required method is iter(). It should return an iterator of objectâs items.</strong></li>
<li><strong>Contains() automatically works on any object that has iter() defined.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIterable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> el <span class="keyword">in</span> self.a:</span><br><span class="line">            <span class="keyword">yield</span> el</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = MyIterable([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">iter</span>(a)</span><br><span class="line">&lt;generator <span class="built_in">object</span> MyIterable.__iter__ at <span class="number">0x1026c18b8</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> <span class="keyword">in</span> a</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h3 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h3><ul>
<li><strong>Only required methods are iter() and len().</strong></li>
<li><strong>This cheatsheet actually means <code>&#39;&lt;iterable&gt;&#39;</code> when it uses <code>&#39;&lt;collection&gt;&#39;</code>.</strong></li>
<li><strong>I chose not to use the name âiterableâ because it sounds scarier and more vague than âcollectionâ.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCollection</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> el <span class="keyword">in</span> self.a:</span><br><span class="line">            <span class="keyword">yield</span> el</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__contains__</span>(<span class="params">self, el</span>):</span></span><br><span class="line">        <span class="keyword">return</span> el <span class="keyword">in</span> self.a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.a)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Sequence"><a href="#Sequence" class="headerlink" title="Sequence"></a>Sequence</h3><ul>
<li><strong>Only required methods are len() and getitem(), that should return an item at index or raise âIndexErrorâ.</strong></li>
<li><strong>Iter() and contains() automatically work on any object that has getitem() defined.</strong></li>
<li><strong>Reversed() automatically works on any object that has getitem() and len() defined.</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySequence</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> el <span class="keyword">in</span> self.a:</span><br><span class="line">            <span class="keyword">yield</span> el</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__contains__</span>(<span class="params">self, el</span>):</span></span><br><span class="line">        <span class="keyword">return</span> el <span class="keyword">in</span> self.a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.a)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span>(<span class="params">self, i</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.a[i]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reversed__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">reversed</span>(self.a)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Collections-abc-Sequence"><a href="#Collections-abc-Sequence" class="headerlink" title="Collections.abc.Sequence"></a>Collections.abc.Sequence</h3><ul>
<li><strong>Itâs a richer interface than the basic sequence.</strong></li>
<li><strong>Extending it generates iter(), contains(), reversed(), index(), and count().</strong></li>
<li><strong>Unlike <code>&#39;abc.Iterable&#39;</code> and <code>&#39;abc.Collection&#39;</code>, it is not a duck type. That is why <code>&#39;issubclass(MySequence, collections.abc.Sequence)&#39;</code> would return âFalseâ even if it had all the methods defined.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAbcSequence</span>(<span class="params">collections.abc.<span class="type">Sequence</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, a</span>):</span></span><br><span class="line">        self.a = a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.a)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span>(<span class="params">self, i</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.a[i]</span><br></pre></td></tr></table></figure>

<h4 id="Table-of-required-and-available-special-methods"><a href="#Table-of-required-and-available-special-methods" class="headerlink" title="Table of required and available special methods:"></a>Table of required and available special methods:</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------+----------+------------+----------+--------------+</span><br><span class="line">|            | Iterable | Collection | Sequence | abc.Sequence |</span><br><span class="line">+------------+----------+------------+----------+--------------+</span><br><span class="line">| iter()     |   REQ    |    REQ     |   yes    |     yes      |</span><br><span class="line">| contains() |   yes    |    yes     |   yes    |     yes      |</span><br><span class="line">| len()      |          |    REQ     |   REQ    |     REQ      |</span><br><span class="line">| getitem()  |          |            |   REQ    |     REQ      |</span><br><span class="line">| reversed() |          |            |   yes    |     yes      |</span><br><span class="line">| index()    |          |            |          |     yes      |</span><br><span class="line">| count()    |          |            |          |     yes      |</span><br><span class="line">+------------+----------+------------+----------+--------------+</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Other useful ABCs that automatically generate missing methods are: MutableSequence, Set, MutableSet, Mapping and MutableMapping.</strong></li>
</ul>
<h2 id="Enum"><a href="#Enum" class="headerlink" title="Enum"></a>Enum</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, auto</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> &lt;<span class="title">enum_name</span>&gt;(<span class="params">Enum</span>):</span></span><br><span class="line">    &lt;member_name_1&gt; = &lt;value_1&gt;</span><br><span class="line">    &lt;member_name_2&gt; = &lt;value_2_a&gt;, &lt;value_2_b&gt;</span><br><span class="line">    &lt;member_name_3&gt; = auto()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_member_names</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="keyword">return</span> [a.name <span class="keyword">for</span> a <span class="keyword">in</span> cls.__members__.values()]</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>If there are no numeric values before auto(), it returns 1.</strong></li>
<li><strong>Otherwise it returns an increment of last numeric value.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;member&gt; = &lt;enum&gt;.&lt;member_name&gt;</span><br><span class="line">&lt;member&gt; = &lt;enum&gt;[<span class="string">&#x27;&lt;member_name&gt;&#x27;</span>]</span><br><span class="line">&lt;member&gt; = &lt;enum&gt;(&lt;value&gt;)</span><br><span class="line">name     = &lt;member&gt;.name</span><br><span class="line">value    = &lt;member&gt;.value</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list_of_members = <span class="built_in">list</span>(&lt;enum&gt;)</span><br><span class="line">member_names    = [a.name <span class="keyword">for</span> a <span class="keyword">in</span> &lt;enum&gt;]</span><br><span class="line">member_values   = [a.value <span class="keyword">for</span> a <span class="keyword">in</span> &lt;enum&gt;]</span><br><span class="line">random_member   = random.choice(<span class="built_in">list</span>(&lt;enum&gt;))</span><br></pre></td></tr></table></figure>

<h3 id="Inline-1"><a href="#Inline-1" class="headerlink" title="Inline"></a>Inline</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cutlery = Enum(<span class="string">&#x27;Cutlery&#x27;</span>, [<span class="string">&#x27;fork&#x27;</span>, <span class="string">&#x27;knife&#x27;</span>, <span class="string">&#x27;spoon&#x27;</span>])</span><br><span class="line">Cutlery = Enum(<span class="string">&#x27;Cutlery&#x27;</span>, <span class="string">&#x27;fork knife spoon&#x27;</span>)</span><br><span class="line">Cutlery = Enum(<span class="string">&#x27;Cutlery&#x27;</span>, &#123;<span class="string">&#x27;fork&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;knife&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;spoon&#x27;</span>: <span class="number">3</span>&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="Functions-can-not-be-values-so-they-must-be-wrapped"><a href="#Functions-can-not-be-values-so-they-must-be-wrapped" class="headerlink" title="Functions can not be values, so they must be wrapped:"></a>Functions can not be values, so they must be wrapped:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line">LogicOp = Enum(<span class="string">&#x27;LogicOp&#x27;</span>, &#123;<span class="string">&#x27;AND&#x27;</span>: partial(<span class="keyword">lambda</span> l, r: l <span class="keyword">and</span> r),</span><br><span class="line">                           <span class="string">&#x27;OR&#x27;</span> : partial(<span class="keyword">lambda</span> l, r: l <span class="keyword">or</span> r)&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Another solution in this particular case, is to use <code>&#39;and_&#39;</code> and <code>&#39;or_&#39;</code> functions from module <a href="#operator">Operator</a>.</strong></li>
</ul>
<h2 id="Exceptions"><a href="#Exceptions" class="headerlink" title="Exceptions"></a>Exceptions</h2><h3 id="Basic-Example"><a href="#Basic-Example" class="headerlink" title="Basic Example"></a>Basic Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    &lt;code&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line">    &lt;code&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Complex-Example"><a href="#Complex-Example" class="headerlink" title="Complex Example"></a>Complex Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    &lt;code_1&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;exception_a&gt;:</span><br><span class="line">    &lt;code_2_a&gt;</span><br><span class="line"><span class="keyword">except</span> &lt;exception_b&gt;:</span><br><span class="line">    &lt;code_2_b&gt;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    &lt;code_2_c&gt;</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    &lt;code_3&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Catching-Exceptions"><a href="#Catching-Exceptions" class="headerlink" title="Catching Exceptions"></a>Catching Exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line"><span class="keyword">except</span> &lt;exception&gt; <span class="keyword">as</span> &lt;name&gt;:</span><br><span class="line"><span class="keyword">except</span> (&lt;exception_1&gt;, &lt;exception_2&gt;, ...):</span><br><span class="line"><span class="keyword">except</span> (&lt;exception_1&gt;, &lt;exception_2&gt;, ...) <span class="keyword">as</span> &lt;name&gt;:</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Also catches subclasses of the exception.</strong></li>
</ul>
<h3 id="Raising-Exceptions"><a href="#Raising-Exceptions" class="headerlink" title="Raising Exceptions"></a>Raising Exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">raise</span> &lt;exception&gt;</span><br><span class="line"><span class="keyword">raise</span> &lt;exception&gt;()</span><br><span class="line"><span class="keyword">raise</span> &lt;exception&gt;(&lt;el&gt;)</span><br><span class="line"><span class="keyword">raise</span> &lt;exception&gt;(&lt;el_1&gt;, &lt;el_2&gt;, ...)</span><br></pre></td></tr></table></figure>

<h4 id="Useful-built-in-exceptions"><a href="#Useful-built-in-exceptions" class="headerlink" title="Useful built-in exceptions:"></a>Useful built-in exceptions:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">raise</span> ValueError(<span class="string">&#x27;Argument is of right type but inappropriate value!&#x27;</span>)</span><br><span class="line"><span class="keyword">raise</span> TypeError(<span class="string">&#x27;Argument is of wrong type!&#x27;</span>)</span><br><span class="line"><span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;None of above!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Re-raising-caught-exception"><a href="#Re-raising-caught-exception" class="headerlink" title="Re-raising caught exception:"></a>Re-raising caught exception:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line">    &lt;code&gt;</span><br><span class="line">    <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>

<h3 id="Common-Built-in-Exceptions"><a href="#Common-Built-in-Exceptions" class="headerlink" title="Common Built-in Exceptions"></a>Common Built-in Exceptions</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">BaseException</span><br><span class="line"> +-- SystemExit                   # Raised by the sys.exit() function.</span><br><span class="line"> +-- KeyboardInterrupt            # Raised when the user hits the interrupt key.</span><br><span class="line"> +-- Exception                    # User-defined exceptions should be derived from this class.</span><br><span class="line">      +-- StopIteration           # Raised by next() when run on an empty iterator.</span><br><span class="line">      +-- ArithmeticError         # Base class for arithmetic errors.</span><br><span class="line">      |    +-- ZeroDivisionError  # Raised when dividing by zero.</span><br><span class="line">      +-- AttributeError          # Raised when an attribute is missing.</span><br><span class="line">      +-- EOFError                # Raised by input() when it hits end-of-file condition.</span><br><span class="line">      +-- LookupError             # Raised when a look-up on sequence or dict fails.</span><br><span class="line">      |    +-- IndexError         # Raised when a sequence index is out of range.</span><br><span class="line">      |    +-- KeyError           # Raised when a dictionary key is not found.</span><br><span class="line">      +-- NameError               # Raised when a variable name is not found.</span><br><span class="line">      +-- OSError                 # Failures such as âfile not foundâ or âdisk fullâ.</span><br><span class="line">      |    +-- FileNotFoundError  # When a file or directory is requested but doesn&#x27;t exist.</span><br><span class="line">      +-- RuntimeError            # Raised by errors that don&#x27;t fall in other categories.</span><br><span class="line">      |    +-- RecursionError     # Raised when the the maximum recursion depth is exceeded.</span><br><span class="line">      +-- TypeError               # Raised when an argument is of wrong type.</span><br><span class="line">      +-- ValueError              # When an argument is of right type but inappropriate value.</span><br><span class="line">           +-- UnicodeError       # Raised when encoding/decoding strings from/to bytes fails. </span><br></pre></td></tr></table></figure>

<h3 id="User-defined-Exceptions"><a href="#User-defined-Exceptions" class="headerlink" title="User-defined Exceptions"></a>User-defined Exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyError</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInputError</span>(<span class="params">MyError</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>


<h2 id="Print"><a href="#Print" class="headerlink" title="Print"></a>Print</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(&lt;el_1&gt;, ..., sep=<span class="string">&#x27; &#x27;</span>, end=<span class="string">&#x27;\n&#x27;</span>, file=sys.stdout, flush=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;file=sys.stderr&#39;</code> for errors.</strong></li>
<li><strong>Use <code>&#39;flush=True&#39;</code> to forcibly flush the stream.</strong></li>
</ul>
<h3 id="Pretty-Print"><a href="#Pretty-Print" class="headerlink" title="Pretty Print"></a>Pretty Print</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pprint(<span class="built_in">dir</span>())</span><br><span class="line">[<span class="string">&#x27;__annotations__&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;__builtins__&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;__doc__&#x27;</span>, ...]</span><br></pre></td></tr></table></figure>


<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><ul>
<li><strong>Reads a line from user input or pipe if present.</strong></li>
<li><strong>Trailing newline gets stripped.</strong></li>
<li><strong>Prompt string is printed to the standard output before reading input.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt; = <span class="built_in">input</span>(prompt=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Prints-lines-until-EOF"><a href="#Prints-lines-until-EOF" class="headerlink" title="Prints lines until EOF:"></a>Prints lines until EOF:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">input</span>())</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>


<h2 id="Command-Line-Arguments"><a href="#Command-Line-Arguments" class="headerlink" title="Command Line Arguments"></a>Command Line Arguments</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">script_name = sys.argv[<span class="number">0</span>]</span><br><span class="line">arguments   = sys.argv[<span class="number">1</span>:]</span><br></pre></td></tr></table></figure>

<h3 id="Argparse"><a href="#Argparse" class="headerlink" title="Argparse"></a>Argparse</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser, FileType</span><br><span class="line">p = ArgumentParser(description=&lt;<span class="built_in">str</span>&gt;)</span><br><span class="line">p.add_argument(<span class="string">&#x27;-&lt;short_name&gt;&#x27;</span>, <span class="string">&#x27;--&lt;name&gt;&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>)  <span class="comment"># Flag</span></span><br><span class="line">p.add_argument(<span class="string">&#x27;-&lt;short_name&gt;&#x27;</span>, <span class="string">&#x27;--&lt;name&gt;&#x27;</span>, <span class="built_in">type</span>=&lt;<span class="built_in">type</span>&gt;)          <span class="comment"># Option</span></span><br><span class="line">p.add_argument(<span class="string">&#x27;&lt;name&gt;&#x27;</span>, <span class="built_in">type</span>=&lt;<span class="built_in">type</span>&gt;, nargs=<span class="number">1</span>)                    <span class="comment"># Argument</span></span><br><span class="line">p.add_argument(<span class="string">&#x27;&lt;name&gt;&#x27;</span>, <span class="built_in">type</span>=&lt;<span class="built_in">type</span>&gt;, nargs=<span class="string">&#x27;+&#x27;</span>)                  <span class="comment"># Arguments</span></span><br><span class="line">args  = p.parse_args()</span><br><span class="line">value = args.&lt;name&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Use <code>&#39;help=&lt;str&gt;&#39;</code> for argument description.</strong></li>
<li><strong>Use <code>&#39;type=FileType(&lt;mode&gt;)&#39;</code> for files.</strong></li>
</ul>
<h2 id="Open"><a href="#Open" class="headerlink" title="Open"></a>Open</h2><p><strong>Opens a file and returns a corresponding file object.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;file&gt; = <span class="built_in">open</span>(<span class="string">&#x27;&lt;path&gt;&#x27;</span>, mode=<span class="string">&#x27;r&#x27;</span>, encoding=<span class="literal">None</span>, newline=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>&#39;encoding=None&#39;</code> means default encoding is used, which is platform dependent. Best practice is to use <code>&#39;encoding=&quot;utf-8&quot;&#39;</code> whenever possible.</strong></li>
<li><strong><code>&#39;newline=None&#39;</code> means all different end of line combinations are converted to â\nâ on read, while on write all â\nâ characters are converted to systemâs default line separator.</strong></li>
<li><strong><code>&#39;newline=&quot;&quot;&#39;</code> means no conversions take place, but lines are still broken by readline() on either â\nâ, â\râ or â\r\nâ.</strong></li>
</ul>
<h3 id="Modes"><a href="#Modes" class="headerlink" title="Modes"></a>Modes</h3><ul>
<li><strong><code>&#39;r&#39;</code>  - Read (default).</strong></li>
<li><strong><code>&#39;w&#39;</code>  - Write (truncate).</strong></li>
<li><strong><code>&#39;x&#39;</code>  - Write or fail if the file already exists.</strong></li>
<li><strong><code>&#39;a&#39;</code>  - Append.</strong></li>
<li><strong><code>&#39;w+&#39;</code> - Read and write (truncate).</strong></li>
<li><strong><code>&#39;r+&#39;</code> - Read and write from the start.</strong></li>
<li><strong><code>&#39;a+&#39;</code> - Read and write from the end.</strong></li>
<li><strong><code>&#39;t&#39;</code>  - Text mode (default).</strong></li>
<li><strong><code>&#39;b&#39;</code>  - Binary mode.</strong></li>
</ul>
<h3 id="Exceptions-1"><a href="#Exceptions-1" class="headerlink" title="Exceptions"></a>Exceptions</h3><ul>
<li><strong><code>&#39;FileNotFoundError&#39;</code> can be risen when reading with <code>&#39;r&#39;</code> or <code>&#39;r+&#39;</code>.</strong>  </li>
<li><strong><code>&#39;FileExistsError&#39;</code> can be risen when writing with <code>&#39;x&#39;</code>.</strong></li>
<li><strong><code>&#39;IsADirectoryError&#39;</code> and <code>&#39;PermissionError&#39;</code> can be risen by any.</strong></li>
<li><strong><code>&#39;OSError&#39;</code> is the parent class of all listed exceptions.</strong></li>
</ul>
<h3 id="File"><a href="#File" class="headerlink" title="File"></a>File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;file&gt;.seek(<span class="number">0</span>)                      <span class="comment"># Moves to the start of the file.</span></span><br><span class="line">&lt;file&gt;.seek(offset)                 <span class="comment"># Moves &#x27;offset&#x27; chars/bytes from the start.</span></span><br><span class="line">&lt;file&gt;.seek(<span class="number">0</span>, <span class="number">2</span>)                   <span class="comment"># Moves to the end of the file.</span></span><br><span class="line">&lt;bin_file&gt;.seek(Â±offset, &lt;anchor&gt;)  <span class="comment"># Anchor: 0 start, 1 current pos., 2 end.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>/<span class="built_in">bytes</span>&gt; = &lt;file&gt;.read(size=-<span class="number">1</span>)  <span class="comment"># Reads &#x27;size&#x27; chars/bytes or until EOF.</span></span><br><span class="line">&lt;<span class="built_in">str</span>/<span class="built_in">bytes</span>&gt; = &lt;file&gt;.readline()     <span class="comment"># Returns a line or empty string on EOF.</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;      = &lt;file&gt;.readlines()    <span class="comment"># Returns a list of lines or empty list.</span></span><br><span class="line">&lt;<span class="built_in">str</span>/<span class="built_in">bytes</span>&gt; = <span class="built_in">next</span>(&lt;file&gt;)          <span class="comment"># Returns a line using buffer. Do not mix.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;file&gt;.write(&lt;<span class="built_in">str</span>/<span class="built_in">bytes</span>&gt;)           <span class="comment"># Writes a string or bytes object.</span></span><br><span class="line">&lt;file&gt;.writelines(&lt;coll.&gt;)          <span class="comment"># Writes a coll. of strings or bytes objects.</span></span><br><span class="line">&lt;file&gt;.flush()                      <span class="comment"># Flushes write buffer.</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Methods do not add or strip trailing newlines, even writelines().</strong></li>
</ul>
<h3 id="Read-Text-from-File"><a href="#Read-Text-from-File" class="headerlink" title="Read Text from File"></a>Read Text from File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.readlines()</span><br></pre></td></tr></table></figure>

<h3 id="Write-Text-to-File"><a href="#Write-Text-to-File" class="headerlink" title="Write Text to File"></a>Write Text to File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_file</span>(<span class="params">filename, text</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(text)</span><br></pre></td></tr></table></figure>


<h2 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> path, listdir</span><br><span class="line"><span class="keyword">from</span> glob <span class="keyword">import</span> glob</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bool</span>&gt; = path.exists(<span class="string">&#x27;&lt;path&gt;&#x27;</span>)</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = path.isfile(<span class="string">&#x27;&lt;path&gt;&#x27;</span>)</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = path.isdir(<span class="string">&#x27;&lt;path&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt; = listdir(<span class="string">&#x27;&lt;path&gt;&#x27;</span>)         <span class="comment"># List of filenames located at &#x27;path&#x27;. </span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt; = glob(<span class="string">&#x27;&lt;pattern&gt;&#x27;</span>)         <span class="comment"># Filenames matching the wildcard pattern.</span></span><br></pre></td></tr></table></figure>

<h3 id="Pathlib"><a href="#Pathlib" class="headerlink" title="Pathlib"></a>Pathlib</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cwd    = Path()</span><br><span class="line">&lt;Path&gt; = Path(<span class="string">&#x27;&lt;path&gt;&#x27;</span> [, <span class="string">&#x27;&lt;path&gt;&#x27;</span>, &lt;Path&gt;, ...])</span><br><span class="line">&lt;Path&gt; = &lt;Path&gt; / <span class="string">&#x27;&lt;dir&gt;&#x27;</span> / <span class="string">&#x27;&lt;file&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;Path&gt;.exists()</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;Path&gt;.is_file()</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;Path&gt;.is_dir()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">iter</span>&gt; = &lt;Path&gt;.iterdir()          <span class="comment"># Iterator of filenames located at path.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = &lt;Path&gt;.glob(<span class="string">&#x27;&lt;pattern&gt;&#x27;</span>)  <span class="comment"># Filenames matching the wildcard pattern.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;  = <span class="built_in">str</span>(&lt;Path&gt;)               <span class="comment"># Returns path as a string.</span></span><br><span class="line">&lt;tup.&gt; = &lt;Path&gt;.parts              <span class="comment"># Returns all components as strings.</span></span><br><span class="line">&lt;Path&gt; = &lt;Path&gt;.resolve()          <span class="comment"># Returns absolute Path without symlinks.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;Path&gt;.name               <span class="comment"># Final component.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;Path&gt;.stem               <span class="comment"># Final component without extension.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;Path&gt;.suffix             <span class="comment"># Final component&#x27;s extension.</span></span><br><span class="line">&lt;Path&gt; = &lt;Path&gt;.parent             <span class="comment"># Path without final component.</span></span><br></pre></td></tr></table></figure>


<h2 id="Command-Execution"><a href="#Command-Execution" class="headerlink" title="Command Execution"></a>Command Execution</h2><h3 id="Files-and-Directories-Commands"><a href="#Files-and-Directories-Commands" class="headerlink" title="Files and Directories Commands"></a>Files and Directories Commands</h3><ul>
<li><strong>Paths can be either strings or Path objects.</strong></li>
<li><strong>All exceptions are either âOSErrorâ or its subclasses.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.chdir(&lt;path&gt;)                  <span class="comment"># Changes the current working directory.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt; = os.getcwd()               <span class="comment"># Returns current working directory.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">os.remove(&lt;path&gt;)                 <span class="comment"># Deletes the file.</span></span><br><span class="line">os.rmdir(&lt;path&gt;)                  <span class="comment"># Deletes empty directory.</span></span><br><span class="line">shutil.rmtree(&lt;path&gt;)             <span class="comment"># Deletes an entire directory tree.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.rename(<span class="keyword">from</span>, to)               <span class="comment"># Renames the file or directory.</span></span><br><span class="line">os.replace(<span class="keyword">from</span>, to)              <span class="comment"># Same, but overwrites &#x27;to&#x27; if it exists.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.mkdir(&lt;path&gt;, mode=<span class="number">0o777</span>)      <span class="comment"># Creates a directory.</span></span><br><span class="line">&lt;<span class="built_in">iter</span>&gt; = os.scandir(path=<span class="string">&#x27;.&#x27;</span>)     <span class="comment"># Returns os.DirEntry objects located at path.</span></span><br></pre></td></tr></table></figure>

<h4 id="DirEntry"><a href="#DirEntry" class="headerlink" title="DirEntry:"></a>DirEntry:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;DirEntry&gt;.name          <span class="comment"># Final component of the path.</span></span><br><span class="line">&lt;<span class="built_in">str</span>&gt;  = &lt;DirEntry&gt;.path          <span class="comment"># Path with final component.</span></span><br><span class="line">&lt;Path&gt; = Path(&lt;DirEntry&gt;)         <span class="comment"># Path object.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;DirEntry&gt;.is_file()</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;DirEntry&gt;.is_dir()</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = &lt;DirEntry&gt;.is_symlink()</span><br></pre></td></tr></table></figure>

<h3 id="Shell-Commands"><a href="#Shell-Commands" class="headerlink" title="Shell Commands"></a>Shell Commands</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">&lt;<span class="built_in">str</span>&gt; = os.popen(<span class="string">&#x27;&lt;shell_command&gt;&#x27;</span>).read()</span><br></pre></td></tr></table></figure>

<h4 id="Using-subprocess"><a href="#Using-subprocess" class="headerlink" title="Using subprocess:"></a>Using subprocess:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> subprocess, shlex</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = subprocess.run(shlex.split(<span class="string">&#x27;ls -a&#x27;</span>), stdout=subprocess.PIPE)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.stdout</span><br><span class="line"><span class="string">b&#x27;.\n..\nfile1.txt\nfile2.txt\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.returncode</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>


<h2 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">&lt;reader&gt; = csv.reader(&lt;file&gt;, dialect=<span class="string">&#x27;excel&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">&lt;<span class="built_in">list</span>&gt;   = <span class="built_in">next</span>(&lt;reader&gt;)  <span class="comment"># Returns a row as list of strings.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;writer&gt; = csv.writer(&lt;file&gt;, dialect=<span class="string">&#x27;excel&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">&lt;writer&gt;.writerow(&lt;collection&gt;)</span><br><span class="line">&lt;writer&gt;.writerows(&lt;coll_of_coll&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h3><ul>
<li><strong><code>&#39;dialect&#39;</code> - Master parameter that sets the default values.</strong></li>
<li><strong><code>&#39;delimiter&#39;</code> - A one-character string used to separate fields.</strong></li>
<li><strong><code>&#39;quotechar&#39;</code> - Character for quoting fields that contain special characters.</strong></li>
<li><strong><code>&#39;doublequote&#39;</code> - Whether quotechars inside fields get doubled or escaped.</strong></li>
<li><strong><code>&#39;skipinitialspace&#39;</code> - Whether whitespace after delimiter gets stripped.</strong></li>
<li><strong><code>&#39;lineterminator&#39;</code> - How does writer terminate lines.</strong></li>
<li><strong><code>&#39;quoting&#39;</code> - Controls the amount of quoting: 0 - as necessary, 1 - all.</strong></li>
<li><strong><code>&#39;escapechar&#39;</code> - Character for escaping quotechar if doublequote is false.</strong></li>
</ul>
<h3 id="Dialects"><a href="#Dialects" class="headerlink" title="Dialects"></a>Dialects</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------------+-----------+-----------+--------------+</span><br><span class="line">|                  |   excel   | excel_tab | unix_dialect |</span><br><span class="line">+------------------+-----------+-----------+--------------+</span><br><span class="line">| delimiter        |      &#x27;,&#x27;  |     &#x27;\t&#x27;  |       &#x27;,&#x27;    |</span><br><span class="line">| quotechar        |      &#x27;&quot;&#x27;  |      &#x27;&quot;&#x27;  |       &#x27;&quot;&#x27;    |</span><br><span class="line">| doublequote      |     True  |     True  |      True    |</span><br><span class="line">| skipinitialspace |    False  |    False  |     False    |</span><br><span class="line">| lineterminator   |   &#x27;\r\n&#x27;  |   &#x27;\r\n&#x27;  |      &#x27;\n&#x27;    |</span><br><span class="line">| quoting          |        0  |        0  |         1    |</span><br><span class="line">| escapechar       |     None  |     None  |      None    |</span><br><span class="line">+------------------+-----------+-----------+--------------+</span><br></pre></td></tr></table></figure>

<h3 id="Read-Rows-from-CSV-File"><a href="#Read-Rows-from-CSV-File" class="headerlink" title="Read Rows from CSV File"></a>Read Rows from CSV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_csv_file</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> csv.reader(file)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>If <code>&#39;newline=&quot;&quot;&#39;</code> is not specified, then newlines embedded inside quoted fields will not be interpreted correctly.</strong></li>
</ul>
<h3 id="Write-Rows-to-CSV-File"><a href="#Write-Rows-to-CSV-File" class="headerlink" title="Write Rows to CSV File"></a>Write Rows to CSV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_csv_file</span>(<span class="params">filename, rows</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        writer = csv.writer(file)</span><br><span class="line">        writer.writerows(rows)</span><br></pre></td></tr></table></figure>


<h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">&lt;<span class="built_in">str</span>&gt;    = json.dumps(&lt;<span class="built_in">object</span>&gt;, ensure_ascii=<span class="literal">True</span>, indent=<span class="literal">None</span>)</span><br><span class="line">&lt;<span class="built_in">object</span>&gt; = json.loads(&lt;<span class="built_in">str</span>&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Read-Object-from-JSON-File"><a href="#Read-Object-from-JSON-File" class="headerlink" title="Read Object from JSON File"></a>Read Object from JSON File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_json_file</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> json.load(file)</span><br></pre></td></tr></table></figure>

<h3 id="Write-Object-to-JSON-File"><a href="#Write-Object-to-JSON-File" class="headerlink" title="Write Object to JSON File"></a>Write Object to JSON File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_json_file</span>(<span class="params">filename, an_object</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        json.dump(an_object, file, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Pickle"><a href="#Pickle" class="headerlink" title="Pickle"></a>Pickle</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt;  = pickle.dumps(&lt;<span class="built_in">object</span>&gt;)</span><br><span class="line">&lt;<span class="built_in">object</span>&gt; = pickle.loads(&lt;<span class="built_in">bytes</span>&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Read-Object-from-File"><a href="#Read-Object-from-File" class="headerlink" title="Read Object from File"></a>Read Object from File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_pickle_file</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> pickle.load(file)</span><br></pre></td></tr></table></figure>

<h3 id="Write-Object-to-File"><a href="#Write-Object-to-File" class="headerlink" title="Write Object to File"></a>Write Object to File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_pickle_file</span>(<span class="params">filename, an_object</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        pickle.dump(an_object, file)</span><br></pre></td></tr></table></figure>


<h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><p><strong>Server-less database engine that stores each database into separate file.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">db = sqlite3.connect(<span class="string">&#x27;&lt;path&gt;&#x27;</span>)                <span class="comment"># Also &#x27;:memory:&#x27;.</span></span><br><span class="line">...</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>New database will be created if path doesnât exist.</strong></li>
</ul>
<h3 id="Read"><a href="#Read" class="headerlink" title="Read"></a>Read</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cursor = db.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> cursor:</span><br><span class="line">    &lt;<span class="built_in">tuple</span>&gt; = cursor.fetchone()               <span class="comment"># First row.</span></span><br><span class="line">    &lt;<span class="built_in">list</span>&gt;  = cursor.fetchall()               <span class="comment"># Remaining rows.</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Returned values can be of type str, int, float, bytes or None.</strong></li>
</ul>
<h3 id="Write"><a href="#Write" class="headerlink" title="Write"></a>Write</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>)</span><br><span class="line">db.commit()</span><br></pre></td></tr></table></figure>

<h3 id="Placeholders"><a href="#Placeholders" class="headerlink" title="Placeholders"></a>Placeholders</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>, &lt;<span class="built_in">list</span>/<span class="built_in">tuple</span>&gt;)           <span class="comment"># Replaces &#x27;?&#x27;s in query with values.</span></span><br><span class="line">db.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>, &lt;<span class="built_in">dict</span>/namedtuple&gt;)      <span class="comment"># Replaces &#x27;:&lt;key&gt;&#x27;s with values.</span></span><br><span class="line">db.executemany(<span class="string">&#x27;&lt;query&gt;&#x27;</span>, &lt;coll_of_above&gt;)    <span class="comment"># Runs execute() many times.</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Passed values can be of type str, int, float, bytes, None, bool, datetime.date or datetime.datetme.</strong></li>
</ul>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p><strong>Has a very similar interface, with differences listed below.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install mysql-connector</span></span><br><span class="line"><span class="keyword">from</span> mysql <span class="keyword">import</span> connector</span><br><span class="line">db = connector.connect(host=&lt;<span class="built_in">str</span>&gt;, user=&lt;<span class="built_in">str</span>&gt;, password=&lt;<span class="built_in">str</span>&gt;, database=&lt;<span class="built_in">str</span>&gt;)</span><br><span class="line">cursor = db.cursor()</span><br><span class="line">cursor.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>)                     <span class="comment"># Connector doesn&#x27;t have execute method.</span></span><br><span class="line">cursor.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>, &lt;<span class="built_in">list</span>/<span class="built_in">tuple</span>&gt;)       <span class="comment"># Replaces &#x27;%s&#x27;s in query with values.</span></span><br><span class="line">cursor.execute(<span class="string">&#x27;&lt;query&gt;&#x27;</span>, &lt;<span class="built_in">dict</span>/namedtuple&gt;)  <span class="comment"># Replaces &#x27;%(&lt;key&gt;)s&#x27;s with values.</span></span><br></pre></td></tr></table></figure>


<h2 id="Bytes"><a href="#Bytes" class="headerlink" title="Bytes"></a>Bytes</h2><p><strong>Bytes object is an immutable sequence of single bytes. Mutable version is called âbytearrayâ.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bytes</span>&gt; = <span class="string">b&#x27;&lt;str&gt;&#x27;</span>                       <span class="comment"># Only accepts ASCII characters and \x00 - \xff.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;   = &lt;<span class="built_in">bytes</span>&gt;[&lt;index&gt;]               <span class="comment"># Returns int in range from 0 to 255.</span></span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt; = &lt;<span class="built_in">bytes</span>&gt;[&lt;<span class="built_in">slice</span>&gt;]               <span class="comment"># Returns bytes even if it has only one element.</span></span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt; = &lt;<span class="built_in">bytes</span>&gt;.join(&lt;coll_of_bytes&gt;)  <span class="comment"># Joins elements using bytes object as separator. </span></span><br></pre></td></tr></table></figure>

<h3 id="Encode-1"><a href="#Encode-1" class="headerlink" title="Encode"></a>Encode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">bytes</span>&gt; = &lt;<span class="built_in">str</span>&gt;.encode(<span class="string">&#x27;utf-8&#x27;</span>)          <span class="comment"># Or: bytes(&lt;str&gt;, &#x27;utf-8&#x27;)</span></span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt; = <span class="built_in">bytes</span>(&lt;coll_of_ints&gt;)          <span class="comment"># Ints must be in range from 0 to 255.</span></span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt; = &lt;<span class="built_in">int</span>&gt;.to_bytes(&lt;length&gt;, byteorder=<span class="string">&#x27;big|little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt; = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;&lt;hex&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Decode-1"><a href="#Decode-1" class="headerlink" title="Decode"></a>Decode</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">str</span>&gt;   = &lt;<span class="built_in">bytes</span>&gt;.decode(<span class="string">&#x27;utf-8&#x27;</span>)        <span class="comment"># Or: str(&lt;bytes&gt;, &#x27;utf-8&#x27;)</span></span><br><span class="line">&lt;<span class="built_in">list</span>&gt;  = <span class="built_in">list</span>(&lt;<span class="built_in">bytes</span>&gt;)                  <span class="comment"># Returns ints in range from 0 to 255.</span></span><br><span class="line">&lt;<span class="built_in">int</span>&gt;   = <span class="built_in">int</span>.from_bytes(&lt;<span class="built_in">bytes</span>&gt;, byteorder=<span class="string">&#x27;big|little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line"><span class="string">&#x27;&lt;hex&gt;&#x27;</span> = &lt;<span class="built_in">bytes</span>&gt;.<span class="built_in">hex</span>()</span><br></pre></td></tr></table></figure>

<h3 id="Read-Bytes-from-File"><a href="#Read-Bytes-from-File" class="headerlink" title="Read Bytes from File"></a>Read Bytes from File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_bytes</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.read()</span><br></pre></td></tr></table></figure>

<h3 id="Write-Bytes-to-File"><a href="#Write-Bytes-to-File" class="headerlink" title="Write Bytes to File"></a>Write Bytes to File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_bytes</span>(<span class="params">filename, bytes_obj</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(bytes_obj)</span><br></pre></td></tr></table></figure>


<h2 id="Struct"><a href="#Struct" class="headerlink" title="Struct"></a>Struct</h2><ul>
<li><strong>Module that performs conversions between a sequence of numbers and a C struct, represented as a Python bytes object.</strong></li>
<li><strong>Machineâs native type sizes and byte order are used by default.</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack, iter_unpack, calcsize</span><br><span class="line">&lt;<span class="built_in">bytes</span>&gt;  = pack(<span class="string">&#x27;&lt;format&gt;&#x27;</span>, &lt;num_1&gt; [, &lt;num_2&gt;, ...])</span><br><span class="line">&lt;<span class="built_in">tuple</span>&gt;  = unpack(<span class="string">&#x27;&lt;format&gt;&#x27;</span>, &lt;<span class="built_in">bytes</span>&gt;)</span><br><span class="line">&lt;tuples&gt; = iter_unpack(<span class="string">&#x27;&lt;format&gt;&#x27;</span>, &lt;<span class="built_in">bytes</span>&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>pack(<span class="string">&#x27;&gt;hhl&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="string">b&#x27;\x00\x01\x00\x02\x00\x00\x00\x03&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>unpack(<span class="string">&#x27;&gt;hhl&#x27;</span>, <span class="string">b&#x27;\x00\x01\x00\x02\x00\x00\x00\x03&#x27;</span>)</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>calcsize(<span class="string">&#x27;&gt;hhl&#x27;</span>)</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>

<h3 id="Format-2"><a href="#Format-2" class="headerlink" title="Format"></a>Format</h3><h4 id="For-standard-sizes-start-format-string-with"><a href="#For-standard-sizes-start-format-string-with" class="headerlink" title="For standard sizes start format string with:"></a>For standard sizes start format string with:</h4><ul>
<li><strong><code>&#39;=&#39;</code> - native byte order</strong></li>
<li><strong><code>&#39;&lt;&#39;</code> - little-endian</strong></li>
<li><strong><code>&#39;&gt;&#39;</code> - big-endian</strong></li>
</ul>
<h4 id="Integer-types-Use-capital-letter-for-unsigned-type-Standard-sizes-are-in-brackets"><a href="#Integer-types-Use-capital-letter-for-unsigned-type-Standard-sizes-are-in-brackets" class="headerlink" title="Integer types. Use capital letter for unsigned type. Standard sizes are in brackets:"></a>Integer types. Use capital letter for unsigned type. Standard sizes are in brackets:</h4><ul>
<li><strong><code>&#39;x&#39;</code> - pad byte</strong></li>
<li><strong><code>&#39;b&#39;</code> - char (1)</strong></li>
<li><strong><code>&#39;h&#39;</code> - short (2)</strong></li>
<li><strong><code>&#39;i&#39;</code> - int (4)</strong></li>
<li><strong><code>&#39;l&#39;</code> - long (4)</strong></li>
<li><strong><code>&#39;q&#39;</code> - long long (8)</strong></li>
</ul>
<h4 id="Floating-point-types"><a href="#Floating-point-types" class="headerlink" title="Floating point types:"></a>Floating point types:</h4><ul>
<li><strong><code>&#39;f&#39;</code> - float (4)</strong></li>
<li><strong><code>&#39;d&#39;</code> - double (8)</strong></li>
</ul>
<h2 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h2><p><strong>List that can only hold numbers of predefined type. Available types and their sizes in bytes are listed above.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> array <span class="keyword">import</span> array</span><br><span class="line">&lt;array&gt; = array(<span class="string">&#x27;&lt;typecode&gt;&#x27;</span> [, &lt;collection&gt;])</span><br></pre></td></tr></table></figure>


<h2 id="Memory-View"><a href="#Memory-View" class="headerlink" title="Memory View"></a>Memory View</h2><p><strong>Used for accessing the internal data of an object that supports the buffer protocol.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">memoryview</span>&gt; = <span class="built_in">memoryview</span>(&lt;<span class="built_in">bytes</span>&gt; / &lt;<span class="built_in">bytearray</span>&gt; / &lt;array&gt;)</span><br><span class="line">&lt;<span class="built_in">memoryview</span>&gt;.release()</span><br></pre></td></tr></table></figure>


<h2 id="Deque"><a href="#Deque" class="headerlink" title="Deque"></a>Deque</h2><p><strong>A thread-safe list with efficient appends and pops from either side. Pronounced âdeckâ.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">&lt;deque&gt; = deque(&lt;collection&gt;, maxlen=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;deque&gt;.appendleft(&lt;el&gt;)</span><br><span class="line">&lt;el&gt; = &lt;deque&gt;.popleft()</span><br><span class="line">&lt;deque&gt;.extendleft(&lt;collection&gt;)            <span class="comment"># Collection gets reversed.</span></span><br><span class="line">&lt;deque&gt;.rotate(n=<span class="number">1</span>)                         <span class="comment"># Rotates elements to the right.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = deque([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], maxlen=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.append(<span class="number">4</span>)</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.appendleft(<span class="number">5</span>)</span><br><span class="line">[<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.insert(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">IndexError: deque already at its maximum size</span><br></pre></td></tr></table></figure>


<h2 id="Threading"><a href="#Threading" class="headerlink" title="Threading"></a>Threading</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, RLock</span><br></pre></td></tr></table></figure>

<h3 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">thread = Thread(target=&lt;function&gt;, args=(&lt;first_arg&gt;, ))</span><br><span class="line">thread.start()</span><br><span class="line">...</span><br><span class="line">thread.join()</span><br></pre></td></tr></table></figure>

<h3 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lock = RLock()</span><br><span class="line">lock.acquire()</span><br><span class="line">...</span><br><span class="line">lock.release()</span><br></pre></td></tr></table></figure>

<h4 id="Or"><a href="#Or" class="headerlink" title="Or:"></a>Or:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lock = RLock()</span><br><span class="line"><span class="keyword">with</span> lock:</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>


<h2 id="Introspection"><a href="#Introspection" class="headerlink" title="Introspection"></a>Introspection</h2><p><strong>Inspecting code at runtime.</strong></p>
<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">list</span>&gt; = <span class="built_in">dir</span>()      <span class="comment"># Names of variables in current scope.</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = <span class="built_in">locals</span>()   <span class="comment"># Dict of local variables. Also vars().</span></span><br><span class="line">&lt;<span class="built_in">dict</span>&gt; = <span class="built_in">globals</span>()  <span class="comment"># Dict of global variables.</span></span><br></pre></td></tr></table></figure>

<h3 id="Attributes-1"><a href="#Attributes-1" class="headerlink" title="Attributes"></a>Attributes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">dict</span>&gt; = <span class="built_in">vars</span>(&lt;<span class="built_in">object</span>&gt;)</span><br><span class="line">&lt;<span class="built_in">bool</span>&gt; = <span class="built_in">hasattr</span>(&lt;<span class="built_in">object</span>&gt;, <span class="string">&#x27;&lt;attr_name&gt;&#x27;</span>)</span><br><span class="line">value  = <span class="built_in">getattr</span>(&lt;<span class="built_in">object</span>&gt;, <span class="string">&#x27;&lt;attr_name&gt;&#x27;</span>)</span><br><span class="line"><span class="built_in">setattr</span>(&lt;<span class="built_in">object</span>&gt;, <span class="string">&#x27;&lt;attr_name&gt;&#x27;</span>, value)</span><br></pre></td></tr></table></figure>

<h3 id="Parameters-1"><a href="#Parameters-1" class="headerlink" title="Parameters"></a>Parameters</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> inspect <span class="keyword">import</span> signature</span><br><span class="line">&lt;sig&gt;        = signature(&lt;function&gt;)</span><br><span class="line">no_of_params = <span class="built_in">len</span>(&lt;sig&gt;.parameters)</span><br><span class="line">param_names  = <span class="built_in">list</span>(&lt;sig&gt;.parameters.keys())</span><br></pre></td></tr></table></figure>


<h2 id="Metaprograming"><a href="#Metaprograming" class="headerlink" title="Metaprograming"></a>Metaprograming</h2><p><strong>Code that generates code.</strong></p>
<h3 id="Type-1"><a href="#Type-1" class="headerlink" title="Type"></a>Type</h3><p><strong>Type is the root class. If only passed an object it returns its type (class). Otherwise it creates a new class.</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;class&gt; = type(&lt;class_name&gt;, &lt;parents_tuple&gt;, &lt;attributes_dict&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Z = <span class="built_in">type</span>(<span class="string">&#x27;Z&#x27;</span>, (), &#123;<span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;abcde&#x27;</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">12345</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z = Z()</span><br></pre></td></tr></table></figure>

<h3 id="Meta-Class"><a href="#Meta-Class" class="headerlink" title="Meta Class"></a>Meta Class</h3><p><strong>Class that creates class.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_meta_class</span>(<span class="params">name, parents, attrs</span>):</span></span><br><span class="line">    attrs[<span class="string">&#x27;a&#x27;</span>] = <span class="string">&#x27;abcde&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">type</span>(name, parents, attrs)</span><br></pre></td></tr></table></figure>

<h4 id="Or-1"><a href="#Or-1" class="headerlink" title="Or:"></a>Or:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMetaClass</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, name, parents, attrs</span>):</span></span><br><span class="line">        attrs[<span class="string">&#x27;a&#x27;</span>] = <span class="string">&#x27;abcde&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>.__new__(cls, name, parents, attrs)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>New() is a class method that gets called before init(). If it returns an instance of its class, then that instance gets passed to init() as a âselfâ argument.</strong></li>
<li><strong>It receives the same arguments as init(), except for the first one that specifies the desired class of returned instance (</strong><code>&#39;MyMetaClass&#39;</code> <strong>in our case).</strong></li>
<li><strong>New() can also be called directly, usually from a new() method of a child class (</strong><code>def __new__(cls): return super().__new__(cls)</code><strong>), in which case init() is not called.</strong></li>
</ul>
<h3 id="Metaclass-Attribute"><a href="#Metaclass-Attribute" class="headerlink" title="Metaclass Attribute"></a>Metaclass Attribute</h3><p><strong>Right before a class is created it checks if it has metaclass defined. If not, it recursively checks if any of his parents has it defined and eventually comes to type().</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>(<span class="params">metaclass=MyMetaClass</span>):</span></span><br><span class="line">    b = <span class="number">12345</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>MyClass.a, MyClass.b</span><br><span class="line">(<span class="string">&#x27;abcde&#x27;</span>, <span class="number">12345</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Type-Diagram"><a href="#Type-Diagram" class="headerlink" title="Type Diagram"></a>Type Diagram</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span>(MyClass)     == MyMetaClass  <span class="comment"># MyClass is an instance of MyMetaClass.</span></span><br><span class="line"><span class="built_in">type</span>(MyMetaClass) == <span class="built_in">type</span>         <span class="comment"># MyMetaClass is an instance of type.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------+-------------+</span><br><span class="line">| Classes | Metaclasses |</span><br><span class="line">+---------+-------------|</span><br><span class="line">| MyClass &gt; MyMetaClass |</span><br><span class="line">|         |     v       |</span><br><span class="line">|  object ---&gt; type &lt;+  |</span><br><span class="line">|         |    ^ +---+  |</span><br><span class="line">|   str -------+        |</span><br><span class="line">+---------+-------------+</span><br></pre></td></tr></table></figure>

<h3 id="Inheritance-Diagram"><a href="#Inheritance-Diagram" class="headerlink" title="Inheritance Diagram"></a>Inheritance Diagram</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyClass.__base__     == <span class="built_in">object</span>    <span class="comment"># MyClass is a subclass of object.</span></span><br><span class="line">MyMetaClass.__base__ == <span class="built_in">type</span>      <span class="comment"># MyMetaClass is a subclass of type.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------+-------------+</span><br><span class="line">| Classes | Metaclasses |</span><br><span class="line">+---------+-------------|</span><br><span class="line">| MyClass | MyMetaClass |</span><br><span class="line">|    v    |     v       |</span><br><span class="line">|  object &lt;--- type     |</span><br><span class="line">|    ^    |             |</span><br><span class="line">|   str   |             |</span><br><span class="line">+---------+-------------+</span><br></pre></td></tr></table></figure>


<h2 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add, sub, mul, truediv, floordiv, mod, <span class="built_in">pow</span>, neg, <span class="built_in">abs</span></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> eq, ne, lt, le, gt, ge</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> and_, or_, not_</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter, attrgetter, methodcaller</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> operator <span class="keyword">as</span> op</span><br><span class="line">sorted_by_second = <span class="built_in">sorted</span>(&lt;collection&gt;, key=op.itemgetter(<span class="number">1</span>))</span><br><span class="line">sorted_by_both   = <span class="built_in">sorted</span>(&lt;collection&gt;, key=op.itemgetter(<span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">product_of_elems = functools.reduce(op.mul, &lt;collection&gt;)</span><br><span class="line">LogicOp          = enum.Enum(<span class="string">&#x27;LogicOp&#x27;</span>, &#123;<span class="string">&#x27;AND&#x27;</span>: op.and_, <span class="string">&#x27;OR&#x27;</span> : op.or_&#125;)</span><br><span class="line">last_el          = op.methodcaller(<span class="string">&#x27;pop&#x27;</span>)(&lt;<span class="built_in">list</span>&gt;)</span><br></pre></td></tr></table></figure>


<h2 id="Eval"><a href="#Eval" class="headerlink" title="Eval"></a>Eval</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> ast <span class="keyword">import</span> literal_eval</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>literal_eval(<span class="string">&#x27;1 + 2&#x27;</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>literal_eval(<span class="string">&#x27;[1, 2, 3]&#x27;</span>)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>literal_eval(<span class="string">&#x27;abs(1)&#x27;</span>)</span><br><span class="line">ValueError: malformed node <span class="keyword">or</span> string</span><br></pre></td></tr></table></figure>


<h2 id="Coroutine"><a href="#Coroutine" class="headerlink" title="Coroutine"></a>Coroutine</h2><ul>
<li><strong>Similar to generator, but generator pulls data through the pipe with iteration, while coroutine pushes data into the pipeline with send().</strong></li>
<li><strong>Coroutines provide more powerful data routing possibilities than iterators.</strong></li>
<li><strong>If you build a collection of simple data processing components, you can glue them together into complex arrangements of pipes, branches, merging, etc.</strong></li>
</ul>
<h3 id="Helper-Decorator"><a href="#Helper-Decorator" class="headerlink" title="Helper Decorator"></a>Helper Decorator</h3><ul>
<li><strong>All coroutines must be âprimedâ by first calling next().</strong></li>
<li><strong>Remembering to call next() is easy to forget.</strong></li>
<li><strong>Solved by wrapping coroutines with a decorator:</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">coroutine</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        cr = func(*args, **kwargs)</span><br><span class="line">        <span class="built_in">next</span>(cr)</span><br><span class="line">        <span class="keyword">return</span> cr</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<h3 id="Pipeline-Example"><a href="#Pipeline-Example" class="headerlink" title="Pipeline Example"></a>Pipeline Example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reader</span>(<span class="params">target</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        target.send(i)</span><br><span class="line">    target.close()</span><br><span class="line"></span><br><span class="line"><span class="meta">@coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">adder</span>(<span class="params">target</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        value = (<span class="keyword">yield</span>)</span><br><span class="line">        target.send(value + <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printer</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        value = (<span class="keyword">yield</span>)</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line"></span><br><span class="line">reader(adder(printer()))  <span class="comment"># 100, 101, ..., 109</span></span><br></pre></td></tr></table></figure>

<p><br><br></p>
<h1 id="Libraries"><a href="#Libraries" class="headerlink" title="Libraries"></a>Libraries</h1><h2 id="Progress-Bar"><a href="#Progress-Bar" class="headerlink" title="Progress Bar"></a>Progress Bar</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install tqdm</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]):</span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">100</span>)):</span><br><span class="line">    sleep(<span class="number">0.02</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Plot"><a href="#Plot" class="headerlink" title="Plot"></a>Plot</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install matplotlib</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot</span><br><span class="line">pyplot.plot(&lt;data_1&gt; [, &lt;data_2&gt;, ...])  <span class="comment"># Or: hist(&lt;data&gt;).</span></span><br><span class="line">pyplot.savefig(&lt;filename&gt;)</span><br><span class="line">pyplot.show()</span><br><span class="line">pyplot.clf()                             <span class="comment"># Clears figure.</span></span><br></pre></td></tr></table></figure>


<h2 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h2><h4 id="Prints-a-CSV-file-as-an-ASCII-table"><a href="#Prints-a-CSV-file-as-an-ASCII-table" class="headerlink" title="Prints a CSV file as an ASCII table:"></a>Prints a CSV file as an ASCII table:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install tabulate</span></span><br><span class="line"><span class="keyword">from</span> tabulate <span class="keyword">import</span> tabulate</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(&lt;filename&gt;, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    lines   = csv.reader(file)</span><br><span class="line">    headers = [header.title() <span class="keyword">for</span> header <span class="keyword">in</span> <span class="built_in">next</span>(lines)]</span><br><span class="line">    table   = tabulate(lines, headers)</span><br><span class="line">    <span class="built_in">print</span>(table)</span><br></pre></td></tr></table></figure>


<h2 id="Curses"><a href="#Curses" class="headerlink" title="Curses"></a>Curses</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> curses <span class="keyword">import</span> wrapper, <span class="built_in">ascii</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    wrapper(draw)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw</span>(<span class="params">screen</span>):</span></span><br><span class="line">    screen.clear()</span><br><span class="line">    screen.addstr(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;Press ESC to quit.&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> screen.getch() != <span class="built_in">ascii</span>.ESC:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_border</span>(<span class="params">screen</span>):</span></span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">    P = namedtuple(<span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;y x&#x27;</span>)</span><br><span class="line">    height, width = screen.getmaxyx()</span><br><span class="line">    <span class="keyword">return</span> P(height-<span class="number">1</span>, width-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


<h2 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install loguru</span></span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">logger.add(<span class="string">&#x27;debug_&#123;time&#125;.log&#x27;</span>, colorize=<span class="literal">True</span>)  <span class="comment"># Connects a log file.</span></span><br><span class="line">logger.add(<span class="string">&#x27;error_&#123;time&#125;.log&#x27;</span>, level=<span class="string">&#x27;ERROR&#x27;</span>)  <span class="comment"># Another file for errors or higher.</span></span><br><span class="line">logger.&lt;level&gt;(<span class="string">&#x27;A logging message.&#x27;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Levels: <code>&#39;debug&#39;</code>, <code>&#39;info&#39;</code>, <code>&#39;success&#39;</code>, <code>&#39;warning&#39;</code>, <code>&#39;error&#39;</code>, <code>&#39;critical&#39;</code>.</strong></li>
</ul>
<h3 id="Exceptions-2"><a href="#Exceptions-2" class="headerlink" title="Exceptions"></a>Exceptions</h3><p><strong>Error description, stack trace and values of variables are appended automatically.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">except</span> &lt;exception&gt;:</span><br><span class="line">    logger.exception(<span class="string">&#x27;An error happened.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Rotation"><a href="#Rotation" class="headerlink" title="Rotation"></a>Rotation</h3><p><strong>Argument that sets a condition when a new log file is created.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rotation=&lt;<span class="built_in">int</span>&gt;|&lt;datetime.timedelta&gt;|&lt;datetime.time&gt;|&lt;<span class="built_in">str</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>&#39;&lt;int&gt;&#39;</code> - Max file size in bytes.</strong></li>
<li><strong><code>&#39;&lt;timedelta&gt;&#39;</code> - Max age of a file.</strong></li>
<li><strong><code>&#39;&lt;time&gt;&#39;</code> - Time of day.</strong></li>
<li><strong><code>&#39;&lt;str&gt;&#39;</code> - Any of above as a string: <code>&#39;100 MB&#39;</code>, <code>&#39;1 month&#39;</code>, <code>&#39;monday at 12:00&#39;</code>, â¦</strong></li>
</ul>
<h3 id="Retention"><a href="#Retention" class="headerlink" title="Retention"></a>Retention</h3><p><strong>Sets a condition which old log files are deleted.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">retention=&lt;<span class="built_in">int</span>&gt;|&lt;datetime.timedelta&gt;|&lt;<span class="built_in">str</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>&#39;&lt;int&gt;&#39;</code> - Max number of files.</strong></li>
<li><strong><code>&#39;&lt;timedelta&gt;&#39;</code> - Max age of a file.</strong></li>
<li><strong><code>&#39;&lt;str&gt;&#39;</code> - Max age as a string: <code>&#39;1 week, 3 days&#39;</code>, <code>&#39;2 months&#39;</code>, â¦</strong></li>
</ul>
<h2 id="Scraping"><a href="#Scraping" class="headerlink" title="Scraping"></a>Scraping</h2><h4 id="Scrapes-and-prints-Pythonâs-URL-and-version-number-from-Wikipedia"><a href="#Scrapes-and-prints-Pythonâs-URL-and-version-number-from-Wikipedia" class="headerlink" title="Scrapes and prints Pythonâs URL and version number from Wikipedia:"></a>Scrapes and prints Pythonâs URL and version number from Wikipedia:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install requests beautifulsoup4</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">url   = <span class="string">&#x27;https://en.wikipedia.org/wiki/Python_(programming_language)&#x27;</span></span><br><span class="line">page  = requests.get(url)</span><br><span class="line">doc   = BeautifulSoup(page.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">table = doc.find(<span class="string">&#x27;table&#x27;</span>, class_=<span class="string">&#x27;infobox vevent&#x27;</span>)</span><br><span class="line">rows  = table.find_all(<span class="string">&#x27;tr&#x27;</span>)</span><br><span class="line">link  = rows[<span class="number">11</span>].find(<span class="string">&#x27;a&#x27;</span>)[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">ver   = rows[<span class="number">6</span>].find(<span class="string">&#x27;div&#x27;</span>).text.split()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(link, ver)</span><br></pre></td></tr></table></figure>


<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install bottle</span></span><br><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> run, route, post, template, request, response</span><br><span class="line"><span class="keyword">import</span> json</span><br></pre></td></tr></table></figure>

<h3 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line">run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>, server=<span class="string">&#x27;cherrypy&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Static-Request"><a href="#Static-Request" class="headerlink" title="Static Request"></a>Static Request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/img/&lt;image&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_image</span>(<span class="params">image</span>):</span></span><br><span class="line">    <span class="keyword">return</span> static_file(image, <span class="string">&#x27;images/&#x27;</span>, mimetype=<span class="string">&#x27;image/png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Dynamic-Request"><a href="#Dynamic-Request" class="headerlink" title="Dynamic Request"></a>Dynamic Request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/&lt;sport&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_page</span>(<span class="params">sport</span>):</span></span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">&#x27;&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;&#x27;</span>, title=sport)</span><br></pre></td></tr></table></figure>

<h3 id="REST-Request"><a href="#REST-Request" class="headerlink" title="REST Request"></a>REST Request</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@post(<span class="params"><span class="string">&#x27;/odds/&lt;sport&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odds_handler</span>(<span class="params">sport</span>):</span></span><br><span class="line">    team = request.forms.get(<span class="string">&#x27;team&#x27;</span>)</span><br><span class="line">    home_odds, away_odds = <span class="number">2.44</span>, <span class="number">3.29</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Cache-Control&#x27;</span>] = <span class="string">&#x27;no-cache&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps([team, home_odds, away_odds])</span><br></pre></td></tr></table></figure>

<h4 id="Test"><a href="#Test" class="headerlink" title="Test:"></a>Test:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install requests</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> requests</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url  = <span class="string">&#x27;http://localhost:8080/odds/football&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = &#123;<span class="string">&#x27;team&#x27;</span>: <span class="string">&#x27;arsenal f.c.&#x27;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>response = requests.post(url, data=data)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>response.json()</span><br><span class="line">[<span class="string">&#x27;arsenal f.c.&#x27;</span>, <span class="number">2.44</span>, <span class="number">3.29</span>]</span><br></pre></td></tr></table></figure>


<h2 id="Profile"><a href="#Profile" class="headerlink" title="Profile"></a>Profile</h2><h3 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line">start_time = time()                  <span class="comment"># Seconds since Epoch.</span></span><br><span class="line">...</span><br><span class="line">duration = time() - start_time</span><br></pre></td></tr></table></figure>

<h3 id="High-Performance"><a href="#High-Performance" class="headerlink" title="High Performance"></a>High Performance</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter <span class="keyword">as</span> pc</span><br><span class="line">start_time = pc()                    <span class="comment"># Seconds since restart.</span></span><br><span class="line">...</span><br><span class="line">duration = pc() - start_time</span><br></pre></td></tr></table></figure>

<h3 id="Timing-a-Snippet"><a href="#Timing-a-Snippet" class="headerlink" title="Timing a Snippet"></a>Timing a Snippet</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> timeit <span class="keyword">import</span> timeit</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timeit(<span class="string">&#x27;&quot;-&quot;.join(str(a) for a in range(100))&#x27;</span>,</span><br><span class="line"><span class="meta">... </span>       number=<span class="number">10000</span>, <span class="built_in">globals</span>=<span class="built_in">globals</span>(), setup=<span class="string">&#x27;pass&#x27;</span>)</span><br><span class="line"><span class="number">0.34986</span></span><br></pre></td></tr></table></figure>

<h3 id="Line-Profiler"><a href="#Line-Profiler" class="headerlink" title="Line Profiler"></a>Line Profiler</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install line_profiler</span></span><br><span class="line"><span class="meta">@profile</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    a = [*<span class="built_in">range</span>(<span class="number">10000</span>)]</span><br><span class="line">    b = &#123;*<span class="built_in">range</span>(<span class="number">10000</span>)&#125;</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h4 id="Usage"><a href="#Usage" class="headerlink" title="Usage:"></a>Usage:</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ kernprof -lv test.py</span><br><span class="line">Line #      Hits         Time  Per Hit   % Time  Line Contents</span><br><span class="line">==============================================================</span><br><span class="line">     1                                           @profile</span><br><span class="line">     2                                           def main():</span><br><span class="line">     3         1       1128.0   1128.0     27.4      a = [*range(10000)]</span><br><span class="line">     4         1       2994.0   2994.0     72.6      b = &#123;*range(10000)&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Call-Graph"><a href="#Call-Graph" class="headerlink" title="Call Graph"></a>Call Graph</h3><h4 id="Generates-a-PNG-image-of-a-call-graph-with-highlighted-bottlenecks"><a href="#Generates-a-PNG-image-of-a-call-graph-with-highlighted-bottlenecks" class="headerlink" title="Generates a PNG image of a call graph with highlighted bottlenecks:"></a>Generates a PNG image of a call graph with highlighted bottlenecks:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install pycallgraph</span></span><br><span class="line"><span class="keyword">from</span> pycallgraph <span class="keyword">import</span> output, PyCallGraph</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">time_str = datetime.now().strftime(<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>)</span><br><span class="line">filename = <span class="string">f&#x27;profile-<span class="subst">&#123;time_str&#125;</span>.png&#x27;</span></span><br><span class="line">drawer = output.GraphvizOutput(output_file=filename)</span><br><span class="line"><span class="keyword">with</span> PyCallGraph(drawer):</span><br><span class="line">    &lt;code_to_be_profiled&gt;</span><br></pre></td></tr></table></figure>


<h2 id="NumPy"><a href="#NumPy" class="headerlink" title="NumPy"></a>NumPy</h2><p><strong>Array manipulation mini language. Can run up to one hundred times faster than equivalent Python code.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install numpy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;array&gt; = np.array(&lt;<span class="built_in">list</span>&gt;)</span><br><span class="line">&lt;array&gt; = np.arange(from_inclusive, to_exclusive, Â±step_size)</span><br><span class="line">&lt;array&gt; = np.ones(&lt;shape&gt;)</span><br><span class="line">&lt;array&gt; = np.random.randint(from_inclusive, to_exclusive, &lt;shape&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;array&gt;.shape = &lt;shape&gt;</span><br><span class="line">&lt;view&gt;  = &lt;array&gt;.reshape(&lt;shape&gt;)</span><br><span class="line">&lt;view&gt;  = np.broadcast_to(&lt;array&gt;, &lt;shape&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;array&gt; = &lt;array&gt;.<span class="built_in">sum</span>(axis)</span><br><span class="line">indexes = &lt;array&gt;.argmin(axis)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Shape is a tuple of dimension sizes.</strong></li>
<li><strong>Axis is an index of dimension that gets collapsed. Leftmost dimension has index 0.</strong></li>
</ul>
<h3 id="Indexing"><a href="#Indexing" class="headerlink" title="Indexing"></a>Indexing</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;el&gt;       = &lt;2d_array&gt;[0, 0]        <span class="comment"># First element.</span></span><br><span class="line">&lt;1d_view&gt;  = &lt;2d_array&gt;[0]           <span class="comment"># First row.</span></span><br><span class="line">&lt;1d_view&gt;  = &lt;2d_array&gt;[:, 0]        <span class="comment"># First column. Also [..., 0].</span></span><br><span class="line">&lt;3d_view&gt;  = &lt;2d_array&gt;[None, :, :]  <span class="comment"># Expanded by dimension of size 1.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;1d_array&gt; = &lt;2d_array&gt;[&lt;1d_row_indexes&gt;, &lt;1d_column_indexes&gt;]</span><br><span class="line">&lt;2d_array&gt; = &lt;2d_array&gt;[&lt;2d_row_indexes&gt;, &lt;2d_column_indexes&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;2d_bools&gt; = &lt;2d_array&gt; &gt; 0</span><br><span class="line">&lt;1d_array&gt; = &lt;2d_array&gt;[&lt;2d_bools&gt;]</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>If row and column indexes differ in shape, they are combined with broadcasting.</strong></li>
</ul>
<h3 id="Broadcasting"><a href="#Broadcasting" class="headerlink" title="Broadcasting"></a>Broadcasting</h3><p><strong>Broadcasting is a set of rules by which NumPy functions operate on arrays of different sizes and/or dimensions.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left  = [[<span class="number">0.1</span>], [<span class="number">0.6</span>], [<span class="number">0.8</span>]]  <span class="comment"># Shape: (3, 1)</span></span><br><span class="line">right = [ <span class="number">0.1</span> ,  <span class="number">0.6</span> ,  <span class="number">0.8</span> ]  <span class="comment"># Shape: (3)</span></span><br></pre></td></tr></table></figure>

<h4 id="1-If-array-shapes-differ-in-length-left-pad-the-shorter-shape-with-ones"><a href="#1-If-array-shapes-differ-in-length-left-pad-the-shorter-shape-with-ones" class="headerlink" title="1. If array shapes differ in length, left-pad the shorter shape with ones:"></a>1. If array shapes differ in length, left-pad the shorter shape with ones:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left  = [[<span class="number">0.1</span>], [<span class="number">0.6</span>], [<span class="number">0.8</span>]]  <span class="comment"># Shape: (3, 1)</span></span><br><span class="line">right = [[<span class="number">0.1</span> ,  <span class="number">0.6</span> ,  <span class="number">0.8</span>]]  <span class="comment"># Shape: (1, 3) &lt;- !</span></span><br></pre></td></tr></table></figure>

<h4 id="2-If-any-dimensions-differ-in-size-expand-the-ones-that-have-size-1-by-duplicating-their-elements"><a href="#2-If-any-dimensions-differ-in-size-expand-the-ones-that-have-size-1-by-duplicating-their-elements" class="headerlink" title="2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:"></a>2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left  = [[<span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0.1</span>], [<span class="number">0.6</span>, <span class="number">0.6</span>, <span class="number">0.6</span>], [<span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">0.8</span>]]  <span class="comment"># Shape: (3, 3) &lt;- !</span></span><br><span class="line">right = [[<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>], [<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>], [<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>]]  <span class="comment"># Shape: (3, 3) &lt;- !</span></span><br></pre></td></tr></table></figure>

<h4 id="3-If-neither-non-matching-dimension-has-size-1-rise-an-error"><a href="#3-If-neither-non-matching-dimension-has-size-1-rise-an-error" class="headerlink" title="3. If neither non-matching dimension has size 1, rise an error."></a>3. If neither non-matching dimension has size 1, rise an error.</h4><h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><h4 id="For-each-point-returns-index-of-its-nearest-point-0-1-0-6-0-8-gt-1-2-1"><a href="#For-each-point-returns-index-of-its-nearest-point-0-1-0-6-0-8-gt-1-2-1" class="headerlink" title="For each point returns index of its nearest point ([0.1, 0.6, 0.8] =&gt; [1, 2, 1]):"></a>For each point returns index of its nearest point (<code>[0.1, 0.6, 0.8] =&gt; [1, 2, 1]</code>):</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>points = np.array([<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.8</span>])</span><br><span class="line">[ <span class="number">0.1</span>,  <span class="number">0.6</span>,  <span class="number">0.8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>wrapped_points = points.reshape(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">[[ <span class="number">0.1</span>],</span><br><span class="line"> [ <span class="number">0.6</span>],</span><br><span class="line"> [ <span class="number">0.8</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances = wrapped_points - points</span><br><span class="line">[[ <span class="number">0.</span> , -<span class="number">0.5</span>, -<span class="number">0.7</span>],</span><br><span class="line"> [ <span class="number">0.5</span>,  <span class="number">0.</span> , -<span class="number">0.2</span>],</span><br><span class="line"> [ <span class="number">0.7</span>,  <span class="number">0.2</span>,  <span class="number">0.</span> ]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances = np.<span class="built_in">abs</span>(distances)</span><br><span class="line">[[ <span class="number">0.</span> ,  <span class="number">0.5</span>,  <span class="number">0.7</span>],</span><br><span class="line"> [ <span class="number">0.5</span>,  <span class="number">0.</span> ,  <span class="number">0.2</span>],</span><br><span class="line"> [ <span class="number">0.7</span>,  <span class="number">0.2</span>,  <span class="number">0.</span> ]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>i = np.arange(<span class="number">3</span>)</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances[i, i] = np.inf</span><br><span class="line">[[ inf,  <span class="number">0.5</span>,  <span class="number">0.7</span>],</span><br><span class="line"> [ <span class="number">0.5</span>,  inf,  <span class="number">0.2</span>],</span><br><span class="line"> [ <span class="number">0.7</span>,  <span class="number">0.2</span>,  inf]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>distances.argmin(<span class="number">1</span>)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>


<h2 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install pillow</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br></pre></td></tr></table></figure>

<h4 id="Creates-a-PNG-image-of-a-rainbow-gradient"><a href="#Creates-a-PNG-image-of-a-rainbow-gradient" class="headerlink" title="Creates a PNG image of a rainbow gradient:"></a>Creates a PNG image of a rainbow gradient:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">width  = <span class="number">100</span></span><br><span class="line">height = <span class="number">100</span></span><br><span class="line">size   = width * height</span><br><span class="line">pixels = [<span class="number">255</span> * i/size <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size)]</span><br><span class="line"></span><br><span class="line">img = Image.new(<span class="string">&#x27;HSV&#x27;</span>, (width, height))</span><br><span class="line">img.putdata([(<span class="built_in">int</span>(a), <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">for</span> a <span class="keyword">in</span> pixels])</span><br><span class="line">img.convert(mode=<span class="string">&#x27;RGB&#x27;</span>).save(<span class="string">&#x27;test.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Adds-noise-to-a-PNG-image"><a href="#Adds-noise-to-a-PNG-image" class="headerlink" title="Adds noise to a PNG image:"></a>Adds noise to a PNG image:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">add_noise = <span class="keyword">lambda</span> value: <span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">min</span>(<span class="number">255</span>, value + randint(-<span class="number">20</span>, <span class="number">20</span>)))</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;test.png&#x27;</span>).convert(mode=<span class="string">&#x27;HSV&#x27;</span>)</span><br><span class="line">img.putdata([(add_noise(h), s, v) <span class="keyword">for</span> h, s, v <span class="keyword">in</span> img.getdata()])</span><br><span class="line">img.convert(mode=<span class="string">&#x27;RGB&#x27;</span>).save(<span class="string">&#x27;test.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Modes-1"><a href="#Modes-1" class="headerlink" title="Modes"></a>Modes</h3><ul>
<li><strong><code>&#39;1&#39;</code> - 1-bit pixels, black and white, stored with one pixel per byte.</strong></li>
<li><strong><code>&#39;L&#39;</code> - 8-bit pixels, greyscale.</strong></li>
<li><strong><code>&#39;RGB&#39;</code> - 3x8-bit pixels, true color.</strong></li>
<li><strong><code>&#39;RGBA&#39;</code> - 4x8-bit pixels, true color with transparency mask.</strong></li>
<li><strong><code>&#39;HSV&#39;</code> - 3x8-bit pixels, Hue, Saturation, Value color space.</strong></li>
</ul>
<h2 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wave</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, iter_unpack</span><br></pre></td></tr></table></figure>

<h3 id="Read-Frames-from-WAV-File"><a href="#Read-Frames-from-WAV-File" class="headerlink" title="Read Frames from WAV File"></a>Read Frames from WAV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_wav_file</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> wave.<span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> wf:</span><br><span class="line">        frames = wf.readframes(wf.getnframes())</span><br><span class="line">        <span class="keyword">return</span> [a[<span class="number">0</span>] <span class="keyword">for</span> a <span class="keyword">in</span> iter_unpack(<span class="string">&#x27;&lt;h&#x27;</span>, frames)]</span><br></pre></td></tr></table></figure>

<h3 id="Write-Frames-to-WAV-File"><a href="#Write-Frames-to-WAV-File" class="headerlink" title="Write Frames to WAV File"></a>Write Frames to WAV File</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_wav_file</span>(<span class="params">filename, frames_int, mono=<span class="literal">True</span></span>):</span></span><br><span class="line">    frames_short = (pack(<span class="string">&#x27;&lt;h&#x27;</span>, a) <span class="keyword">for</span> a <span class="keyword">in</span> frames_int)</span><br><span class="line">    <span class="keyword">with</span> wave.<span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> wf:</span><br><span class="line">        wf.setnchannels(<span class="number">1</span> <span class="keyword">if</span> mono <span class="keyword">else</span> <span class="number">2</span>)</span><br><span class="line">        wf.setsampwidth(<span class="number">2</span>)</span><br><span class="line">        wf.setframerate(<span class="number">44100</span>)</span><br><span class="line">        wf.writeframes(<span class="string">b&#x27;&#x27;</span>.join(frames_short))</span><br></pre></td></tr></table></figure>

<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><h4 id="Saves-a-sine-wave-to-a-mono-WAV-file"><a href="#Saves-a-sine-wave-to-a-mono-WAV-file" class="headerlink" title="Saves a sine wave to a mono WAV file:"></a>Saves a sine wave to a mono WAV file:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi, sin</span><br><span class="line">frames_f = (sin(i * <span class="number">2</span> * pi * <span class="number">440</span> / <span class="number">44100</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>))</span><br><span class="line">frames_i = (<span class="built_in">int</span>(a * <span class="number">30000</span>) <span class="keyword">for</span> a <span class="keyword">in</span> frames_f)</span><br><span class="line">write_to_wav_file(<span class="string">&#x27;test.wav&#x27;</span>, frames_i)</span><br></pre></td></tr></table></figure>

<h4 id="Adds-noise-to-a-mono-WAV-file"><a href="#Adds-noise-to-a-mono-WAV-file" class="headerlink" title="Adds noise to a mono WAV file:"></a>Adds noise to a mono WAV file:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">add_noise = <span class="keyword">lambda</span> value: <span class="built_in">max</span>(-<span class="number">32768</span>, <span class="built_in">min</span>(<span class="number">32767</span>, value + randint(-<span class="number">500</span>, <span class="number">500</span>)))</span><br><span class="line">frames_i  = (add_noise(a) <span class="keyword">for</span> a <span class="keyword">in</span> read_wav_file(<span class="string">&#x27;test.wav&#x27;</span>))</span><br><span class="line">write_to_wav_file(<span class="string">&#x27;test.wav&#x27;</span>, frames_i)</span><br></pre></td></tr></table></figure>

<h3 id="Synthesizer"><a href="#Synthesizer" class="headerlink" title="Synthesizer"></a>Synthesizer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># $ pip3 install simpleaudio</span></span><br><span class="line"><span class="keyword">import</span> simpleaudio, math, struct</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain, repeat</span><br><span class="line">F  = <span class="number">44100</span></span><br><span class="line">P1 = <span class="string">&#x27;71âª,69,,71âª,66,,62âª,66,,59âª,,,&#x27;</span></span><br><span class="line">P2 = <span class="string">&#x27;71âª,73,,74âª,73,,74,,71,,73âª,71,,73,,69,,71âª,69,,71,,67,,71âª,,,&#x27;</span></span><br><span class="line">get_pause  = <span class="keyword">lambda</span> seconds: repeat(<span class="number">0</span>, <span class="built_in">int</span>(seconds * F))</span><br><span class="line">sin_f      = <span class="keyword">lambda</span> i, hz: math.sin(i * <span class="number">2</span> * math.pi * hz / F)</span><br><span class="line">get_wave   = <span class="keyword">lambda</span> hz, seconds: (sin_f(i, hz) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(seconds * F)))</span><br><span class="line">get_hz     = <span class="keyword">lambda</span> key: <span class="number">8.176</span> * <span class="number">2</span> ** (<span class="built_in">int</span>(key) / <span class="number">12</span>)</span><br><span class="line">parse_note = <span class="keyword">lambda</span> note: (get_hz(note[:<span class="number">2</span>]), <span class="number">0.25</span> <span class="keyword">if</span> <span class="string">&#x27;âª&#x27;</span> <span class="keyword">in</span> note <span class="keyword">else</span> <span class="number">0.125</span>)</span><br><span class="line">get_frames = <span class="keyword">lambda</span> note: get_wave(*parse_note(note)) <span class="keyword">if</span> note <span class="keyword">else</span> get_pause(<span class="number">0.125</span>)</span><br><span class="line">frames_f   = chain.from_iterable(get_frames(n) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="string">f&#x27;<span class="subst">&#123;P1&#125;</span><span class="subst">&#123;P1&#125;</span><span class="subst">&#123;P2&#125;</span>&#x27;</span>.split(<span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">frames_b   = <span class="string">b&#x27;&#x27;</span>.join(struct.pack(<span class="string">&#x27;&lt;h&#x27;</span>, <span class="built_in">int</span>(f * <span class="number">30000</span>)) <span class="keyword">for</span> f <span class="keyword">in</span> frames_f)</span><br><span class="line">simpleaudio.play_buffer(frames_b, <span class="number">1</span>, <span class="number">2</span>, F)</span><br></pre></td></tr></table></figure>


<h2 id="Basic-Script-Template"><a href="#Basic-Script-Template" class="headerlink" title="Basic Script Template"></a>Basic Script Template</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage: .py</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> make_dataclass</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment">##  UTIL</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.readlines()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/Python%20Cheatsheet/" data-id="ckmn1li2c000pn8a8644g4ziy" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Pythonèªå®ä¹ååæ¨¡å" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/Python%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.924Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Pythonèªå®ä¹ååæ¨¡å"><a href="#Pythonèªå®ä¹ååæ¨¡å" class="headerlink" title="Pythonèªå®ä¹ååæ¨¡å"></a>Pythonèªå®ä¹ååæ¨¡å</h1><p>Dateï¼2019-07-26</p>
<p>å¨site-packagesè·¯å¾ä¸æ°å»ºä¸ä¸ªæä»¶åä»»æç.pthæä»¶ï¼å¨è¯¥pthæä»¶ä¸­æ·»å æ¯è¡æ·»å ä¸ä¸ªåæç´¢è·¯å¾ã</p>
<p>å¨Windowsä¸ï¼è¯¥æä»¶è·¯å¾ä¸ºï¼</p>
<p>D:\Program Files\Python37\Lib\site-packages\path.pth</p>
<p>ä¾å¦ææä»¶ç»ç»ç»æå¦ä¸ï¼</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">E:\Desktop\Learn\</span><br><span class="line">	app.py</span><br><span class="line">	tools.py</span><br><span class="line">		get_file()</span><br><span class="line">	python_tools\</span><br><span class="line">		__init.py__</span><br><span class="line">		tools.py</span><br><span class="line">			get_file()</span><br></pre></td></tr></table></figure>

<p>éè¦å¨app.pyä¸­ä½¿ç¨tools.pyä¸­çget_file()å½æ°ï¼æä¸¤ä¸ªæ¹æ³ï¼</p>
<ol>
<li><p>ç´æ¥å¼ç¨ã</p>
<p>å¨app.pyçå½åç®å½ä¸æ°å»ºtools.pyæä»¶ï¼å¨è¯¥æä»¶ä¸­ç¼åget_file()å½æ°ï¼å¨app.pyæä»¶ä¸­ä½¿ç¨<code>import tools.py</code>å¼ç¨è¯¥ååä½¿ç¨<code>tools.get_file()</code> è°ç¨å½æ°ã</p>
</li>
<li><p>ä»¥ç¬¬ä¸æ¹åçæ¹å¼å¼ç¨ã</p>
<ul>
<li>å¨ä»»æä½ç½®æ°å»ºä»¥ååå½åçæä»¶å¤¹ï¼ä¾å¦æ¬å¤ç<code>python_tools</code>ï¼å°è¯¥ä½ç½®æ·»å è³ä¸ææè¿°ç.pthæä»¶ä¸­ãå¨è¯¥æä»¶å¤¹åæ°å»º<code>__init.py__</code>æä»¶ï¼æä»¶åå®¹å¯ä¸ºç©ºç½ï¼Pythonè§£éå¨ä¼å°è¯¥ç®å½å½æåç®å½èéæ®éç®å½ãå¨è¯¥æä»¶å¤¹åæ°å»º<code>tools.py</code>æä»¶ï¼å¨è¯¥æä»¶ä¸­ç¼åget_file()å½æ°ãå¨<code>app.py</code>ä¸­ä½¿ç¨<code>from python_tools import tools </code>å¼ç¨è¯¥ååä½¿ç¨<code>tools.get_file()</code>è°ç¨å½æ°ã</li>
</ul>
</li>
</ol>
<ul>
<li>å¨ä¸è¿°<code>__init.py__</code>ï¼è¯¥æä»¶ä¼å¨é¦æ¬¡å¼ç¨è¯¥åæ¶æ§è¡ï¼ä¸­ä½¿ç¨<code>from .tools import *</code>å¼å¥  <code>tools.py</code>ä¸­çå¨é¨å½æ°ï¼å¨<code>app.py</code>ä¸­ä½¿ç¨<code>import python_tools </code>å¼ç¨è¯¥ååä½¿ç¨<code>python_tools.get_file()</code>è°ç¨å½æ°ã</li>
</ul>
<p>Python åç»ç»ç»æ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">packages</span><br><span class="line">	sub_package1</span><br><span class="line">		__init.py__</span><br><span class="line">		module1.py</span><br><span class="line">		...</span><br><span class="line">	sub_package2</span><br><span class="line">		__init.py__</span><br><span class="line">		module1.py</span><br><span class="line">		...</span><br></pre></td></tr></table></figure>

<p>ä½¿ç¨<code>from packages.sub_package1 import module1</code>æè<code>import packages.sub_package1.module1</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/Python%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/" data-id="ckmn1lhzj0003n8a89rhp4b98" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-tofino-command" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/tofino-command/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.917Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>8.9.1_SDE_Release_Notes.pdf Page9</p>
<p><img src="tofino-mirror/1563588664596.png" alt="1563588664596"></p>
<p><img src="tofino-mirror/1563588690029.png" alt="1563588690029"></p>
<p>P416 Tofino and Tofino2 Native Architecture.pdf page41</p>
<p><img src="tofino-mirror/1563588826648.png" alt="1563588826648"></p>
<p><img src="tofino-mirror/1563588845103.png" alt="1563588845103"></p>
<p><img src="tofino-mirror/1563588860409.png" alt="1563588860409"></p>
<p><img src="tofino-mirror/1563588924547.png" alt="1563588924547"></p>
<p><img src="tofino-mirror/1563588938814.png" alt="1563588938814"></p>
<p><img src="tofino-mirror/1563588961934.png" alt="1563588961934"></p>
<p><img src="tofino-mirror/1563597589848.png" alt="1563597589848"></p>
<p><img src="tofino-mirror/1563597604375.png" alt="1563597604375"></p>
<p><img src="tofino-mirror/1563597621504.png" alt="1563597621504"></p>
<p><img src="tofino-mirror/1563597642136.png" alt="1563597642136"></p>
<p><img src="tofino-mirror/1563597655844.png" alt="1563597655844"></p>
<p><img src="tofino-mirror/1563597688107.png" alt="1563597688107"></p>
<p><img src="tofino-mirror/1563597697403.png" alt="1563597697403"></p>
<p>COMMAND</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">SDE/pkgsrc/p4-build/configure --prefix=<span class="variable">$SDE_INSTALL</span> enable_thrift=yes --with-tofino --with-p4c --with-bf-runtime P4_VERSION=p4-16 P4_ARCHITECTURE=tna P4_NAME=int_tna P4_PATH=<span class="variable">$SDE</span>/int-tna/int-tna.p4 P4JOBS=7</span></span><br><span class="line"></span><br><span class="line">make;make install;$SDE/run_switchd.sh -p int_tna</span><br><span class="line"></span><br><span class="line">bfrt_python</span><br><span class="line">bfrt.int_tna.SwitchIngress.tbl_forward.add_with_forward(src_addr=&quot;10.0.0.1&quot;,dst_addr=&quot;10.0.0.2&quot;,resubmit_flag=0,port=129,flag=1)</span><br><span class="line"></span><br><span class="line">bfrt.int_tna.SwitchIngress.tbl_forward.add_with_submit_a(src_addr=&quot;10.0.0.1&quot;,dst_addr=&quot;10.0.0.2&quot;,resubmit_flag=1,port=128)</span><br><span class="line"></span><br><span class="line">bfrt.int_tna.SwitchIngress.int_action.add_with_source_set(int_flag=1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ucli</span><br><span class="line">pm port-add 1/- 10G NONE</span><br><span class="line">pm port-enb 1/-</span><br><span class="line">pm show</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Tofino</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">éç½®</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/pkgsrc/p4-build/configure --prefix=<span class="variable">$SDE_INSTALL</span> enable_thrift=yes --with-tofino --with-p4c --with-bf-runtime P4_VERSION=p4-16 P4_ARCHITECTURE=tna P4_NAME=int_tna P4_PATH=/root/int-tna/int-tna.p4 P4JOBS=7</span></span><br><span class="line">ç¼è¯ä¸å®è£</span><br><span class="line">make</span><br><span class="line">make installÂ·</span><br><span class="line">è¿è¡</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/run_switchd.sh -p int_tna</span></span><br><span class="line">ä¸åæµè¡¨</span><br><span class="line">bfrt_python</span><br><span class="line">bfrt.int_tna.SwitchIngress.tbl_forward.add_with_forward(src_addr=&quot;10.0.0.1&quot;,dst_addr=&quot;10.0.0.2&quot;,protocol=6,port=129,flag=1)</span><br><span class="line">bfrt.int_tna.SwitchIngress.tbl_forward.add_with_submit_a(src_addr=&quot;10.0.0.1&quot;,dst_addr=&quot;10.0.0.2&quot;,protocol=17,port=129,flag=1)</span><br><span class="line">bfrt.int_tna.SwitchIngress.source_init.add_with_source_set(int_flag=1)</span><br><span class="line">å¯ç¨ç«¯å£</span><br><span class="line">ucli</span><br><span class="line">pm port-add 1/- 10G NONE</span><br><span class="line">pm port-enb 1/-</span><br><span class="line">pm show</span><br><span class="line">åå</span><br><span class="line">sudo python3 send.py ens38 10.0.0.2 &quot;test&quot; 10 0.1</span><br><span class="line">æ¶å</span><br><span class="line">sudo python receive.py</span><br></pre></td></tr></table></figure>

<p>Tofino-Model</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">éç½®</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/pkgsrc/p4-build/configure --prefix=<span class="variable">$SDE_INSTALL</span> enable_thrift=yes --with-tofino --with-p4c --with-bf-runtime P4_VERSION=p4-16 P4_ARCHITECTURE=tna P4_NAME=int_tna P4_PATH=/home/xbo-p4/P4/int/int.p4 P4JOBS=7</span></span><br><span class="line">ç¼è¯ä¸å®è£</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">å¯å¨ç«¯å£</span><br><span class="line">sudo ~/P4/p4train/tools/veth_setup.sh</span><br><span class="line">å¯å¨Tofino-model</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/run_tofino_model.sh -p int_tna</span></span><br><span class="line">å¯å¨bfshell</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/run_switchd.sh -p int_tna</span></span><br><span class="line">ä¸åæµè¡¨</span><br><span class="line">bfrt.int_tna.SwitchIngress.tbl_forward.add_with_forward(dst_addr=0x0A000002,src_addr=0x0A000001,protocol=6,flag=1,port=1)</span><br><span class="line">bfrt.int_tna.SwitchIngress.tbl_forward.add_with_forward(dst_addr=0x0A000002,src_addr=0x0A000001,protocol=17,flag=1,port=1)</span><br><span class="line">bfrt.int_tna.SwitchIngress.source_init.add_with_source_set(int_flag=1)</span><br><span class="line">å¯å¨æ¥æ¶èæ¬</span><br><span class="line">sudo python ~/Desktop/INT/receive-eth.py </span><br><span class="line">å¯å¨åéèæ¬</span><br><span class="line">sudo python ~/Desktop/INT/send-eth.py 10.0.0.2 &quot;test&quot; 1 0.1 veth1</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/tofino-command/" data-id="ckmn1lhzn000an8a8bemdbgs5" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-å®è£mininetåtofino-model" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/%E5%AE%89%E8%A3%85mininet%E5%92%8Ctofino-model/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.907Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ubuntu 16.04 å®è£BMv2</span></span><br><span class="line">sudo reboot now</span><br><span class="line">mkdir mininet-install</span><br><span class="line">sudo apt install openssh-server</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ´æ¹apt source.list</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br><span class="line">cd mininet-install/tutorials/vm/</span><br><span class="line">chmod u+x root-bootstrap.sh </span><br><span class="line">chmod u+x user-bootstrap.sh </span><br><span class="line">sudo ./root-bootstrap.sh # æ³¨æwindowsä¸æ¢è¡ç¬¦æ¯CRLF,UNIXä¸æ¯LFï¼apt install ä¸­ä¸è½ç¨#å±è½ä¸è½å®è£çè½¯ä»¶åï¼éè¦ç´æ¥å é¤ã</span><br><span class="line">mkdir ~/.pip/</span><br><span class="line">cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span><br><span class="line">[global]</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">EOF</span><br><span class="line"><span class="meta">#</span><span class="bash">git proxy</span> </span><br><span class="line">git config --global http.proxy &#x27;socks5://192.168.2.7:1080&#x27;</span><br><span class="line">git config --global https.proxy &#x27;socks5://192.168.2.7:1080&#x27;</span><br><span class="line">./user-bootstrap.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ubuntu 16.04 å®è£bf-sde-8.9.1</span></span><br><span class="line">tar xvf bf-sde-8.9.1.tar</span><br><span class="line">cd bf-sde-8.9.1/p4studio_build</span><br><span class="line">python p4studio_build.py --use-profile p416_examples_profile -rb</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ³¨æï¼ä¿ægitå¤äºè¢«ä»£çç¶æã</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> grpcå¯è½æ æ³git <span class="built_in">clone</span>ï¼åå æªç¥ï¼ï¼è§£å³åæ³æ¯ï¼</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°å®è£BMv2æ¶çgrpcï¼/home/xbo/mininet-install/tutorials/vm/grpcï¼å¤å¶è³/home/xbo/bfsde-install/bf-sde-8.9.1/p4studio_build/third_party/grpc_protobuf/grpcï¼å±è½/home/xbo/bfsde-install/bf-sde-8.9.1/p4studio_build/third_party/install_grpc.pyä¸­çline125-128ï¼å³ï¼</span></span><br><span class="line"><span class="meta">	#</span><span class="bash">status = utils.exec_cmd(cmd, log_file)</span></span><br><span class="line">    #if status[2] != 0:</span><br><span class="line">    #    return (False, &#x27;Failed to extract GRPC, command - &#x27; + \</span><br><span class="line">    #                   &#x27;%s, error - %s&#x27; % (cmd, status[1]))</span><br><span class="line"><span class="meta">#</span><span class="bash"> éæ°å®è£æ¶å¯ä»¥ ä½¿ç¨-rbåæ°ï¼ä»ä¸æ¬¡ç¼è¯å¤±è´¥çå°æ¹éæ°ç¼è¯ã</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¨/etc/profile ä¸­æ·»å å¦ä¸åé</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">export</span> SDE=/home/xbo/bfsde-install/bf-sde-8.9.1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">export</span> SDE_INSTALL=<span class="variable">$SDE</span>/install</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SDE_INSTALL</span>/bin</span></span><br><span class="line"></span><br><span class="line">éç½®</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/pkgsrc/p4-build/configure --prefix=<span class="variable">$SDE_INSTALL</span> enable_thrift=yes --with-tofino --with-p4c --with-bf-runtime P4_VERSION=p4-16 P4_ARCHITECTURE=tna P4_NAME=int_tna P4_PATH=/home/xbo/bf-sde-8.9.1-install/int-tna/int-tna.p4 P4JOBS=7</span></span><br><span class="line">ç¼è¯ä¸å®è£</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">å¯å¨ç«¯å£</span><br><span class="line">sudo ~/P4/p4train/tools/veth_setup.sh</span><br><span class="line">å¯å¨Tofino-model</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/run_tofino_model.sh -p int_tna</span></span><br><span class="line">å¯å¨bfshell</span><br><span class="line"><span class="meta">$</span><span class="bash">SDE/run_switchd.sh -p int_tna</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/%E5%AE%89%E8%A3%85mininet%E5%92%8Ctofino-model/" data-id="ckmn1lhzo000bn8a80he25ya1" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-TNA model" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/TNA%20model/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.893Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Tofino-Architecture-Model"><a href="#Tofino-Architecture-Model" class="headerlink" title="Tofino Architecture Model"></a>Tofino Architecture Model</h2><p>å½åTNAæ¨¡åæ¥æå­ä¸ªå¯ç¼ç¨æ¨¡ååä¸ä¸ªåºå®åè½æ¨¡å( Phase-0 and Intrinsic Metadata (PIM) engine, the Packet buffer and Replication Engine (PRE) and the Buffer Queuing Engine (BQE) )ã</p>
<p><img src="C:\Users\xbo\AppData\Roaming\Typora\typora-user-images\1568098562988.png" alt="1568098562988"></p>
<p>äº¤æ¢æºå°æ¥æ¶å°çæ°æ®åç¼å­å¨è¾å¥ç¼å­å¨ä¸­ï¼æªå¨å¾ä¸­ç»åºï¼ï¼PIMå¼æå±äºè¾å¥ç¼å­å¨çä¸é¨åï¼ç¨äºå¨æ¥æ¶å°çæ°æ®åå¼å§å¤æ·»å é¢å¤çåæ°æ®ï¼metadataï¼ï¼åæ¬intrinsic metadata and phase-0 or resubmit metadataï¼ intrinsic metadataçç»æåå¤§å°æ¯åºå®çï¼ç»æå®ä¹ä¸ºç»æä½ingress_intrinsic_metadata_tï¼å¤§å°ä¸º8 bytesï¼Phase-0 and resubmit metadataçç»æåå¤§å°åå³äºåºç¨ç¨åºï¼ç¨åºå¯ä»¥ä½¿ç¨8 bytesææ´å°ï¼æ²¡ç¨ä½¿ç¨çæ°æ®å°è¢«0å¡«åã</p>
<p>TNAä¸­æ°æ®åçå¤çæµç¨çç¬¬ä¸æ­¥æ¯ingresså¤çï¼è¿å¥äº¤æ¢æºçæ°æ®åé¦åè¢«parseråè§£æï¼ç¶åè¢«ingress controlåå¤çãä»parserè§åº¦æ¥çï¼äº¤æ¢æºæ¥æ¶çåå§æ°æ®åç»è¿PIMå¼æåä¼æ·»å  intrinsic and phase-0 metadataï¼å æ­¤parserå¿é¡»å¨è§£æçå®æ°æ®åä¹åè§£ææèè·³è¿PIMæ·»å çPORT_METADATA bytes (16 bytes for TNA, 24 bytes for T2NA)å¤§å°çåæ°æ®ã</p>
<p>å¨Tofinoä¸­ï¼ingress controlåå¯ä»¥æ§è¡ä¸ç³»åçå¹éåå¨ä½æä½ï¼Match-Actionï¼MAï¼ï¼æ¯ä¸ªMAæä½ç±ä¸ä¸ªè¡¨æ¥æ¾åæ ¹æ®æ¥æ¾ç»æä¿®æ¹æ°æ®ååå¤´ï¼headerï¼æåæ°æ®æä½ç»æãå¨P4-16ä¸­å¨ä½å¯ä»¥å¨ææèæ²¡æä»»ä½è¡¨æ¥æ¾çæåµä¸æ§è¡ã<strong>è½å¤å¹éåä¿®æ¹ä»»ææ°æ®ååå¤´ååæ°æ®æ¯P4å¯ç¼ç¨æ§çå³é®</strong> ã</p>
<p>å¨ingress controlåä¹åï¼æ°æ®åå¨deparser controlåä¸­è¢«éæ°ç»è£ï¼ç¶ååéè³PREä¸­ãPREæ§è¡å¤ç§åºå®åè½åç»äº¤æ¢åè½ï¼ä¾å¦ï¼PREå¯ä»¥å°åæ­åå®åå°æä¸ªç»å®çç«¯å£å¹¶ç¼å­ç­å¾egresså¤çãPREä¹å¯ä»¥ä¸¢å¼æ°æ®åï¼æèæ¯åå»ºä¸ä¸ªé¢å¤çåå¯æ¬å®ç°åéåè½ï¼åå»ºå¤ä¸ªåå¯æ¬å®ç°å¤æ­ã</p>
<p>å¨PREä¹åï¼æ°æ®ååå¤å¶åçå¯æ¬è¿å¥å¯éçegresså¤çé¶æ®µï¼egress pipelineï¼ãéè¿å¨ingresså¤çé¶æ®µä¸­è®¾ç½®intrinsic metadataä¸­çbypass_egressæ å¿ä½ï¼å¯ä»¥è·³è¿egresså¤çï¼ä½æ¯éåæå¤æ­äº§ççæ°æ®åå¯æ¬ä¸è½è·³è¿egresså¤çãå¨egresså¤çé¶æ®µï¼åå§æ°æ®ååéåäº§ççæ°æ®åå¯æ¬å¯ä»¥è¢«è¿ä¸æ­¥ä¿®æ¹ãdeparserä»¥ç¨åºä¸­æå®çé¡ºåºæäº¤ï¼emitï¼éè¦çåå¤´æ¥æé æ°æ®åå­èæµã</p>
<p>TNAä¸­å¯ç¼ç¨åçå®ä¹æ¯æ ¹æ®ä¸ç»ç¨æ·å®ä¹çåæ°è¿è¡æ¨¡æ¿åçï¼è¿äºåæ°å¿é¡»ç±ç¨æ·å¨controlåå®ä¾åæ¶æä¾ãingress pipelineåegress pipelineçç±»ååæ°ä¸åï¼å æ­¤ä¸P4-14ä¸åï¼å¨ingress pipelineåegress pipelineä¸­é½æ²¡æå¨å±åæ°æ®ãææå¯¹ingress pipelineä¸­åå¤´çä¿®æ¹å¿é¡»ç±ingress deparseråå¹¶ï¼å¹¶ç±egress parserè§£æãä»»ä½å¯¹ingress metadataçä½¿ç¨é½å¿é¡»éè¿å¨åä¸­åå»ºé¢å¤çæ¡¥æ¥åæ°æ®å¤´æ¥æå¨ä¼ é(æ¡¥æ¥)å°egress pipelineãéè¦æ³¨æçæ¯ï¼å³ä½¿ç¨æ·å¯ä»¥ä¸ºingress controlååegress controlåå®ä¹ä¸ä¸ªåæ°æ®ç±»åï¼ä¹ä¸æå³çè¿ä¸ªåæ°æ®å¯ä»¥å¨ingress controlååegress controlåä¹é´å±äº«ã</p>
<p>å¨é¡¶å±ï¼æ¯ä¸ªå¯ç¼ç¨åå®ä¾ä½ä¸ºåæ°ä¼ éç»ä¸»ååï¼ main package blockï¼ï¼ä»¥å®ä¾åé¡¶å±åï¼ top-level packageï¼ãç¼è¯å¨åè®¾å­å¨ä¸ä¸ªåä¸ºmainçé¡¶çº§å®ä¾ãå¦ææ²¡æå¨P4ç¨åºçå®ä¹âmainâå®ä¾ä¼äº§çç¼è¯éè¯¯ã</p>
<h2 id="å½åè§æ ¼"><a href="#å½åè§æ ¼" class="headerlink" title="å½åè§æ ¼"></a>å½åè§æ ¼</h2><p>å¨æ¬ææ¡£ä¸­ï¼æä»¬ä½¿ç¨ä»¥ä¸å½åçº¦å®:</p>
<ol>
<li>ç±»åä½¿ç¨CamelCaseå½åæ³åï¼å¹¶åè·_tãä¾å¦ï¼PortId_tã</li>
<li>Controlç±»ååå¤é¨å¯¹è±¡ç±»åä½¿ç¨CamelCaseå½åæ³åã</li>
<li>ç»æç±»åçåç§°ä½¿ç¨å°ååè¯ï¼å¹¶ç¨_åéï¼åè·_tã</li>
<li>Actionsãå¤é¨æ¹æ³ãå¤é¨å½æ°ãåå¤´ãç»æä½åControlçå®ä¾çåç§°ä»¥å°åå­æ¯å¼å§ï¼å¹¶ç¨_è¿è¡åå²ã</li>
<li>EnumæåãConstå®ä¹å#defineå¸¸éçåç§°å¨é¨ä½¿ç¨å¤§åå­æ¯ï¼åè¯ä¹é´ç¨_åéã</li>
</ol>
<h1 id="æ°æ®ç±»å"><a href="#æ°æ®ç±»å" class="headerlink" title="æ°æ®ç±»å"></a>æ°æ®ç±»å</h1><h2 id="ç±»åå®ä¹"><a href="#ç±»åå®ä¹" class="headerlink" title="ç±»åå®ä¹"></a>ç±»åå®ä¹</h2><p>TNAä½¿ç¨åºå®çãç¹å®äºä½ç³»æ¶æçä½å®½å®ä¹ä»¥ä¸ç±»åï¼è¿äºä½å®½å®ä¹å¨æ¶ææä»¶ä¸­ï¼å¨P4ç¨åºä¸­å»ºè®®ä½¿ç¨è¿äºç±»åæ¥å®ä¹åéï¼èä¸æ¯ä½¿ç¨ç¡¬ç¼ç çä½å®½å¼ã</p>
<p>typedef bit&lt;9&gt; PortId_t; // Port id â ingress or egress<br>typedef bit&lt;16&gt; MulticastGroupId_t; // Multicast group id<br>typedef bit&lt;5&gt; QueueId_t; // Queue id<br>typedef bit&lt;10&gt; MirrorId_t; // Mirror id<br>typedef bit&lt;16&gt; ReplicationId_t; // Replication id</p>
<h2 id="åæ°æ®ç±»å"><a href="#åæ°æ®ç±»å" class="headerlink" title="åæ°æ®ç±»å"></a>åæ°æ®ç±»å</h2><p>TNAä¸­æä¸¤ç§åæ°æ®ç±»å: åé¨åæ°æ®ï¼intrinsic metadataï¼åç¨æ·å®ä¹çåæ°æ®ãåé¨åæ°æ®æ¯åºäºç¡¬ä»¶å®ç°å®ä¹çï¼ç¨æ·å®ä¹çåæ°æ®æ¯åºäºP4åºç¨ç¨åºå®ä¹çãå¨TNAä¸­ï¼æ ¹æ®åæ°æ®çæ¥æºåç®æ ï¼å°åé¨åæ°æ®åä¸ºè¥å¹²ç»ãä¾å¦ï¼æ¥èªingress parserçåæ°æ®å½åä¸ºingress_intrinsic_metadata_from_parser_tãç±»ä¼¼å°ï¼ç®æ ä¸ºæµéç®¡çå¨(PREçä¸é¨å)çåæ°æ®å½åä¸ºingress_intrinsic_metadata_for_tm_tã</p>
<p>ingress parseræegress parseræ¥æ¶çæ°æ®åçåç¼æ¯æ¥èªè¾å¥ç¼å²åºçåé¨åæ°æ®ï¼ingress intrinsic metadata, phase-0 and resubmit metadataãPhase-0 åresubmit metadataæ¯äºæ¥çï¼å ä¸ºååªè½æ¯æ­£å¸¸æäº¤æéæ°æäº¤ï¼ä¸è½åæ¶æ¯ä¸¤èã</p>
<p>header ingress_intrinsic_metadata_t {<br>bit&lt;1&gt; resubmit_flag; // Flag distinguishing original  packets from resubmitted packets.<br>bit&lt;1&gt; _pad1;<br>bit&lt;2&gt; packet_version; // Read-only Packet version.<br>bit&lt;3&gt; _pad2;<br>PortId_t ingress_port; // Ingress physical port id.<br>bit&lt;48&gt; ingress_mac_tstamp; // Ingress IEEE 1588 timestamp (in ns)  </p>
<p>}</p>
<p>æ¥èªè¾å¥ç¼å²åºçingress_intrinsic_metadata_tåå«ä¸ä¸ª1ä½å­æ®µæ¥åºåæ­£å¸¸åéæ°æäº¤çæ°æ®åï¼ä¸ä¸ª9ä½å­æ®µç¨äºè¡¨ç¤ºingressç«¯å£ï¼ä¸ä¸ª48ä½å­æ®µç¨äºè¡¨ç¤ºingress MACæ¶é´æ³ãTNAç¨åºåºè¯¥å§ç»æå ingress intrinsic metadataãå¦ææåçåé¨åæ°æ®æ²¡æå¨ingress controlåä¸­ä½¿ç¨ï¼åæåä¸ä¼äº§çä»»ä½ç¡¬ä»¶ææ¬ãç±»ä¼¼å°ï¼TNAç¨åºåºè¯¥å§ç»æåphase-0 æè resubmit metadataãingress_intrinsic_metadata_tå¨ingress parserä¸­ç¼åï¼å¨ingress controlä¸­è¯»åã</p>
<p>struct ingress_intrinsic_metadata_from_parser_t {<br>bit&lt;48&gt; global_tstamp; // Global timestamp (ns) taken upon arrival at ingress.<br>bit&lt;32&gt; global_ver; // Global version number taken upon arrival at ingress, wired to 0.<br>bit&lt;16&gt; parser_err; // Error flags indicating error(s)  encountered at ingress parser.<br>}</p>
<p>ingress_intrinsic_metadata_from_parser_tç»æä¸­æ¶é´æ³å¯¹äºingress controlåæ¯åªè¯»çãè¯¥ç»æåå«ä¸¤ä¸ªåæ°æ®å­æ®µ:global_timestampå­æ®µï¼è¡¨ç¤ºæ°æ®åè¿å¥ingress controlåæ¶çæ¶é´æ³ï¼parser_errorå­æ®µï¼è¡¨ç¤ºåçå¨parserä¸­çä»»ä½éè¯¯ä»£ç ã</p>
<p>PREç±å¨ingress controlåä¸­è®¾ç½®çï¼åä¸ºingress_intrinsic_metadata_for_tm_tçåé¨åæ°æ®æ§å¶ï¼</p>
<p>struct ingress_intrinsic_metadata_for_tm_t {<br>PortId_t ucast_egress_port; // Egress port for unicast packets. must be presented to TM for unicast.<br>bool bypass_egress; // Request flag for the warp mode (egress bypass).<br>bool deflect_on_drop; // Request for deflect on drop. must be presented to TM to enable deflection upon drop.<br>bit&lt;3&gt; ingress_cos; // Ingress cos (iCoS) for PG mapping, ingress admission control, PFC, etc.<br>QueueId_t qid; // Egress (logical) queue id into which this packet will be deposited.<br>bit&lt;3&gt; icos_for_copy_to_cpu; // Ingress cos for the copy to CPU. must be presented to TM if copy_to_cpu == 1.<br>bool copy_to_cpu; // Request for copy to cpu.<br>bit&lt;2&gt; packet_color; // Packet color (G,Y,R) that is typically derived from meters and used for color-based tail dropping.<br>bool disable_ucast_cutthru;  // Disable cut-through forwarding for unicast.<br>bool enable_mcast_cutthru; // Enable cut-through forwarding for multicast.<br>MulticastGroupId_t mcast_grp_a;// 1st multicast group (i.e., tree) id; a tree can have two levels. must be presented to TM for multicast.<br>MulticastGroupId_t mcast_grp_b;// 2nd multicast group (i.e., tree) id; a tree can have two levels.<br>bit&lt;13&gt; level1_mcast_hash; // Source of entropy for multicast replication-tree level1 (i.e., L3 replication). must be presented to TM for L3 dynamic member selection (e.g., ECMP) for multicast.<br>bit&lt;13&gt; level2_mcast_hash; // Source of entropy for multicast replication-tree level2 (i.e., L2 replication). must be presented to TM for L2 dynamic member selection (e.g., LAG) for nested multicast.<br>bit&lt;16&gt; level1_exclusion_id;  // Exclusion id for multicast replication-tree level1. used for pruning.<br>bit&lt;9&gt; level2_exclusion_id; // Exclusion id for multicast replication-tree level2. used for pruning.<br>ReplicationId_t rid; // L3 replication id for multicast.<br>}</p>
<p>å¨egresså¤çä¹åï¼æ°æ®åç±PREå¤çãä¸è¾å¥ç¼å­å¨å¨è¾å¥æ°æ®ååæ·»å åæ°æ®ç±»ä¼¼ï¼PREå¨æ°æ®ååºPREæ¶æ·»å é¢å¤çåæ°æ®egress_intrinsic_metadata_t ï¼è¯¥åæ°æ®å¨egress parserä¸­è¢«æåï¼å¹¶å¨egress controlåä¸­ä½¿ç¨ã</p>
<p>header egress_intrinsic_metadata_t {<br>bit&lt;7&gt; _pad0;<br>PortId_t egress_port; // Egress port id<br>bit&lt;5&gt; _pad1;<br>bit&lt;19&gt; enq_qdepth; // Queue depth at the packet enqueue time.<br>bit&lt;6&gt; _pad2;<br>bit&lt;2&gt; enq_congest_state; // Queue congestion state at the packet// enqueue time.<br>bit&lt;14&gt; _pad3;<br>bit&lt;18&gt; enq_tstamp; // Time when the packet is enqueued (in nsec).<br>bit&lt;5&gt; _pad4;<br>bit&lt;19&gt; deq_qdepth; â// Queue depth at the packet dequeue time.<br>bit&lt;6&gt; _pad5;<br>bit&lt;2&gt; deq_congest_state; â// Queue congestion state at the packet<br>â// dequeue time.<br>bit&lt;8&gt; app_pool_congest_state; â// Dequeue-time application-pool<br>â// congestion state. 2 bits per pool.<br>bit&lt;14&gt; _pad6;<br>bit&lt;18&gt; deq_timedelta; â// Time delta between the packetâs<br>â// enqueue and dequeue time.<br>ReplicationId_t egress_rid; â// Replication id for multicast packets.Â <br>bit&lt;7&gt; _pad7;<br>bit&lt;1&gt; egress_rid_first; â// Flag indicating the first replica for<br>// the given multicast group.<br>bit&lt;3&gt; _pad8;Â <br>QueueId_t egress_qid; â// Egress (physical) queue id via<br>// which this packet was served.<br>bit&lt;5&gt; _pad9;<br>bit&lt;3&gt; egress_cos; â// Egress cos (eCoS) value.<br>bit&lt;7&gt; _pad10;<br>bit&lt;1&gt; deflection_flag; â// Flag indicating whether a packet is<br>// deflected due to deflect_on_drop.<br>bit&lt;2&gt; _pad11;<br>bit&lt;14&gt; pkt_length; â// Packet length, in bytes<br>}</p>
<p>ææegress intrinsic metadataé½æ¯åªè¯»å­æ®µãä¸è½å¨egressä¸­è¿è¡ä¿®æ¹ã</p>
<h3 id="Unicast"><a href="#Unicast" class="headerlink" title="Unicast"></a>Unicast</h3><p>egress_portå­æ®µæå®åçè¾åºç«¯å£ãç±äºè¯¥å­æ®µæ¯åªè¯»çï¼å æ­¤egressä¸è½éè¿ä¿®æ¹è¯¥å­æ®µå°åéå®åå°å¦ä¸ä¸ªç«¯å£ãç±äºdeparserä½¿ç¨è¯¥å­æ®µï¼å æ­¤è¯¥å­æ®µå¿é¡»ç±egress parseræåï¼æ æ³æåè¯¥å­æ®µå°å¯¼è´æ°æ®åä¸¢å¤±ã</p>
<h3 id="Buffer-Queueing"><a href="#Buffer-Queueing" class="headerlink" title="Buffer Queueing"></a>Buffer Queueing</h3><p>å¨Tofinoä¸­ï¼æ¯ä¸ªåºç«¯å£æå¤å¯ä»¥æ8ä¸ªFIFOéåï¼ä¸ä¸ªæ°æ®åå¯ä»¥å å¥8ä¸ªFIFOéåä¹ä¸ãæ­¤å¤ï¼Tofino PRE bufferè¢«ååä¸ºæå¤4ä¸ªåºç¨ç¨åºæ± ï¼è¿ä¸ºä¸åçåºç¨ç¨åºæµéæä¾äºéç¦»ãéåå¯ä»¥å±äºä¸åªè½å±äºä¸ä¸ªåºç¨ç¨åºæ± ãenq_qdepthãenq_congest_stateãenq_tstampãdeq_qdepthãdeq_congest_stateådeq_timedeltaå­æ®µæä¾å³äºåå½åæå¨éåçä¿¡æ¯ãææéåæ·±åº¦è®¡æ°å¨çåä½é½æ¯80å­èãæ¥å¡ç¶ææ¥èªéåæ·±åº¦ä¸éåé¢è²éå¶(ç±é©±å¨ç¨åºè®¾ç½®)çæ¯è¾ãç¼ç å¦ä¸</p>
<p>![1568107064901](E:\Desktop\ç¬è®°\TNA model\1568107064901.png)</p>
<p>enq_tstampæè·åè¿å¥éåæ¶çæ¶é´æ³ï¼ä»¥çº³ç§ä¸ºåä½ãdeq_timedeltaæè·åå¨PREä¸­è¿å¥éåä¸ç¦»å¼éåä¹é´çæ¶é´å·®ï¼ä»¥çº³ç§ä¸ºåä½ã</p>
<h3 id="Packet-Replication"><a href="#Packet-Replication" class="headerlink" title="Packet Replication"></a>Packet Replication</h3><p>æ°æ®åå¯è½éè¦å¤å¶å°ç¸åçç©çåºç«¯å£ãä¾å¦ï¼å½å¤ä¸ªå¤æ­ç»å±äº«åä¸ä¸ªç©çç«¯å£æ¶ï¼å°±ä¼åçè¿ç§æåµãReplication ID (RID)ä¸åçæ¯ä¸ªå¯æ¬ç¸å³èï¼ä»¥ä¾¿äº¤æ¢æºè½å¤åºåå¤æ­åçä¸åå®ä¾ãä¸ä¸ª{RID, egress port}çåç»æä¸å°æ è¯æ¯ä¸ªå¤æ­å®ä¾ã</p>
<h3 id="Output-Queue"><a href="#Output-Queue" class="headerlink" title="Output Queue"></a>Output Queue</h3><p>Tofino MACæ¯æé«è¾¾100 Gbpsçæ°æ®éçåå¤è¾¾32ä¸ªç¡¬ä»¶éåãæ¯ä¸ªMACå¯ä»¥è¿ä¸æ­¥ååä¸º4ä¸ªééï¼æ¯ä¸ªééè¿è¡éåº¦ä¸º25 Gbpsã32ä¸ªç¡¬ä»¶éåå¯ä»¥éç½®å¹¶åéç»4ä¸ªééä¸­çä»»ä½ä¸ä¸ªãåéä¸å¿æ¯ç»ä¸çãä¾å¦ï¼å°4ä¸ªéååéç»ä¸ä¸ªééï¼å°12ä¸ªéååéç»å¦ä¸ä¸ªééé½æ¯ææçã5ä½çegress_qidè¡¨ç¤ºæ°æ®åæä½¿ç¨ç32ä¸ªç¡¬ä»¶éåä¸­çåªä¸ä¸ªãæ¯ä¸ªç¡¬ä»¶éåé½å¯ä»¥éç½®ä¸ä¸ª3ä½æå¡ç­çº§(Class Of Service, COS)å¼ãä¼åæµæ§å¶(Priority Flow Control, PFC)ä½¿ç¨COSå®ç°æ¥èªä¸æ¸¸ç«¯å£çåååï¼ä»¥éå¶ä¸æ¸¸ç«¯å£ä¸­æäºç±»çæµéãæ¯ä¸ªç¡¬ä»¶éåå±äº8ä¸ªæå¡ç±»ä¸­çä¸ä¸ªãæ¯ä¸ªç¡¬ä»¶éåçCOSéç½®ç±é©±å¨ç¨åºæ§è¡ãPREç»åºegress COSå¼ï¼egress controlåå¯ä»¥ä½¿ç¨è¯¥å¼å¤æ­æ°æ®åå±äºåªä¸ç±»æå¡ã</p>
<h3 id="Packet-Length"><a href="#Packet-Length" class="headerlink" title="Packet Length"></a>Packet Length</h3><p>è¯¥å­æ®µçæä¹åå³äºåçç±»åãå¯¹äºä»ingresså°egressçæ®éæ°æ®åï¼æ°æ®åé¿åº¦æ¯å¨ingresså¤çåçä¼ å¥æ°æ®åçé¿åº¦ãå¯¹äºä»ingresséåå°egressçæ°æ®åï¼åé¿åº¦æ¯ingresså¤çåçåé¿åº¦+éå éåå¤´çå¤§å°+ CRCç4å­èãå¯¹äºä»egresséåå°egressçæ°æ®åï¼åé¿åº¦ä¸ºç»è¿egress pipelineä¿®æ¹åçåçé¿åº¦+é¢å¤éåå¤´çå¤§å°+ CRCç4å­èãé¿åº¦ä»¥å­èè®¡ç®ã</p>
<h3 id="Match-types"><a href="#Match-types" class="headerlink" title="Match types"></a>Match types</h3><p>TNAå¨æ åP4 16 match_kindç±»åçåºç¡ä¸æ¯æå¦å¤ä¸¤ä¸ªmatch_kindç±»åã</p>
<p>match_kind {<br>range, // Used to represent min..max intervals<br>selector // Used for implementing ActionSelection<br>}</p>
<p>å¨TNAä¸­ï¼è¡¨é®å¯ä»¥å¹éèå´(start, end)åçå¼ï¼åæ¬å¼å§å¼ï¼ä¸åæ¬ç»æå¼ï¼è¿æå³çstartãstart + 1ãend - 1ä¹é´çä»»ä½å¼é½å°å¯ä»¥å¹éãæ¯ä¸ªèå´å¹éæ¡ç®ä½¿ç¨å¤ä¸ªTCAMæ¡ç®ãé»è®¤æåµä¸ï¼ç¼è¯å¨åè®¾è¡¨ä¸­25%çæ¡ç®æ¯èå´æ¡ç®ãå æ­¤ï¼èå´å¹éç±»åçè¡¨ææ¶èçTCAMæ¡ç®çæ»æ°ç­äº</p>
<p>75% Ã table size + 25% Ã table size Ã number of TCAM entries per range entry</p>
<p>æ¯ä¸ªèå´æ¡ç®æå¤ä½¿ç¨8ä¸ªTCAMæ¡ç®ï¼å¹¶ä¸ç¹å®äºå®éèå´å¼ãæäºèå´å¼å¯è½éè¦è¾å°çTCAMæ¡ç®æ¥å®ç°ã</p>
<p>å¯ä»¥ä½¿ç¨ç¼è¯æç¤ºentries_with_rangesè°æ´åä¸è¡¨ä¸­èå´æ¡ç®ä¸éèå´æ¡ç®çæ¯ä¾ãç¼è¯æç¤º(pragma)æå®è¡¨ä¸­èå´æ¡ç®çæ°éãå¦æç¼è¯æç¤ºæå®çå¼å¤§äºè¡¨çå¤§å°ï¼é£ä¹è¡¨ä¸­çæææ¡ç®é½åå®ä¸ºèå´æ¡ç®ã</p>
<p>éæ©å¨é®åªè½å¨éæ©å¨è¡¨ä¸­ä½¿ç¨ãéæ©å¨è¡¨æ¯ä¸ç§ç¹æ®ç±»åçè¡¨ï¼å¶å®ç°å±æ§éå ææä½éæ©å¨(è¯·åéâæä½éæ©å¨âè)ææä½æ¦è¦æä»¶(è¯·åéâæä½æ¦è¦æä»¶âè)ãéæ©å¨è¡¨ä¸­çé®å¯ä»¥æ¯éæ©å¨å¹éç±»ååå¸¸è§å¹éç±»å(ç²¾ç¡®ãä¸åãèå´ç­)çæ··åãå¨å¹éæä½ä¸­ä½¿ç¨å¸¸è§å¹éç±»åãéæ©å¨å¹éç±»åç¨äºéæ©æä½æ¦è¦æä»¶å/ææä½éæ©å¨ä¸­çå¤ä¸ªæä½ä¹ä¸ãå¦æä¸ä¸ªé®åæ¶ç¨ä½å¸¸è§å¹éç±»ååéæ©å¨å¹éç±»åï¼é£ä¹å®éè¦å¨è¡¨é®å±æ§ä¸­ä»¥ä¸åçå¹éç±»åååºä¸¤æ¬¡ã</p>
<h2 id="Parser"><a href="#Parser" class="headerlink" title="Parser"></a>Parser</h2><p>TNAæ¯æåç¬çå¥å£ï¼ingressï¼ååºå£ï¼egressï¼è§£æå¨ãå¥å£è§£æå¨æ¯å¥å£ç®¡éä¸­çç¬¬ä¸ä¸ªå¯ç¼ç¨åãå®ä»è¾å¥åç¼å²åºæ¥æ¶ä¸ä¸ªå­èæµï¼å¹¶å°å­èæµè§£æä¸ºç³»ç»å®ä¹çæç¨æ·å®ä¹çå¤´æä»¶ãå¨æ¬æä¸­ï¼ç³»ç»å®ä¹çå¤´ä¹ç§°ä¸ºåé¨åæ°æ®ãç¨æ·å®ä¹çå¤´æ¥èªP4ç¨åºãä¸é¢å£°æäºP4ä¸­å¥å£è§£æå¨çé¡¶çº§æ¥å£</p>
<p>parser IngressParser&lt;H, M&gt;(<br>packet_in pkt,<br>out H hdr,<br>out M ig_md,<br>out ingress_intrinsic_metadata_t ig_intr_md);</p>
<p>å½å¨P4ç¨åºä¸­å®ä¾åä¸ä¸ªingressè§£æå¨æ¶ï¼ç¨æ·å¿é¡»åHåMæä¾å·ä½çç±»åãä¾å¦ï¼ä¸é¢çç¤ºä¾å°Hç»å®å°headers_tï¼å¹¶å°Mç»å®å°metadata_tã</p>
<p>struct headers_t { â¦ }<br>struct metadata_t { â¦ }<br>parser myIngressParser&lt;headers_t, metadat_t&gt; (<br>packet_in pkt,<br>out headers_t hdr,<br>out metadata_t ig_md,<br>out ingress_intrinsic_metadata_t ig_intr_md) { â¦ }</p>
<p>æ³¨æï¼å¨æ¬ä¾ä¸­çç¥äºheaders_tãmetadata_tåmyIngressParserçä¸»ä½ï¼å ä¸ºå®ä»¬ä¸è®¨è®ºæ å³ãç¨æ·å¯ä»¥çç¥ç±»ååæ°&lt;headers_t, metadata_t&gt;ï¼ç¼è¯å¨å¯ä»¥ä»åæ°åè¡¨ä¸­çåæ°æ¨æ­è¿äºç±»ååæ°çå¼ãå æ­¤ï¼ä¸é¢çä»£ç ç¸å½äºä¸é¢çç¤ºä¾ã</p>
<p>struct headers_t { â¦ }<br>struct metadata_t { â¦ }<br>parser myIngressParser (<br>packet_in pkt,<br>out headers_t hdr,<br>out metadata_t ig_md,<br>out ingress_intrinsic_metadata_t ig_intr_md) { â¦ }</p>
<p>ingressè§£æå¨æ¥ååä¸ªåæ°ãç¬¬ä¸ä¸ªåæ°æ¯åä¸ºpktçpacket_inå¤é¨ç±»åçæ æ¹åå®ä¾ãä»æ¦å¿µä¸è®²ï¼pktå¯¹è±¡æä¾äºä»è¾å¥ç¼å²åºå¯¹åå§å­èæµçè®¿é®ãç¨æ·å¯ä»¥è°ç¨pktå¯¹è±¡ä¸çextractæadvanceæ¹æ³æ¥å°å­èæµè§£æä¸ºåé¨åæ°æ®æç¨æ·å®ä¹çå¤´æä»¶ãç¬¬äºä¸ªåæ°æ¯ç¨æ·å®ä¹ç»æç±»åï¼ç¨äºè¡¨ç¤ºæææåçå¤´ç±»åãç¬¬ä¸ä¸ªåæ°æ¯å¦ä¸ä¸ªç¨æ·å®ä¹çç»æç±»åï¼ç¨äºè¡¨ç¤ºè§£æå¨åå§åçææåæ°æ®ãç¬¬åä¸ªåæ°æ¯ç±TNAä½ç³»ç»æå®ä¹çingressè§£æå¨åé¨åæ°æ®ç±»åãæä»¬å°å¨ä¸é¢è¯¦ç»è§£éæ¯ç§ç»æç±»åã</p>
<h3 id="Ingress-Intrinsic-Metadata"><a href="#Ingress-Intrinsic-Metadata" class="headerlink" title="Ingress Intrinsic Metadata"></a>Ingress Intrinsic Metadata</h3><p>TNAå¨æ¯ä¸ªåçä¼ å¥å­èæµçå¼å§å¤éç¨ç¹å®çå¸å±ã</p>
<p>![1568174993199](E:\Desktop\ç¬è®°\TNA model\1568174993199.png)</p>
<p>å¦ä¸å¾æç¤ºï¼å­èæµå¸å±åå³äºä¼ å¥åçç±»åãTNAæ²¡æåè®¾å¦ä½è§£æå­èæµï¼å æ­¤ï¼P4ç¨åºåæè´£ä»»å®ç°æ­£ç¡®çè§£æå¨é»è¾æ¥å¤çè¿äºä¸åçå¸å±ãå­è0å°7ä¿å­çææåç±»åæå±æçå¥å£åºæåæ°æ®ãå»ºè®®ingressè§£æå¨å°ingressåé¨åæ°æ®æåå°æä¾çingress_intrinsic_metadata_tåæ°ä¸­ã</p>
<p>å­è8å°15åå«phase-0 metadataæresubmit metadataãphase-0 metadataåresubmit metadataçå¸å±ç±P4ç¨åºå®ä¹ï¼æå¤§å¤§å°ä¸º8å­èï¼åºç¨ç¨åºå¯ä»¥ä½¿ç¨8å­èææ´å°ï¼æªä½¿ç¨çå­èç¨é¶å¡«åãå³äºphase-0 metadataåresubmit metadataçå¶ä»è¯¦ç»ä¿¡æ¯å¨åé¢çåæ°æ®ç±»åä¸èä¸­æä¾ã</p>
<p>å¦æä¸ä¸ªåæ¯ä¸ä¸ªåå¾ªç¯çåï¼é£ä¹è¿ä¸ªåå¯è½å¨phase-0å¤´ä¹åæå¯éçåå¾ªç¯å¤´ï¼å¹¶ä¸å¤´å¿é¡»ç±å¥å£è§£æå¨è§£æãå¦æä¸ä½¿ç¨å¾ªç¯å¤´ï¼åå¾ªç¯å¤´çå¤§å°ä¸ºé¶ï¼ä¸éè¦è§£æé»è¾ãå¦æåæ¯ç±åé¨åçæå¨çæçï¼ååå¯è½å¨é¶æ®µ0å¤´ä¹åå·æå¯éçpktgenå¤´ãå¦æä¸ä½¿ç¨pktgenå¤´ï¼åpktgenå¤´çå¤§å°ä¸ºé¶ï¼ä¸éè¦è§£æé»è¾ãæåï¼å­èæµçå¶ä½é¨åæ¯ä»ç½ç»æ¥æ¶å°çå®éå­èã</p>
<p>ä¸å¾æ¾ç¤ºäºingressåé¨åæ°æ®çå¸å±ãå¾ä¸­æ¾ç¤ºäºæç½ç»é¡ºåºæåçå¸å±ï¼å³ç¬¬0ä½æ¯ingressè§£æå¨æ¥æ¶å°çç¬¬ä¸ä¸ªä½ã</p>
<p>![1568175571848](E:\Desktop\ç¬è®°\TNA model\1568175571848.png)</p>
<p>ä¸é¢çP4æºä»£ç æ¾ç¤ºäºTNAä¸­ingressåé¨åæ°æ®çå®ä¹ã</p>
<p>header ingress_intrinsic_metadata_t {<br>bit&lt;1&gt; resubmit_flag; // Flag distinguishing original  packets from resubmitted packets.<br>bit&lt;1&gt; _pad1;<br>bit&lt;2&gt; packet_version; // Read-only Packet version.<br>bit&lt;3&gt; _pad2;<br>PortId_t ingress_port; // Ingress physical port id.<br>bit&lt;48&gt; ingress_mac_tstamp; // Ingress IEEE 1588 timestamp (in ns)<br>}</p>
<h3 id="Egress-Intrinsic-Metadata"><a href="#Egress-Intrinsic-Metadata" class="headerlink" title="Egress Intrinsic Metadata"></a>Egress Intrinsic Metadata</h3><p>ä¸å¾æ¾ç¤ºäºå¨åºå£è§£æå¨ä¸­æ¥æ¶å°çæ°æ®åçå¸å±ãåæä¸¤ç§ç±»å:æ®éååéååãæ­£å¸¸æ°æ®åæ¯ç»è¿ingresså¤çåçæ°æ®åãéååæ¯PREåå»ºçä¼ å¥åçå¯æ¬ãå¨TNAä¸­ï¼å¯ä»¥ä»ingress deparseræegress deparserè¿è¡éåï¼éåçæµéè¢«åéå°egress deparserãå³äºéåçè¯¦ç»ä¿¡æ¯å°å¨åé¢çâéåâä¸èä¸­è§£éã</p>
<p>æ®éååéååé½ä»¥26ä¸ªå­èçåå¨åæ°æ®å¼å§ãåºå£è§£æå¨å¿é¡»å®ç°æååºå£åå¨åæ°æ®çé»è¾ãå¨åé¨åæ°æ®ä¹åï¼æ®éååå«æ¡¥æ¥æ¥å¤´ãæ¡¥æ¥æ¥å¤´æ²¡æå¤§å°éå¶ï¼ç¶èï¼è¿å¤çæ¡¥æ¥åæ°æ®ä¼æå®³æ»ä½ååéãéååå¨åé¨åæ°æ®ä¹åæå¤å¯ä»¥æ32å­èçéåå¤´æ°æ®ãP4ç¨åºçèè´£æ¯å®ç°æåéåå¤´é¨çé»è¾ãå¯¹äºå°äº32å­èçéåå¤´ï¼æ²¡æå¡«åã</p>
<p>![1568176041043](E:\Desktop\ç¬è®°\TNA model\1568176041043.png)</p>
<p>header resubmit_metadata_t {<br>// fields omitted for brevity<br>}<br>header port_metadata_t {<br>// fields omitted for brevity<br>}<br>parser TofinoIngressParser(packet_in pkt, out<br>ingress_intrinsic_metadata_t ig_intr_md) {<br>state start {<br>pkt.extract(ig_intr_md);<br>transition select(ig_intr_md.resubmit_flag) {<br>1 : parse_resubmit;<br>0 : parse_port_metadata;<br>}<br>}<br>state parse_resubmit {<br>pkt.extract<resubmit_metadata_t>(<em>);<br>transition reject;<br>}<br>state parse_port_metadata {<br>pkt.extract<port_metadata_t>(</em>);<br>transition accept;<br>}<br>}<br>parser TofinoEgressParser(packet_in pkt,<br>out egress_intrinsic_metadata_t eg_intr_md) {<br>state start {<br>pkt.extract(eg_intr_md);<br>transition accept;<br>}<br>}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/TNA%20model/" data-id="ckmn1li24000gn8a82mqxeo8q" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-pktgenåè½" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/pktgen%E5%8A%9F%E8%83%BD/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.877Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#pktgenåè½</p>
<p>I:\bf-sde-8.9.1\pkgsrc\p4-examples\p4_16_programs\tna_pktgen</p>
<p>###æ§å¶é¢éç½®pktgenç¸å³è¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pktgen_app_cfg_table &#x3D; bfrt_info.table_get(&quot;$PKTGEN_APPLICATION_CFG&quot;)</span><br><span class="line">pktgen_pkt_buffer_table &#x3D; bfrt_info.table_get(&quot;$PKTGEN_PKT_BUFFER&quot;)</span><br><span class="line">pktgen_port_cfg_table &#x3D; bfrt_info.table_get(&quot;$PKTGEN_PORT_CFG&quot;)</span><br></pre></td></tr></table></figure>

<p>###ä½¿è½pktgenç«¯å£</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pktgen_port_cfg_table.entry_add(</span><br><span class="line">	target,</span><br><span class="line">	[pktgen_port_cfg_table.make_key([gc.KeyTuple(&#39;dev_port&#39;, timer_port)])],</span><br><span class="line">	[pktgen_port_cfg_table.make_data([gc.DataTuple(&#39;pktgen_enable&#39;, bool_val&#x3D;True)])])</span><br></pre></td></tr></table></figure>

<p>entry_addç¨äºåè¡¨tableä¸­æ·»å è¡¨é¡¹entryï¼make_keyç¨äºè®¾ç½®P4ç¨åºä¸­å®ä¹çè¡¨tableçå¹éå­æ®µkeyï¼make_dataç¨äºè®¾ç½®è¡¨é¡¹çæä½actionåå¶åæ°action_dataã</p>
<p><code>def entry_add(self, target, key_list=None, data_list=None, atomicity=bfruntime_pb2.WriteRequest.CONTINUE_ON_ERROR)</code></p>
<p><code>def make_key(self, key_field_list_in)</code></p>
<p>``def make_data(self, data_field_list_in=[], action_name=None, get=False)`</p>
<p>ä¾å¦ï¼æå¦ä¸P4ç¨åºï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">action miss() &#123;</span><br><span class="line">  ig_intr_dprsr_md.drop_ctl &#x3D; 0x1;</span><br><span class="line">&#125;</span><br><span class="line">action match(PortId_t port) &#123;</span><br><span class="line">  ig_intr_tm_md.ucast_egress_port &#x3D; port;</span><br><span class="line">  ig_intr_tm_md.bypass_egress &#x3D; true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table port_metadata &#123;</span><br><span class="line">  key &#x3D; &#123;</span><br><span class="line">    ig_intr_md.ingress_port : exact;</span><br><span class="line">    md.is_pktgen : exact;</span><br><span class="line">    md.app_type : exact;</span><br><span class="line">    md.app_id : exact;</span><br><span class="line">  &#125;</span><br><span class="line">  actions &#x3D; &#123;</span><br><span class="line">    miss;</span><br><span class="line">    match;</span><br><span class="line">  &#125;</span><br><span class="line">  default_action &#x3D; miss();</span><br><span class="line">  size &#x3D; 288;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹åºçè¡¨é¡¹æ·»å æä½å¦ä¸ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">i_port_metadata_table &#x3D; bfrt_info.table_get(&quot;i.port_metadata&quot;)</span><br><span class="line">i_port_metadata_table.entry_add(</span><br><span class="line">        target,</span><br><span class="line">        [self.i_port_metadata_table.make_key([gc.KeyTuple(&#39;ig_intr_md.ingress_port&#39;, i_port),</span><br><span class="line">         gc.KeyTuple(&#39;md.is_pktgen&#39;, 1),</span><br><span class="line">         gc.KeyTuple(&#39;md.app_type&#39;, app_type),</span><br><span class="line">         gc.KeyTuple(&#39;md.app_id&#39;, app_id)])],</span><br><span class="line">         [self.i_port_metadata_table.make_data([gc.DataTuple(&#39;port&#39;, o_port)],</span><br><span class="line">            &#39;i.match&#39;)]</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<h3 id="éç½®pktgen-APP"><a href="#éç½®pktgen-APP" class="headerlink" title="éç½®pktgen APP"></a>éç½®pktgen APP</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pktgen_app_cfg_table.entry_add(</span><br><span class="line">	target,</span><br><span class="line">	[pktgen_app_cfg_table.make_key([gc.KeyTuple(&#39;app_id&#39;, app_id)])],</span><br><span class="line">	[pktgen_app_cfg_table.make_data([gc.DataTuple(&#39;timer_nanosec&#39;, 100),</span><br><span class="line">                 gc.DataTuple(&#39;app_enable&#39;,bool_val&#x3D;False),</span><br><span class="line">                 gc.DataTuple(&#39;pkt_len&#39;, (pktlen-6)),</span><br><span class="line">                 gc.DataTuple(&#39;pkt_buffer_offset&#39;, buff_offset),</span><br><span class="line">                 gc.DataTuple(&#39;pipe_local_source_port&#39;, timer_port),</span><br><span class="line">                 gc.DataTuple(&#39;increment_source_port&#39;, bool_val&#x3D;False),</span><br><span class="line">                 gc.DataTuple(&#39;batch_count_cfg&#39;, b_count-1),</span><br><span class="line">                 gc.DataTuple(&#39;packets_per_batch_cfg&#39;, p_count-1),</span><br><span class="line">                 gc.DataTuple(&#39;ibg&#39;, 1),</span><br><span class="line">                 gc.DataTuple(&#39;ibg_jitter&#39;, 0),</span><br><span class="line">                 gc.DataTuple(&#39;ipg&#39;, 1000),</span><br><span class="line">                 gc.DataTuple(&#39;ipg_jitter&#39;, 500),</span><br><span class="line">                 gc.DataTuple(&#39;batch_counter&#39;, 0),</span><br><span class="line">                 gc.DataTuple(&#39;pkt_counter&#39;, 0),</span><br><span class="line">                 gc.DataTuple(&#39;trigger_counter&#39;, 0)],</span><br><span class="line">                &#39;$PKTGEN_TRIGGER_TIMER_ONE_SHOT&#39;)])</span><br></pre></td></tr></table></figure>

<h3 id="éç½®pktgen-buffer"><a href="#éç½®pktgen-buffer" class="headerlink" title="éç½®pktgen buffer"></a>éç½®pktgen buffer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pktgen_pkt_buffer_table.entry_add(</span><br><span class="line">	target</span><br><span class="line">	[pktgen_pkt_buffer_table.make_key([gc.KeyTuple(&#39;pkt_buffer_offset&#39;, buff_offset),</span><br><span class="line">	 gc.KeyTuple(&#39;pkt_buffer_size&#39;, (pktlen-6))])],</span><br><span class="line">	[pktgen_pkt_buffer_table.make_data([gc.DataTuple(&#39;buffer&#39;, str(p)[6:])])])</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿è½pktgen"><a href="#ä½¿è½pktgen" class="headerlink" title="ä½¿è½pktgen"></a>ä½¿è½pktgen</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pktgen_app_cfg_table.entry_mod(</span><br><span class="line">	target,</span><br><span class="line">	[pktgen_app_cfg_table.make_key([gc.KeyTuple(&#39;app_id&#39;, app_id)])],</span><br><span class="line">	[pktgen_app_cfg_table.make_data([gc.DataTuple(&#39;app_enable&#39;,bool_val&#x3D;True)],</span><br><span class="line">	 &#39;$PKTGEN_TRIGGER_TIMER_ONE_SHOT&#39;)]</span><br><span class="line">            )</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å¦ä½è¯å«app-id-lookaheadæ¹æ³ä½¿ç¨"><a href="#å¦ä½è¯å«app-id-lookaheadæ¹æ³ä½¿ç¨" class="headerlink" title="å¦ä½è¯å«app_id(lookaheadæ¹æ³ä½¿ç¨)"></a>å¦ä½è¯å«app_id(lookaheadæ¹æ³ä½¿ç¨)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bit&lt;3&gt; app_id &#x3D; packet.lookahead&lt;bit&lt;8&gt;&gt;()[2:0];</span><br></pre></td></tr></table></figure>
<p>æ¥æ¶å°çäºè¿å¶æ°æ®æµä»bit0å¼å§ï¼å³LSB-&gt;MSBï¼éè¿lookaheadæä½ä¼è½¬æ¢ä¸º0xMSB-LSBï¼åçæä½ç¸å½äºæbyteå½æå­ç¬¦ä¸²ï¼ç´¢å¼ä»MSBå¼å§ã<br>ä¾å¦æ¥æ¶å°çäºè¿å¶æ°æ®æµä¸ºï¼<code>packet= 01101001_11010110</code>ï¼å¨ä¸ç§»å¨å½åæéçæåµä¸è·åæ¥ä¸æ¥8bitæ°æ®ï¼<code>data8=packet.lookahead&lt;bit&lt;8&gt;&gt;()=10010110</code>ï¼ åçæä½<code>data3=data8[2:0]=100</code>ã<br>headerç»æææ¥æ¶å°çå­èæµå®ä¹ï¼ä¾å¦æå¦ä¸headerç»æï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">header ingress_intrinsic_metadata_t &#123;</span><br><span class="line">    bit&lt;1&gt; resubmit_flag;</span><br><span class="line">    bit&lt;1&gt; _pad1;</span><br><span class="line">    bit&lt;2&gt; packet_version;</span><br><span class="line">    bit&lt;3&gt; _pad2;</span><br><span class="line">    PortId_t ingress_port;</span><br><span class="line">    bit&lt;48&gt; ingress_mac_tstamp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹åºçLayoutä¸º</p>
<p><img src="E:\Desktop\ç¬è®°\pktgenåè½\1570762344090.png" alt="1570762344090"></p>
<p>pktgenä¸­timerè§¦åç±»åçheaderç»æå¦ä¸ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">header pktgen_timer_header_t &#123;</span><br><span class="line">    bit&lt;3&gt; _pad1;</span><br><span class="line">    bit&lt;2&gt; pipe_id; â&#x2F;&#x2F; Pipe idÂ </span><br><span class="line">    bit&lt;3&gt; app_id; â&#x2F;&#x2F; Application id</span><br><span class="line">    bit&lt;8&gt; _pad2;</span><br><span class="line">    bit&lt;16&gt; batch_id; â&#x2F;&#x2F; Start at 0 and increment to a programmed numberÂ  </span><br><span class="line">    bit&lt;16&gt; packet_id; â&#x2F;&#x2F; Start at 0 and increment to a programmed number</span><br><span class="line">&#125;Â </span><br></pre></td></tr></table></figure>
<p>å¯¹åºçå­èæµä¸º:<br><code>packet = |_pad1_LSB|.|pad1_MSB| |pip_id_LSB||pip_id_MSB| |app_id_LSB|.|app_id_MSB|...</code><br>å¨ä¸extractæåæ¥å¤´ï¼å³ä¸ç§»å¨å½åæéï¼çæåµä¸è·åapp_idï¼å¯éè¿lookaheadæä½è·åå½åæéå8bitæ°æ®:<br><code>packet.lookahead&lt;bit&lt;8&gt;&gt;()=|app_id_MSB|.|app_id_LSB||pip_id_MSB||pip_id_LSB||pad1_MSB|. |_pad1_LSB|</code>ï¼<br>éè¿åçæä½è·å¾app_idï¼<br><code>app_id = packet.lookahead&lt;bit&lt;8&gt;&gt;()[2:0] = |app_id_MSB|.|app_id_LSB|</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/pktgen%E5%8A%9F%E8%83%BD/" data-id="ckmn1lhzm0008n8a8eh4ug0t2" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ORM æ¡æ¶-ä¸å±å¼åæ¶æ-ä¸­é´ä»¶" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/ORM%20%E6%A1%86%E6%9E%B6-%E4%B8%89%E5%B1%82%E5%BC%80%E5%8F%91%E6%9E%B6%E6%9E%84-%E4%B8%AD%E9%97%B4%E4%BB%B6/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.869Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="ORM-æ¡æ¶-ä¸å±å¼åæ¶æ-ä¸­é´ä»¶"><a href="#ORM-æ¡æ¶-ä¸å±å¼åæ¶æ-ä¸­é´ä»¶" class="headerlink" title="ORM æ¡æ¶\ä¸å±å¼åæ¶æ\ä¸­é´ä»¶"></a>ORM æ¡æ¶\ä¸å±å¼åæ¶æ\ä¸­é´ä»¶</h2><p>[toc]</p>
<p>å¯¹è±¡-å³ç³»æ å°ï¼Object/Relation Mappingï¼ç®ç§°ORMï¼ï¼æ¯éçé¢åå¯¹è±¡çè½¯ä»¶å¼åæ¹æ³åå±èäº§ççãé¢åå¯¹è±¡çå¼åæ¹æ³æ¯å½ä»ä¼ä¸çº§åºç¨å¼åç¯å¢ä¸­çä¸»æµå¼åæ¹æ³ï¼å³ç³»æ°æ®åºæ¯ä¼ä¸çº§åºç¨ç¯å¢ä¸­æ°¸ä¹å­æ¾æ°æ®çä¸»æµæ°æ®å­å¨ç³»ç»ãå¯¹è±¡åå³ç³»æ°æ®æ¯ä¸å¡å®ä½çä¸¤ç§è¡¨ç°å½¢å¼ï¼ä¸å¡å®ä½å¨åå­ä¸­è¡¨ç°ä¸ºå¯¹è±¡ï¼å¨æ°æ®åºä¸­è¡¨ç°ä¸ºå³ç³»æ°æ®ãåå­ä¸­çå¯¹è±¡ä¹é´å­å¨å³èåç»§æ¿å³ç³»ï¼èå¨æ°æ®åºä¸­ï¼å³ç³»æ°æ®æ æ³ç´æ¥è¡¨è¾¾å¤å¯¹å¤å³èåç»§æ¿å³ç³»ãå æ­¤ï¼å¯¹è±¡-å³ç³»æ å°(ORM)ç³»ç»ä¸è¬ä»¥ä¸­é´ä»¶çå½¢å¼å­å¨ï¼ä¸»è¦å®ç°ç¨åºå¯¹è±¡å°å³ç³»æ°æ®åºæ°æ®çæ å°ã</p>
<p>ORMæ¹æ³è®ºåºäºä¸ä¸ªæ ¸å¿ååï¼</p>
<ul>
<li>  ç®åæ§ï¼ä»¥æåºæ¬çå½¢å¼å»ºæ¨¡æ°æ®ã</li>
<li>  ä¼ è¾¾æ§ï¼æ°æ®åºç»æè¢«ä»»ä½äººé½è½çè§£çè¯­è¨ææ¡£åã</li>
<li>  ç²¾ç¡®æ§ï¼åºäºæ°æ®æ¨¡ååå»ºæ­£ç¡®æ ååäºçç»æã</li>
</ul>
<p>é¢åå¯¹è±¡æ¯ä»è½¯ä»¶å·¥ç¨åºæ¬åå(å¦è¦åãèåãå°è£)çåºç¡ä¸åå±èµ·æ¥çï¼èå³ç³»æ°æ®åºåæ¯ä»æ°å­¦çè®ºåå±èæ¥çï¼ä¸¤å¥çè®ºå­å¨æ¾èçåºå«ãä¸ºäºè§£å³è¿ä¸ªä¸å¹éçç°è±¡,å¯¹è±¡å³ç³»æ å°ææ¯åºè¿èçãO/Rä¸­å­æ¯Oèµ·æºäºâå¯¹è±¡â(Object),èRåæ¥èªäºâå³ç³»â(Relational)ãå ä¹ææçç¨åºéé¢ï¼é½å­å¨å¯¹è±¡åå³ç³»æ°æ®åºãå¨ä¸å¡é»è¾å±åç¨æ·çé¢å±ä¸­ï¼æä»¬æ¯é¢åå¯¹è±¡çãå½å¯¹è±¡ä¿¡æ¯åçååçæ¶åï¼æä»¬éè¦æå¯¹è±¡çä¿¡æ¯ä¿å­å¨å³ç³»æ°æ®åºä¸­ã</p>
<p>å½å¼åä¸ä¸ªåºç¨ç¨åºçæ¶å(ä¸ä½¿ç¨O/R Mapping),å¯è½ä¼åä¸å°æ°æ®è®¿é®å±çä»£ç ï¼ç¨æ¥ä»æ°æ®åºä¿å­ï¼å é¤ï¼è¯»åå¯¹è±¡ä¿¡æ¯ï¼ç­ç­ãå¨DALä¸­åäºå¾å¤çæ¹æ³æ¥è¯»åå¯¹è±¡æ°æ®ï¼æ¹åç¶æå¯¹è±¡ç­ç­ä»»å¡ãèè¿äºä»£ç åèµ·æ¥æ»æ¯éå¤çã</p>
<p>å¦æå¼ä½ æè¿çç¨åºï¼ççDALä»£ç ï¼è¯å®ä¼çå°å¾å¤è¿ä¼¼çéç¨çæ¨¡å¼ãæä»¬ä»¥ä¿å­å¯¹è±¡çæ¹æ³ä¸ºä¾ï¼ä¼ å¥ä¸ä¸ªå¯¹è±¡ï¼ä¸ºSqlCommandå¯¹è±¡æ·»å SqlParameterï¼æææå±æ§åå¯¹è±¡å¯¹åºï¼è®¾ç½®SqlCommandçCommandTextå±æ§ä¸ºå­å¨è¿ç¨ï¼ç¶åè¿è¡SqlCommandãå¯¹äºæ¯ä¸ªå¯¹è±¡é½è¦éå¤çåè¿äºä»£ç ãããé¤æ­¤ä¹å¤ï¼è¿ææ´å¥½çåæ³åï¼æï¼å¼å¥ä¸ä¸ªO/R Mappingãå®è´¨ä¸ï¼ä¸ä¸ªO/R Mappingä¼ä¸ºä½ çæDALãä¸å¶èªå·±åDALä»£ç ï¼ä¸å¦ç¨O/R Mappingãç¨O/R Mappingä¿å­ï¼å é¤ï¼è¯»åå¯¹è±¡ï¼O/R Mappingè´è´£çæSQLï¼ä½ åªéè¦å³å¿å¯¹è±¡å°±å¥½ãå¯¹è±¡å³ç³»æ å°æåè¿ç¨å¨ä¸åçé¢åå¯¹è±¡æä¹å±äº§åä¸­ï¼</p>
<p> ä¸è¬çORMåæ¬ä»¥ä¸åé¨åï¼ãã</p>
<ul>
<li>  ä¸ä¸ªå¯¹æä¹ç±»å¯¹è±¡è¿è¡CRUDæä½çAPIï¼ãã</li>
<li>  ä¸ä¸ªè¯­è¨æAPIç¨æ¥è§å®ä¸ç±»åç±»å±æ§ç¸å³çæ¥è¯¢ï¼ãã</li>
<li>  ä¸ä¸ªè§å®mapping metadataçå·¥å·ï¼ãã</li>
<li>  ä¸ç§ææ¯å¯ä»¥è®©ORMçå®ç°åäºå¡å¯¹è±¡ä¸èµ·è¿è¡dirty checking, lazy association fetchingä»¥åå¶ä»çä¼åæä½ã</li>
</ul>
<p>ç®åæµè¡ç ORM äº§å<br> Javaç³»åï¼ã</p>
<ul>
<li>   Apache OJB ã</li>
<li>   Cayenne ãã</li>
<li>   Jaxor ãã</li>
<li>   Hibernateãã</li>
<li>   iBatisãã</li>
<li>   jRelationalFramework ã</li>
<li>   mirage ãã</li>
<li>   SMYLE ãã</li>
<li>   TopLink</li>
</ul>
<p> å¶ä¸­ TopLink æ¯ Oracle çåä¸äº§åï¼å¶ä»åä¸ºå¼æºé¡¹ç®ãããå¶ä¸­ Hibernate çè½»éçº§ ORM æ¨¡åéæ­¥ç¡®ç«äºå¨ Java ORM æ¶æä¸­é¢å¯¼å°ä½ï¼çè³åä»£å¤æèåç¹çç EJB æ¨¡åèæä¸ºäºå®ä¸ç Java ORM å·¥ä¸æ åãèä¸å¶ä¸­çè®¸å¤è®¾è®¡åè¢« J2EE æ åç»ç»å¸çº³èæä¸ºææ° EJB 3.0 è§èçæ åï¼</p>
<p>.Netç³»åï¼ã</p>
<ul>
<li> NHibernate</li>
<li> NBear</li>
<li> Castle ActiveRecord</li>
<li> iBATIS.NET</li>
<li> DAABã</li>
<li> EntitysCodeGenerate</li>
<li> EntityFormerWork</li>
<li> Linq to sql</li>
<li> PetaPoco</li>
</ul>
<p>ä¸ï¼NHibernate<br>   æèµ·NHibernateï¼ç¸ä¿¡å¤§å®¶é½ä¸éçï¼NHibernateæ¥æºäºéå¸¸ä¼ç§çåºäºJavaçHibernateå³ç³»åæä¹åå·¥å·ï¼å®ä»æ°æ®åºåºå±æ¥æä¹å.Netå¯¹è±¡å°å³ç³»åæ°æ®åº,NHibernateä¸ºæä»¬å®æè¿ä¸åï¼èä¸ç¨èªå·±åSQLè¯­å¥å»æä½æ°æ®åºå¯¹è±¡ï¼æåçä»£ç ä»ä»åå¯¹è±¡å³èï¼NHibernatèªå¨äº§çSQLè¯­å¥ï¼å¹¶ç¡®ä¿å¯¹è±¡æäº¤å°æ­£ç¡®çè¡¨åå­æ®µä¸­å».å¤§éåå°å¼åæ¶äººå·¥ä½¿ç¨SQLåADO.NETå¤çæ°æ®çæ¶é´. NHibernateå¯ä»¥å¸®å©æ¶é¤æèåè£é£äºéå¯¹ç¹å®æ°æ®åºçSQLä»£ç ï¼å¹¶ä¸æç»æéä»è¡¨æ ¼çè¡¨ç¤ºå½¢å¼è½¬æ¢å°ä¸ç³»åçå¯¹è±¡å»ãNHibernateéç¨XMLæä»¶éç½®çæ¹å¼ï¼æ¯ä¸ä¸ªå®ä½ç±»é½ä¼å¯¹åºä¸ä¸ªæ å°æä»¶</p>
<p>äºãEntitysCodeGenerate</p>
<p>EntitysCodeGenerateã ï¼æ¯ï¼VB/C#.Netå®ä½ä»£ç çæå·¥å·ï¼çç®ç§°ï¼EntitysCodeGenerate(ECG)æ¯ä¸æ¬¾ä¸é¨ä¸º.Netæ°æ®åºç¨åºå¼åéèº«å®åç(ORMæ¡æ¶)ä»£ç çæå·¥å·ï¼æçæçç¨åºä»£ç åºäºé¢åå¯¹è±¡ãåå±æ¶æãORMååå°+å·¥åæ¨¡å¼ç­ã</p>
<p>ä¸ã PetaPoco</p>
<p>PetaPocoæ¯ä¸æ¬¾éç¨äº.Net åMonoçå¾®å°ãå¿«éãåæä»¶çå¾®åORMã</p>
<p>PetaPocoæä»¥ä¸ç¹è²ï¼</p>
<ul>
<li>å¾®å°ï¼æ²¡æä¾èµé¡¹â¦â¦åä¸ªçC#æä»¶å¯ä»¥æ¹ä¾¿çæ·»å å°ä»»ä½é¡¹ç®ä¸­ã</li>
<li>å·¥ä½äºä¸¥æ ¼çæ²¡æè£é¥°çPocoç±»ï¼åå ä¹å¨é¨å äºç¹æ§çPocoç±»</li>
<li>Insert/Delete/Update/Save and IsNew ç­å¸®å©æ¹æ³ã</li>
<li>åé¡µæ¯æï¼èªå¨å¾å°æ»è¡æ°åæ°æ®</li>
<li>æ¯æç®åçäºå¡</li>
<li>æ´å¥½çæ¯æåæ°æ¿æ¢ï¼åæ¬ä»å¯¹è±¡å±æ§ä¸­æåå½åçåæ°ã</li>
<li>å¾å¥½çæ§è½ï¼åé¤äºLinqï¼å¹¶éè¿Dynamicæ¹æ³å¿«éçä¸ºå±æ§èµå¼</li>
<li>T4æ¨¡æ¿èªå¨çæPocoç±»</li>
<li>æ¥è¯¢è¯­è¨æ¯Sqlâ¦â¦ä¸æ¯æå«æ­çfluentæLinqè¯­æ³ï¼ä»èè§ä»ï¼æºèè§æºï¼</li>
<li>åå«ä¸ä¸ªä½è¦åçSql Builderç±»ï¼è®©åèçSqlæ´å®¹æä¹¦å</li>
<li>ä¸ºå¼å¸¸ä¿¡æ¯è®°å½ãå¼è½¬æ¢å¨å®è£åæ°æ®æ å°æä¾é©å­ãï¼Hooks for logging exceptions, installing value converters and mapping columns to properties without attributes.ï¼</li>
<li>å¼å®¹SQL Server, SQL Server CE, MySQL, PostgreSQL and Oracleã</li>
<li>å¯ä»¥å¨.NET 3.5 æMono 2.6ææ´é«çæ¬ä¸è¿è¡</li>
<li>å¨.NET 4.0 åMono 2.8ä¸æ¯ædynamic</li>
<li>NUnitååæµè¯</li>
<li>å¼æºï¼Apache Licenseï¼</li>
<li>ææåè½å¤§çº¦ç¨äº1500è¡ä»£ç </li>
</ul>
<h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><p> CRUDæ¯æå¨åè®¡ç®å¤çæ¶çå¢å (Create)ãè¯»å(Read)ãæ´æ°(Update)åå é¤(Delete)å ä¸ªåè¯çé¦å­æ¯ç®åãcrudä¸»è¦è¢«ç¨å¨æè¿°è½¯ä»¶ç³»ç»ä¸­æ°æ®åºæè<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8C%81%E4%B9%85%E5%B1%82/3584971">æä¹å±</a>çåºæ¬æä½åè½ã </p>
<p>DALæ¯æ°æ®è®¿é®å±çè±æç¼©åï¼å³ä¸ºæ°æ®è®¿é®å±ï¼Data Access Layerï¼ãå¶åè½ä¸»è¦æ¯è´è´£æ°æ®åºçè®¿é®ãç®åå°è¯´å°±æ¯å®ç°å¯¹æ°æ®è¡¨çSelectï¼æ¥è¯¢ï¼ãInsertï¼æå¥ï¼ãUpdateï¼æ´æ°ï¼ãDeleteï¼å é¤ï¼ç­æä½ã </p>
<h2 id="ä¸å±å¼åæ¶æ"><a href="#ä¸å±å¼åæ¶æ" class="headerlink" title="ä¸å±å¼åæ¶æ"></a>ä¸å±å¼åæ¶æ</h2><p>ä¸å±æ¶æ(3-tier architecture) éå¸¸æä¹ä¸çä¸å±æ¶æå°±æ¯å°æ´ä¸ªä¸å¡åºç¨ååä¸ºï¼çé¢å±ï¼User Interface layerï¼ãä¸å¡é»è¾å±ï¼Business Logic Layerï¼ãæ°æ®è®¿é®å±ï¼Data access layerï¼ãåºåå±æ¬¡çç®çå³ä¸ºäºâé«åèä½è¦åâçææ³ãå¨è½¯ä»¶ä½ç³»æ¶æè®¾è®¡ä¸­ï¼åå±å¼ç»ææ¯æå¸¸è§ï¼ä¹æ¯æéè¦çä¸ç§ç»æãå¾®è½¯æ¨èçåå±å¼ç»æä¸è¬åä¸ºä¸å±ï¼ä»ä¸è³ä¸åå«ä¸ºï¼æ°æ®è®¿é®å±ãä¸å¡é»è¾å±ï¼åæç§°ä¸ºé¢åå±ï¼ãè¡¨ç¤ºå±ã</p>
<h3 id="1-è¡¨ç¤ºå±ï¼USLï¼"><a href="#1-è¡¨ç¤ºå±ï¼USLï¼" class="headerlink" title="1.è¡¨ç¤ºå±ï¼USLï¼"></a>1.è¡¨ç¤ºå±ï¼USLï¼</h3><p>ä¸»è¦è¡¨ç¤ºWEBæ¹å¼ï¼ä¹å¯ä»¥è¡¨ç¤ºæWINFORMæ¹å¼ãå¦æé»è¾å±ç¸å½å¼ºå¤§åå®åï¼æ è®ºè¡¨ç°å±å¦ä½å®ä¹åæ´æ¹ï¼é»è¾å±é½è½å®åå°æä¾æå¡ã</p>
<p>è¡¨ç¤ºå±åç§°è¡¨ç°å±UIï¼ä½äºä¸å±ææ¶çæä¸å±ï¼ä¸ç¨æ·ç´æ¥æ¥è§¦ï¼ä¸»è¦æ¯B/Sä¿¡æ¯ç³»ç»ä¸­çWebæµè§é¡µé¢ãä½ä¸ºWebæµè§é¡µé¢ï¼è¡¨ç¤ºå±çä¸»è¦åè½æ¯å®ç°ç³»ç»æ°æ®çä¼ å¥ä¸è¾åºï¼å¨æ­¤è¿ç¨ä¸­ä¸éè¦åå©é»è¾å¤æ­æä½å°±å¯ä»¥å°æ°æ®ä¼ éå°BLLç³»ç»ä¸­è¿è¡æ°æ®å¤çï¼å¤çåä¼å°å¤çç»æåé¦å°è¡¨ç¤ºå±ä¸­ãæ¢å¥è¯è¯´ï¼è¡¨ç¤ºå±å°±æ¯å®ç°ç¨æ·çé¢åè½ï¼å°ç¨æ·çéæ±ä¼ è¾¾ååé¦ï¼å¹¶ç¨BLLæèæ¯Modelsè¿è¡è°è¯ï¼ä¿è¯ç¨æ·ä½éªã </p>
<h3 id="2-ä¸å¡é»è¾å±ï¼BLLï¼ï¼"><a href="#2-ä¸å¡é»è¾å±ï¼BLLï¼ï¼" class="headerlink" title="2.ä¸å¡é»è¾å±ï¼BLLï¼ï¼"></a>2.ä¸å¡é»è¾å±ï¼BLLï¼ï¼</h3><p>ä¸»è¦æ¯éå¯¹å·ä½çé®é¢çæä½ï¼ä¹å¯ä»¥çè§£æå¯¹æ°æ®å±çæä½ï¼å¯¹æ°æ®ä¸å¡é»è¾å¤çãå¦æè¯´æ°æ®å±æ¯ç§¯æ¨ï¼é£é»è¾å±å°±æ¯å¯¹è¿äºç§¯æ¨çæ­å»ºã</p>
<p>ä¸å¡é»è¾å±ï¼Business Logic Layerï¼æ çæ¯ç³»ç»æ¶æä¸­ä½ç°æ ¸å¿ä»·å¼çé¨åãå®çå³æ³¨ç¹ä¸»è¦éä¸­å¨ä¸å¡è§åçå¶å®ãä¸å¡æµç¨çå®ç°ç­ä¸ä¸å¡éæ±æå³çç³»ç»è®¾è®¡ï¼ä¹å³æ¯è¯´å®æ¯ä¸ç³»ç»æåºå¯¹çé¢åï¼Domainï¼é»è¾æå³ï¼å¾å¤æ¶åï¼ä¹å°ä¸å¡é»è¾å±ç§°ä¸ºé¢åå±ã </p>
<p>ä¸å¡é»è¾å±è´è´£ç³»ç»é¢åä¸å¡çå¤çï¼è´è´£é»è¾æ§æ°æ®ççæãå¤çåè½¬æ¢ãå¯¹æè¾å¥çé»è¾æ§æ°æ®çæ­£ç¡®æ§åæææ§è´è´£ï¼ä½å¯¹è¾åºçé»è¾æ§æ°æ®åç¨æ·æ§æ°æ®çæ­£ç¡®æ§ä¸è´è´£ï¼å¯¹æ°æ®çåç°æ ·å¼ä¸è´è´£ã </p>
<p>ä¸å¡é»è¾å±BLLçåè½æ¯å¯¹å·ä½é®é¢è¿è¡é»è¾å¤æ­ä¸æ§è¡æä½ï¼æ¥æ¶å°è¡¨ç°å±UIçç¨æ·æä»¤åï¼ä¼è¿æ¥æ°æ®è®¿é®å±DALï¼è®¿é®å±å¨ä¸å±ææ¶ä¸­ä½äºè¡¨ç¤ºå±ä¸æ°æ®å±ä¸­é´ä½ç½®ï¼åæ¶ä¹æ¯è¡¨ç¤ºå±ä¸æ°æ®å±çæ¡¥æ¢ï¼å®ç°ä¸å±ä¹é´çæ°æ®è¿æ¥åæä»¤ä¼ è¾¾ï¼å¯ä»¥å¯¹æ¥æ¶æ°æ®è¿è¡é»è¾å¤çï¼å®ç°æ°æ®çä¿®æ¹ãè·åãå é¤ç­åè½ï¼å¹¶å°å¤çç»æåé¦å°è¡¨ç¤ºå±UIä¸­ï¼å®ç°è½¯ä»¶åè½ã </p>
<p>ä¾å¦Martin Fowlerå¨ãPatterns of Enterprise Application Architectureãä¸ä¹¦ä¸­ï¼å°æ´ä¸ªæ¶æåä¸ºä¸ä¸ªä¸»è¦çå±ï¼è¡¨ç¤ºå±ãé¢åå±åæ°æ®æºå±ãä½ä¸ºé¢åé©±å¨è®¾è®¡çåé©±Eric Evansï¼å¯¹ä¸å¡é»è¾å±ä½äºæ´ç»è´å°ååï¼ç»åä¸ºåºç¨å±ä¸é¢åå±ï¼éè¿åå±è¿ä¸æ­¥å°é¢åé»è¾ä¸é¢åé»è¾çè§£å³æ¹æ¡åç¦»ã</p>
<p>ä¸å¡é»è¾å±å¨ä½ç³»æ¶æä¸­çä½ç½®å¾å³é®ï¼å®å¤äºæ°æ®è®¿é®å±ä¸è¡¨ç¤ºå±ä¸­é´ï¼èµ·å°äºæ°æ®äº¤æ¢ä¸­æ¿ä¸å¯ä¸çä½ç¨ãç±äºå±æ¯ä¸ç§å¼±è¦åç»æï¼å±ä¸å±ä¹é´çä¾èµæ¯åä¸çï¼åºå±å¯¹äºä¸å±èè¨æ¯âæ ç¥âçï¼æ¹åä¸å±çè®¾è®¡å¯¹äºå¶è°ç¨çåºå±èè¨æ²¡æä»»ä½å½±åãå¦æå¨åå±è®¾è®¡æ¶ï¼éµå¾ªäºé¢åæ¥å£è®¾è®¡çææ³ï¼é£ä¹è¿ç§åä¸çä¾èµä¹åºè¯¥æ¯ä¸ç§å¼±ä¾èµå³ç³»ãå èå¨ä¸æ¹åæ¥å£å®ä¹çåæä¸ï¼çæ³çåå±å¼æ¶æï¼åºè¯¥æ¯ä¸ä¸ªæ¯æå¯æ½åãå¯æ¿æ¢çâæ½å±âå¼æ¶æãæ­£å ä¸ºå¦æ­¤ï¼ä¸å¡é»è¾å±çè®¾è®¡å¯¹äºä¸ä¸ªæ¯æå¯æ©å±çæ¶æå°¤ä¸ºå³é®ï¼å ä¸ºå®æ®æ¼äºä¸¤ä¸ªä¸åçè§è²ãå¯¹äºæ°æ®è®¿é®å±èè¨ï¼å®æ¯è°ç¨èï¼å¯¹äºè¡¨ç¤ºå±èè¨ï¼å®å´æ¯è¢«è°ç¨èãä¾èµä¸è¢«ä¾èµçå³ç³»é½çº ç»å¨ä¸å¡é»è¾å±ä¸ï¼å¦ä½å®ç°ä¾èµå³ç³»çè§£è¦ï¼åæ¯é¤äºå®ç°ä¸å¡é»è¾ä¹å¤çç»è®¾è®¡å¸çä»»å¡ã</p>
<h3 id="3-æ°æ®è®¿é®å±ï¼DALï¼-æ°æ®è®¿"><a href="#3-æ°æ®è®¿é®å±ï¼DALï¼-æ°æ®è®¿" class="headerlink" title="3.æ°æ®è®¿é®å±ï¼DALï¼ æ°æ®è®¿"></a>3.æ°æ®è®¿é®å±ï¼DALï¼ æ°æ®è®¿</h3><p>é®å±DALæ¯æ°æ®åºçä¸»è¦ææ§ç³»ç»ï¼å®ç°æ°æ®çå¢å ãå é¤ãä¿®æ¹ãæ¥è¯¢ç­æä½ï¼å¹¶å°æä½ç»æåé¦å°ä¸å¡é»è¾å±BLLãå¨å®éè¿è¡çè¿ç¨ä¸­ï¼æ°æ®è®¿é®å±æ²¡æé»è¾å¤æ­è½åï¼ä¸ºäºå®ç°ä»£ç ç¼åçä¸¥è°¨æ§ï¼æé«ä»£ç éè¯»ç¨åº¦ï¼ä¸è¬è½¯ä»¶å¼åäººåä¼å¨è¯¥å±ä¸­ç¼åDataAccessCommonï¼ä¿è¯æ°æ®è®¿é®å±DALæ°æ®å¤çåè½ã</p>
<p>ä¸»è¦æ¯å¯¹åå§æ°æ®(æ°æ®åºæèææ¬æä»¶ç­å­æ¾æ°æ®çå½¢å¼)çæä½å±ï¼èä¸æ¯æåå§æ°æ®ï¼ä¹å°±æ¯è¯´ï¼æ¯å¯¹æ°æ®çæä½ï¼èä¸æ¯æ°æ®åºï¼å·ä½ä¸ºä¸å¡é»è¾å±æè¡¨ç¤ºå±æä¾æ°æ®æå¡ã</p>
<p>æ°æ®åºè®¿é®å±ï¼åç§°ä¸ºDALå±ï¼ææ¶åä¹ç§°ä¸ºæ¯æä¹å±ï¼å¶åè½ä¸»è¦æ¯è´è´£æ°æ®åºçè®¿é®ãç®åå°è¯´å°±æ¯å®ç°å¯¹æ°æ®è¡¨çSelectï¼æ¥è¯¢ï¼ãInsertï¼æå¥ï¼ãUpdateï¼æ´æ°ï¼ãDeleteï¼å é¤ï¼ç­æä½ãå¦æè¦å å¥ORMçææ³ï¼å°±ä¼åæ¬å¯¹è±¡åæ°æ®è¡¨ä¹é´çæ å°ï¼ä»¥åå¯¹è±¡å®ä½çæä¹åæä½ã</p>
<p>å¨é¡¹ç®å®éå¼åè¿ç¨ï¼æçç´æ¥éç¨<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JDBC">JDBC</a>ææ¯è¿è¡æ°æ®åºæä¹åæä½ï¼æçéç¨ç®åå¾å¥½ç¨ç<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ORM%E6%A1%86%E6%9E%B6">ORMæ¡æ¶</a>æ¥è¿è¡æ°æ®åºæä¹åæä½ã</p>
<p>æ½åæ°æ®åºè®¿é®å±çä¸»è¦ä½ç¨æ¯è¿è¡éç¦»ï¼æä¸æ°æ®åºæäº¤éçäºæé½æ¾å¨æ°æ®è®¿é®å±è§£å³ï¼å¨æå¡å±ååªè¦è°ç¨æ°æ®è®¿é®å±å°±å¯ä»¥äºï¼ä¸å¿åå·ä½çORMå±å®ç°ç¸è¦åã</p>
<p>è®²å°æ°æ®åºè®¿é®å±ï¼ä¸å¾ä¸æä¸ä¸å±æ¶æï¼éå¸¸ä¼æåºç¨ç³»ç»ååä¸ºï¼è¡¨ç°å±ãä¸å¡é»è¾å±åæ°æ®åºè®¿é®å±ãè¿æ ·çè®¾è®¡ç®çæ¯ä¸ºäºå®ç°âé«åèï¼ä½è¦åâçè®¾è®¡ææ³ãæ°æ®åºè®¿é®å±å¨ä¸å±æ¶æä¸­åªè´è´£æ°æ®å­å¨ä¸è¯»åãä¸å¡é»è¾å±ä½ä¸ºæ°æ®åºè®¿é®å±çä¸å±ï¼åé¨è°ç¨æ°æ®åºè®¿é®å±æä¾çæ¹æ³ï¼æ¥å®ææ°æ®çå­å¨ä¸è¯»åãæ°æ®åºè®¿é®å±ä¸åºå±æ°æ®åºåºè¯¥æ¯ç¬ç«çï¼å¥½çæ°æ®åºè®¿é®å±æ¹æ¡æ¯è½å¤å¨ä¸ä¿®æ¹ç¨åºä»£ç åè½çåºç¡ä¹ä¸å®ç°ä¸åç±»åæ°æ®åºçå¨æåæ¢ãæä»¬æ¯è¾çæçåæ³å°±æ¯éè¿XMLéç½®æä»¶æ¥å®æåºå±æ°æ®åºçåæ¢ãç®åå¾å¤æµè¡çæ°æ®åºè®¿é®å±æ¡æ¶é½æ¯éç¨è¿ç§æ¹å¼æ¥å®ç°æ°æ®åºçå¨æåæ¢ãæ°æ®è®¿é®å±è½å¤å°åºç¨ç¨åºä¸­çæ°æ®æä¹åå°å­å¨ä»è´¨ä¸­ï¼éå¸¸æä»¬ä½¿ç¨çæ°æ®åºé½æ¯å³ç³»åçæ°æ®åºï¼éç¨çæ°æ®æ¨¡åé½æ¯å¯¹è±¡æ¨¡åï¼è¿å°±éè¦æ°æ®åºè®¿é®å±å®ç°å¯¹è±¡æ¨¡åä¸å³ç³»æ¨¡åç´æ¥çãäºç¸çè½¬æ¢ã</p>
<p>DAO(Data Access Object)æ¯ä¸ä¸ªæ°æ®è®¿é®æ¥å£ï¼æ°æ®è®¿é®ï¼é¡¾åæä¹å°±æ¯ä¸æ°æ®åºæäº¤éãå¤¹å¨ä¸å¡é»è¾ä¸æ°æ®åºèµæºä¸­é´ã</p>
<p>å¨æ ¸å¿J2EEæ¨¡å¼ä¸­æ¯è¿æ ·ä»ç»DAOæ¨¡å¼çï¼ä¸ºäºå»ºç«ä¸ä¸ªå¥å£®çJ2EEåºç¨ï¼åºè¯¥å°ææå¯¹æ°æ®æºçè®¿é®æä½æ½è±¡å°è£å¨ä¸ä¸ªå¬å±APIä¸­ãç¨ç¨åºè®¾è®¡çè¯­è¨æ¥è¯´ï¼å°±æ¯å»ºç«ä¸ä¸ªæ¥å£ï¼æ¥å£ä¸­å®ä¹äºæ­¤åºç¨ç¨åºä¸­å°ä¼ç¨å°çææäºå¡æ¹æ³ãå¨è¿ä¸ªåºç¨ç¨åºä¸­ï¼å½éè¦åæ°æ®æºè¿è¡äº¤äºçæ¶ååä½¿ç¨è¿ä¸ªæ¥å£ï¼å¹¶ä¸ç¼åä¸ä¸ªåç¬çç±»æ¥å®ç°è¿ä¸ªæ¥å£å¨é»è¾ä¸å¯¹åºè¿ä¸ªç¹å®çæ°æ®å­å¨ã</p>
<h2 id="ä¸­é´ä»¶"><a href="#ä¸­é´ä»¶" class="headerlink" title="ä¸­é´ä»¶"></a>ä¸­é´ä»¶</h2><p> ä¸­é´ä»¶æ¯ä»äºåºç¨ç³»ç»åç³»ç»è½¯ä»¶ä¹é´çä¸ç±»è½¯ä»¶ï¼å®ä½¿ç¨ç³»ç»è½¯ä»¶ææä¾çåºç¡æå¡ï¼åè½ï¼ï¼è¡æ¥ç½ç»ä¸åºç¨ç³»ç»çåä¸ªé¨åæä¸åçåºç¨ï¼è½å¤è¾¾å°èµæºå±äº«ãåè½å±äº«çç®çãç®åï¼å®å¹¶æ²¡æå¾ä¸¥æ ¼çå®ä¹ï¼ä½æ¯æ®éæ¥åIDCçå®ä¹ï¼ä¸­é´ä»¶æ¯ä¸ç§ç¬ç«çç³»ç»è½¯ä»¶æå¡ç¨åºï¼åå¸å¼åºç¨è½¯ä»¶åå©è¿ç§è½¯ä»¶å¨ä¸åçææ¯ä¹é´å±äº«èµæºï¼ä¸­é´ä»¶ä½äºå®¢æ·æºæå¡å¨çæä½ç³»ç»ä¹ä¸ï¼ç®¡çè®¡ç®èµæºåç½ç»éä¿¡ãä»è¿ä¸ªæä¹ä¸å¯ä»¥ç¨ä¸ä¸ªç­å¼æ¥è¡¨ç¤ºä¸­é´ä»¶ï¼ä¸­é´ä»¶=å¹³å°+éä¿¡ï¼è¿ä¹å°±éå®äºåªæç¨äºåå¸å¼ç³»ç»ä¸­æè½å«ä¸­é´ä»¶ï¼åæ¶ä¹æå®ä¸æ¯æè½¯ä»¶åå®ç¨è½¯ä»¶åºåå¼æ¥ã </p>
<p>ä¸­é´ä»¶æ¯ä¸ç±»è¿æ¥è½¯ä»¶ç»ä»¶ååºç¨çè®¡ç®æºè½¯ä»¶ï¼å®åæ¬ä¸ç»æå¡ãä»¥ä¾¿äºè¿è¡å¨ä¸å°æå¤å°æºå¨ä¸çå¤ä¸ªè½¯ä»¶éè¿ç½ç»è¿è¡äº¤äºãè¯¥ææ¯ææä¾çäºæä½æ§ï¼æ¨å¨äºä¸è´åå¸å¼ä½ç³»æ¶æçæ¼è¿ï¼è¯¥æ¶æéå¸¸ç¨äºæ¯æå¹¶ç®åé£äºå¤æçåå¸å¼åºç¨ç¨åºï¼å®åæ¬webæå¡å¨ãäºå¡çæ§å¨åæ¶æ¯éåè½¯ä»¶ã </p>
<p>ä¸­é´ä»¶(middleware)æ¯åºç¡è½¯ä»¶çä¸å¤§ç±»ï¼å±äºå¯å¤ç¨è½¯ä»¶çèç´ãé¡¾åæä¹ï¼ä¸­é´ä»¶å¤äºæä½ç³»ç»è½¯ä»¶ä¸ç¨æ·çåºç¨è½¯ä»¶çä¸­é´ã </p>
<p>ä¸­é´ä»¶å¨æä½ç³»ç»ãç½ç»åæ°æ®åºä¹ä¸ï¼åºç¨è½¯ä»¶çä¸å±ï¼æ»çä½ç¨æ¯ä¸ºå¤äºèªå·±ä¸å±çåºç¨è½¯ä»¶æä¾è¿è¡ä¸å¼åçç¯å¢ï¼å¸®å©ç¨æ·çµæ´»ãé«æå°å¼ååéæå¤æçåºç¨è½¯ä»¶ãå¨ä¼å¤å³äºä¸­é´ä»¶çå®ä¹ä¸­ï¼æ¯è¾æ®éè¢«æ¥åçæ¯IDCè¡¨è¿°çï¼ä¸­é´ä»¶æ¯ä¸ç§ç¬ç«çç³»ç»è½¯ä»¶ææå¡ç¨åºï¼åå¸å¼åºç¨è½¯ä»¶åå©è¿ç§è½¯ä»¶å¨ä¸åçææ¯ä¹é´å±äº«èµæºï¼ä¸­é´ä»¶ä½äºå®¢æ·æºæå¡å¨çæä½ç³»ç»ä¹ä¸ï¼ç®¡çè®¡ç®èµæºåç½ç»éä¿¡ã </p>
<p>è¿å¹´æ¥ï¼äººç±»çæ´»ä¸­è¶æ¥è¶å¤çé¢åå·²ç»åå¾ç¦»ä¸å¼è®¡ç®æºãç½ç»ææ¯ä»¥åéä¿¡ææ¯ãå¹¶ä¸éçè®¡ç®æºææ¯çå¿«éåå±ï¼æ´å¤çåºç¨è½¯ä»¶è¢«è¦æ±å¨è®¸å¤ä¸åçç½ç»åè®®ãä¸åçç¡¬ä»¶çäº§ååä»¥åä¸ä¸æ ·çç½ç»å¹³å°åç¯å¢ä¸è¿è¥ãè¿å¯¼è´äºè½¯ä»¶å¼åèéè¦é¢ä¸´æ°æ®ç¦»æ£ãæä½å°é¾ãç³»ç»å¹éç¨åº¦ä½ï¼ä»¥åéè¦å¼åå¤ç§åºç¨ç¨åºæ¥è¾¾å°è¿è¥çç®çãæä»¥ï¼ä¸­é´ä»¶ææ¯çäº§çï¼å¨æå¤§ç¨åº¦ä¸åè½»äºå¼åèçè´æï¼ä½¿å¾ç½ç»çè¿è¡æ´ææçã</p>
<h3 id="åºæ¬åè½"><a href="#åºæ¬åè½" class="headerlink" title="åºæ¬åè½"></a>åºæ¬åè½</h3><p>ä¸­é´ä»¶æ¯ç¬ç«çç³»ç»çº§è½¯ä»¶ï¼è¿æ¥æä½ç³»ç»å±ååºç¨ç¨åºå±ï¼å°ä¸åæä½ç³»ç»æä¾åºç¨çæ¥å£æ ååï¼åè®®ç»ä¸åï¼å±è½å·ä½æä½çç»èï¼ä¸­é´ä»¶ä¸è¬æä¾å¦ä¸åè½ï¼ </p>
<p>####ï¼1ï¼éä¿¡æ¯æ</p>
<p>ä¸­é´ä»¶ä¸ºå¶ææ¯æçåºç¨è½¯ä»¶æä¾å¹³å°åçè¿è¡ç¯å¢ï¼è¯¥ç¯å¢å±è½åºå±éä¿¡ä¹é´çæ¥å£å·®å¼ï¼å®ç°äºæä½ï¼</p>
<p>æä»¥éä¿¡æ¯ææ¯ä¸­é´ä»¶ä¸ä¸ªæåºæ¬çåè½ãæ©æåºç¨ä¸åå¸å¼çä¸­é´ä»¶äº¤äºä¸»è¦çéä¿¡æ¹å¼ä¸ºè¿ç¨è°ç¨åæ¶æ¯ä¸¤ç§æ¹å¼ãéä¿¡æ¨¡åä¸­ï¼è¿ç¨è°ç¨éè¿ç½ç»è¿è¡éä¿¡ï¼éè¿æ¯ææ°æ®çè½¬æ¢åéä¿¡æå¡ï¼ä»èå±è½ä¸åçæä½ç³»ç»åç½ç»åè®®ãè¿ç¨è°ç¨æ¯æä¾ç»äºè¿ç¨çæå¡è®¿é®ï¼ä¸ºä¸å±ç³»ç»åªæä¾éå¸¸ç®åçç¼ç¨æ¥å£æè¿ç¨è°ç¨æ¨¡åãæ¶æ¯æä¾å¼æ­¥äº¤äºçæºå¶ã [3]</p>
<p>####ï¼2ï¼åºç¨æ¯æ</p>
<p>ä¸­é´ä»¶çç®çå°±æ¯æå¡ä¸å±åºç¨ï¼æä¾åºç¨å±ä¸åæå¡ä¹é´çäºæä½æºå¶ãå®ä¸ºä¸å±åºç¨å¼åæä¾ç»ä¸çå¹³å°åè¿è¡ç¯å¢ï¼å¹¶å°è£ä¸åæä½ç³»ç»æä¾APIæ¥å£ï¼ååºç¨æä¾ç»ä¸çæ åæ¥å£ï¼ä½¿åºç¨çå¼ååè¿è¡ä¸æä½ç³»ç»æ å³ï¼å®ç°å¶ç¬ç«æ§ãä¸­é´ä»¶æ¾è¦åçç»æï¼æ åçå°è£æå¡åæ¥å£ï¼ææçäºæä½æºå¶ï¼ä»èç»åºç¨ç»æååå¼åæ¹æ³æä¾æåçæ¯æã </p>
<p>####ï¼3ï¼å¬å±æå¡</p>
<p>å¬å±æå¡æ¯å¯¹åºç¨è½¯ä»¶ä¸­å±æ§åè½æçº¦æçæåãå°è¿äºå±æ§çåè½æèçº¦æåç±»å®ç°ï¼å¹¶æ¯æå¤ç¨ï¼ä½ä¸ºå¬å±æå¡ï¼æä¾ç»åºç¨ç¨åºä½¿ç¨ãéè¿æä¾æ åãç»ä¸çå¬å±æå¡ï¼å¯åå°ä¸å±åºç¨çå¼åå·¥ä½éï¼ç¼©ç­åºç¨çå¼åæ¶é´ï¼å¹¶æå©äºæä¾åºç¨è½¯ä»¶çè´¨éã  </p>
<h3 id="åç±»"><a href="#åç±»" class="headerlink" title="åç±»"></a>åç±»</h3><p>####ï¼1ï¼äºå¡å¼ä¸­é´ä»¶</p>
<p>äºå¡å¼ä¸­é´ä»¶åç§°äºå¡å¤çç®¡çç¨åºï¼æ¯å½åç¨çæå¹¿æ³çä¸­é´ä»¶ä¹ä¸ï¼å¶ä¸»è¦åè½æ¯æä¾èæºäºå¡å¤çæéè¦çéä¿¡ãå¹¶åè®¿é®æ§å¶ãäºå¡æ§å¶ãèµæºç®¡çãå®å¨ç®¡çãè´è½½å¹³è¡¡ãæéæ¢å¤åå¶ä»å¿è¦çæå¡ãäºå¡å¼ä¸­é´ä»¶æ¯æå¤§éå®¢æ·è¿ç¨çå¹¶åè®¿é®ï¼å·ææå¼ºçæ©å±æ§ãç±äºäºå¡å¼ä¸­é´ä»¶å·æå¯é æ§é«ãæå¼ºçæ©å±æ§ç­ç¹ç¹ï¼ä¸»è¦åºç¨äºçµä¿¡ãéèãé£æºè®¢ç¥¨ç³»ç»ãè¯å¸ç­æ¥æå¤§éå®¢æ·çé¢åã [3] </p>
<p>####ï¼2ï¼è¿ç¨å¼ä¸­é´ä»¶</p>
<p>è¿ç¨å¼ä¸­é´ä»¶åç§°è¿ç¨è¿ç¨è°ç¨ä¸­é´ä»¶ãè¿ç¨ä¸­é´ä»¶ä¸è¬ä»é»è¾ä¸åä¸ºä¸¤é¨åï¼å®¢æ·åæå¡å¨ãå®¢æ·åæå¡å¨æ¯ä¸ä¸ªé»è¾æ¦å¿µï¼æ¢å¯ä»¥è¿è¡å¨åä¸è®¡ç®æºä¸ï¼ä¹å¯ä»¥è¿è¡å¨ä¸åçè®¡ç®æºä¸ï¼çè³å®¢æ·åæå¡å¨åºå±çæä½ç³»ç»ä¹å¯ä»¥ä¸åãå®¢æ·æºåæå¡å¨ä¹é´çéä¿¡å¯ä»¥ä½¿ç¨åæ­¥éä¿¡ï¼ä¹å¯ä»¥éç¨çº¿ç¨å¼å¼æ­¥è°ç¨ãæä»¥è¿ç¨å¼ä¸­é´ä»¶æè¾å¥½çå¼ææ¯æè½åï¼ç®åæç¨ï¼ä½ç±äºå®¢æ·åæå¡å¨ä¹é´éç¨è®¿é®è¿æ¥ï¼æä»¥å¨æåªè£æ§åå®¹éæ¹é¢æä¸å®çå±éæ§ã [3] </p>
<p>####ï¼3ï¼é¢åæ¶æ¯çä¸­é´ä»¶</p>
<p>é¢åæ¶æ¯çä¸­é´ä»¶ï¼ç®ç§°ä¸ºæ¶æ¯ä¸­é´ä»¶ï¼æ¯ä¸ç±»ä»¥æ¶æ¯ä¸ºè½½ä½è¿è¡éä¿¡çä¸­é´ä»¶ï¼å©ç¨é«æå¯é çæ¶æ¯æºå¶æ¥å®ç°ä¸ååºç¨é´å¤§éçæ°æ®äº¤æ¢ãæå¶éä¿¡æ¨¡åçä¸åï¼æ¶æ¯ä¸­é´ä»¶çéä¿¡æ¨¡åæä¸¤ç±»ï¼æ¶æ¯éååæ¶æ¯ä¼ éãéè¿è¿ä¸¤ç§æ¶æ¯æ¨¡åï¼ä¸ååºç¨ä¹é´çéä¿¡åç½ç»çå¤ææ§è±ç¦»ï¼æè±å¯¹ä¸åéä¿¡åè®®çä¾èµï¼å¯ä»¥å¨å¤æçç½ç»ç¯å¢ä¸­é«å¯é ãé«æççå®ç°å®å¨çå¼æ­¥éä¿¡ãæ¶æ¯ä¸­é´ä»¶çéç´æ¥è¿æ¥ï¼æ¯æå¤ç§éä¿¡è§ç¨ï¼è¾¾å°å¤ä¸ªç³»ç»ä¹é´çæ°æ®çå±äº«ååæ­¥ãé¢åæ¶æ¯ä¸­é´ä»¶æ¯ä¸ç±»å¸¸ç¨çä¸­é´ä»¶ã </p>
<p>####ï¼4ï¼é¢åå¯¹è±¡ä¸­é´ä»¶</p>
<p>é¢åå¯¹è±¡ä¸­é´ä»¶åç§°åå¸å¯¹è±¡ä¸­é´ä»¶ï¼æ¯åå¸å¼è®¡ç®ææ¯åé¢åå¯¹è±¡ææ¯åå±çç»åï¼ç®ç§°å¯¹è±¡ä¸­é´ä»¶ãåå¸å¯¹è±¡æ¨¡åæ¯é¢åå¯¹è±¡æ¨¡åå¨åå¸å¼æç¯å¢ä¸çèªç¶æå¹¿ãé¢åå¯¹è±¡ä¸­é´ä»¶ç»åºç¨å±æä¾è¿éä¸åå½¢å¼çéä¿¡æå¡ï¼éè¿è¿äºæå¡ï¼ä¸å±åºç¨å¯¹äºå¡å¤çãåå¸å¼æ°æ®è®¿é®ï¼å¯¹è±¡ç®¡çç­å¤çæ´ç®åæè¡ãOMGç»ç»æ¯åå¸å¯¹è±¡ææ¯æ ååæ¹é¢çå½éç»ç»ï¼å®å¶å®åºäºCORBAç­æ åã </p>
<p>####ï¼5ï¼Webåºç¨æå¡å¨</p>
<p>Webåºç¨æå¡å¨æ¯Webæå¡å¨ååºç¨æå¡å¨ç¸ç»åçäº§ç©ãåºç¨æå¡å¨ä¸­é´ä»¶å¯ä»¥è¯´æ¯è½¯ä»¶çåºç¡è®¾æ½ï¼å©ç¨æä»¶åææ¯å°åºç¨è½¯ä»¶æ´åå°ä¸ä¸ªç¡®å®çååå·¥ä½ç¯å¢ä¸­ï¼å¹¶æä¾å¤ç§éä¿¡æºå¶ï¼äºå¡å¤çè½åï¼ååºç¨çå¼åç®¡çåè½ãç±äºç´æ¥æ¯æä¸å±æå¤å±åºç¨ç³»ç»çå¼åï¼åºç¨æå¡å¨åå°äºå¹¿å¤§ç¨æ·çæ¬¢è¿ï¼æ¯ç®åä¸­é´ä»¶å¸åºä¸ç«äºçç­ç¹ï¼J2EEæ¶ææ¯ç®ååºç¨æå¡å¨æ¹é¢çä¸»æµæ åã </p>
<p>####ï¼6ï¼å¶ä»</p>
<p>æ°çåºç¨éæ±ãæ°çææ¯åæ°ãæ°çåºç¨é¢åä¿æäºæ°çä¸­é´ä»¶äº§åçåºç°ãå¦ï¼ASAACå¨ç ç©¶æ åèªç©ºçµå­ä½ç³»ç»ææ¶æåºçéç¨ç³»ç»ç®¡çGSMï¼å±äºå¸åçåµå¥å¼èªçµç³»ç»çä¸­é´ä»¶ï¼äºèç½äºææ¯çåå±äºè®¡ç®ä¸­é´ä»¶ãç©æµç½çä¸­é´ä»¶ç­éçåºç¨å¸åºçéæ±åºè¿èçã </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/ORM%20%E6%A1%86%E6%9E%B6-%E4%B8%89%E5%B1%82%E5%BC%80%E5%8F%91%E6%9E%B6%E6%9E%84-%E4%B8%AD%E9%97%B4%E4%BB%B6/" data-id="ckmn1li07000fn8a8euau8pyg" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-æä»¤éæåº" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.856Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="æä»¤éæåº"><a href="#æä»¤éæåº" class="headerlink" title="æä»¤éæåº"></a>æä»¤éæåº</h1><p>ç®å½ï¼<br>1.æ°æ®ä¾èµæ§<br>2.ç¨åºé¡ºåºè§å<br>3.éæåºå¯¹å¤çº¿ç¨çå½±å<br>4.ç¼è¯å¨éæåº<br>5.æä»¤éå¹¶è¡çéæåº<br>6.åå­ç³»ç»çéæåº<br>7.memory barrier<br>8.JDK 1.7 åå­å±éå®ç°</p>
<h2 id="1-æ°æ®ä¾èµæ§"><a href="#1-æ°æ®ä¾èµæ§" class="headerlink" title="1.æ°æ®ä¾èµæ§"></a>1.æ°æ®ä¾èµæ§</h2><p>å¦æä¸¤ä¸ªæä½è®¿é®åä¸ä¸ªåéï¼ä¸è¿ä¸¤ä¸ªæä½ä¸­æä¸ä¸ªä¸ºåæä½ï¼æ­¤æ¶è¿ä¸¤ä¸ªæä½ä¹é´å°±å­å¨æ°æ®ä¾èµæ§ãæ°æ®ä¾èµåä¸åä¸ç§ç±»åï¼</p>
<p>| åç§° | ä»£ç ç¤ºä¾ | è¯´æ |<br>| ååè¯» | a = 1;b = a; | åä¸ä¸ªåéä¹åï¼åè¯»è¿ä¸ªä½ç½®ã |<br>| ååå | a = 1;a = 2; | åä¸ä¸ªåéä¹åï¼ååè¿ä¸ªåéã |<br>| è¯»åå | a = b;b = 1; | è¯»ä¸ä¸ªåéä¹åï¼ååè¿ä¸ªåéã |</p>
<p>ä¸é¢ä¸ç§æåµï¼åªè¦éæåºä¸¤ä¸ªæä½çæ§è¡é¡ºåºï¼ç¨åºçæ§è¡ç»æå°ä¼è¢«æ¹åã</p>
<p>åé¢æå°è¿ï¼ç¼è¯å¨åå¤çå¨å¯è½ä¼å¯¹æä½åéæåºãç¼è¯å¨åå¤çå¨å¨éæåºæ¶ï¼ä¼éµå®æ°æ®ä¾èµæ§ï¼ç¼è¯å¨åå¤çå¨ä¸ä¼æ¹åå­å¨æ°æ®ä¾èµå³ç³»çä¸¤ä¸ªæä½çæ§è¡é¡ºåºã</p>
<p>æ³¨æï¼è¿éæè¯´çæ°æ®ä¾èµæ§ä»éå¯¹åä¸ªå¤çå¨ä¸­æ§è¡çæä»¤åºåååä¸ªçº¿ç¨ä¸­æ§è¡çæä½ï¼ä¸åå¤çå¨ä¹é´åä¸åçº¿ç¨ä¹é´çæ°æ®ä¾èµæ§ä¸è¢«ç¼è¯å¨åå¤çå¨èèã</p>
<h4 id="as-if-serial-è¯­ä¹"><a href="#as-if-serial-è¯­ä¹" class="headerlink" title="as-if-serial è¯­ä¹"></a>as-if-serial è¯­ä¹</h4><p>as-if-serial è¯­ä¹çæææï¼ä¸ç®¡æä¹éæåºï¼ç¼è¯å¨åå¤çå¨ä¸ºäºæé«å¹¶è¡åº¦ï¼ï¼ï¼åçº¿ç¨ï¼ç¨åºçæ§è¡ç»æä¸è½è¢«æ¹åãç¼è¯å¨ï¼runtime åå¤çå¨é½å¿é¡»éµå® as-if-serial è¯­ä¹ã</p>
<p>ä¸ºäºéµå® as-if-serial è¯­ä¹ï¼ç¼è¯å¨åå¤çå¨ä¸ä¼å¯¹å­å¨æ°æ®ä¾èµå³ç³»çæä½åéæåºï¼å ä¸ºè¿ç§éæåºä¼æ¹åæ§è¡ç»æãä½æ¯ï¼å¦ææä½ä¹é´ä¸å­å¨æ°æ®ä¾èµå³ç³»ï¼è¿äºæä½å¯è½è¢«ç¼è¯å¨åå¤çå¨éæåºãä¸ºäºå·ä½è¯´æï¼è¯·çä¸é¢è®¡ç®åé¢ç§¯çä»£ç ç¤ºä¾ï¼</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> pi  = <span class="number">3.14</span>;    <span class="comment">//A</span></span><br><span class="line"><span class="keyword">double</span> r   = <span class="number">1.0</span>;     <span class="comment">//B</span></span><br><span class="line"><span class="keyword">double</span> area = pi * r * r; <span class="comment">//C  </span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä¸ä¸ªæä½çæ°æ®ä¾èµå³ç³»å¦ä¸å¾æç¤ºï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-bcfc7e3373884054..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/188/format/webp" alt="img"></p>
<p>image</p>
<p>å¦ä¸å¾æç¤ºï¼A å C ä¹é´å­å¨æ°æ®ä¾èµå³ç³»ï¼åæ¶ B å C ä¹é´ä¹å­å¨æ°æ®ä¾èµå³ç³»ãå æ­¤å¨æç»æ§è¡çæä»¤åºåä¸­ï¼C ä¸è½è¢«éæåºå° A å B çåé¢ï¼C æå° A å B çåé¢ï¼ç¨åºçç»æå°ä¼è¢«æ¹åï¼ãä½ A å B ä¹é´æ²¡ææ°æ®ä¾èµå³ç³»ï¼ç¼è¯å¨åå¤çå¨å¯ä»¥éæåº A å B ä¹é´çæ§è¡é¡ºåºãä¸å¾æ¯è¯¥ç¨åºçä¸¤ç§æ§è¡é¡ºåºï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-bec9a75cd5fd4ae8..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/387/format/webp" alt="img"></p>
<p>image</p>
<p>as-if-serial è¯­ä¹æåçº¿ç¨ç¨åºä¿æ¤äºèµ·æ¥ï¼éµå® as-if-serial è¯­ä¹çç¼è¯å¨ï¼runtime åå¤çå¨å±åä¸ºç¼ååçº¿ç¨ç¨åºçç¨åºååå»ºäºä¸ä¸ªå¹»è§ï¼åçº¿ç¨ç¨åºæ¯æç¨åºçé¡ºåºæ¥æ§è¡çãas-if-serial è¯­ä¹ä½¿åçº¿ç¨ç¨åºåæ éæå¿éæåºä¼å¹²æ°ä»ä»¬ï¼ä¹æ éæå¿åå­å¯è§æ§é®é¢ã</p>
<h2 id="2-ç¨åºé¡ºåºè§å"><a href="#2-ç¨åºé¡ºåºè§å" class="headerlink" title="2.ç¨åºé¡ºåºè§å"></a>2.ç¨åºé¡ºåºè§å</h2><p>æ ¹æ® happens- before çç¨åºé¡ºåºè§åï¼ä¸é¢è®¡ç®åçé¢ç§¯çç¤ºä¾ä»£ç å­å¨ä¸ä¸ª happens- before å³ç³»ï¼</p>
<ol>
<li>A happens- before Bï¼</li>
<li>B happens- before Cï¼</li>
<li>A happens- before Cï¼</li>
</ol>
<p>è¿éçç¬¬3ä¸ª happens- before å³ç³»ï¼æ¯æ ¹æ® happens- before çä¼ éæ§æ¨å¯¼åºæ¥çã</p>
<p>è¿é A happens- before Bï¼ä½å®éæ§è¡æ¶ B å´å¯ä»¥æå¨ A ä¹åæ§è¡ï¼çä¸é¢çéæåºåçæ§è¡é¡ºåºï¼ãå¨ç¬¬ä¸ç« æå°è¿ï¼å¦æ A happens- before Bï¼JMM å¹¶ä¸è¦æ± A ä¸å®è¦å¨ B ä¹åæ§è¡ãJMM ä»ä»è¦æ±åä¸ä¸ªæä½ï¼æ§è¡çç»æï¼å¯¹åä¸ä¸ªæä½å¯è§ï¼ä¸åä¸ä¸ªæä½æé¡ºåºæå¨ç¬¬äºä¸ªæä½ä¹åãè¿éæä½ A çæ§è¡ç»æä¸éè¦å¯¹æä½ B å¯è§ï¼èä¸éæåºæä½ A åæä½ B åçæ§è¡ç»æï¼ä¸æä½ A åæä½ B æ happens- before é¡ºåºæ§è¡çç»æä¸è´ãå¨è¿ç§æåµä¸ï¼JMM ä¼è®¤ä¸ºè¿ç§éæåºå¹¶ä¸éæ³ï¼not illegalï¼ï¼JMM åè®¸è¿ç§éæåºã</p>
<p>å¨è®¡ç®æºä¸­ï¼è½¯ä»¶ææ¯åç¡¬ä»¶ææ¯æä¸ä¸ªå±åçç®æ ï¼å¨ä¸æ¹åç¨åºæ§è¡ç»æçåæä¸ï¼å°½å¯è½çå¼åå¹¶è¡åº¦ãç¼è¯å¨åå¤çå¨éµä»è¿ä¸ç®æ ï¼ä» happens- before çå®ä¹æä»¬å¯ä»¥çåºï¼JMM åæ ·éµä»è¿ä¸ç®æ ã</p>
<h2 id="3-éæåºå¯¹å¤çº¿ç¨çå½±å"><a href="#3-éæåºå¯¹å¤çº¿ç¨çå½±å" class="headerlink" title="3.éæåºå¯¹å¤çº¿ç¨çå½±å"></a>3.éæåºå¯¹å¤çº¿ç¨çå½±å</h2><p>ç°å¨è®©æä»¬æ¥ççï¼éæåºæ¯å¦ä¼æ¹åå¤çº¿ç¨ç¨åºçæ§è¡ç»æãè¯·çä¸é¢çç¤ºä¾ä»£ç ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReorderExample</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    a = <span class="number">1</span>;                   <span class="comment">//1</span></span><br><span class="line">    flag = <span class="keyword">true</span>;             <span class="comment">//2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Public <span class="keyword">void</span> <span class="title">reader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;                <span class="comment">//3</span></span><br><span class="line">        <span class="keyword">int</span> i =  a * a;        <span class="comment">//4</span></span><br><span class="line">        â¦â¦</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>flag åéæ¯ä¸ªæ è®°ï¼ç¨æ¥æ è¯åé a æ¯å¦å·²è¢«åå¥ãè¿éåè®¾æä¸¤ä¸ªçº¿ç¨ A å Bï¼A é¦åæ§è¡writer() æ¹æ³ï¼éå B çº¿ç¨æ¥çæ§è¡ reader() æ¹æ³ãçº¿ç¨Bå¨æ§è¡æä½4æ¶ï¼è½å¦çå°çº¿ç¨ A å¨æä½1å¯¹å±äº«åé a çåå¥ï¼</p>
<p>ç­æ¡æ¯ï¼ä¸ä¸å®è½çå°ã</p>
<p>ç±äºæä½1åæä½2æ²¡ææ°æ®ä¾èµå³ç³»ï¼ç¼è¯å¨åå¤çå¨å¯ä»¥å¯¹è¿ä¸¤ä¸ªæä½éæåºï¼åæ ·ï¼æä½3åæä½4æ²¡ææ°æ®ä¾èµå³ç³»ï¼ç¼è¯å¨åå¤çå¨ä¹å¯ä»¥å¯¹è¿ä¸¤ä¸ªæä½éæåºãè®©æä»¬åæ¥ççï¼å½æä½1åæä½2éæåºæ¶ï¼å¯è½ä¼äº§çä»ä¹ææï¼è¯·çä¸é¢çç¨åºæ§è¡æ¶åºå¾ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-a02a7d96d2acf939..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/367/format/webp" alt="img"></p>
<p>image</p>
<p>å¦ä¸å¾æç¤ºï¼æä½1åæä½2åäºéæåºãç¨åºæ§è¡æ¶ï¼çº¿ç¨Aé¦ååæ è®°åé flagï¼éåçº¿ç¨ B è¯»è¿ä¸ªåéãç±äºæ¡ä»¶å¤æ­ä¸ºçï¼çº¿ç¨ B å°è¯»ååéaãæ­¤æ¶ï¼åé a è¿æ ¹æ¬æ²¡æè¢«çº¿ç¨ A åå¥ï¼å¨è¿éå¤çº¿ç¨ç¨åºçè¯­ä¹è¢«éæåºç ´åäºï¼</p>
<p>â»æ³¨ï¼æ¬æç»ä¸ç¨çº¢è²çèç®­çº¿è¡¨ç¤ºéè¯¯çè¯»æä½ï¼ç¨ç»¿è²çèç®­çº¿è¡¨ç¤ºæ­£ç¡®çè¯»æä½ã</p>
<p>ä¸é¢åè®©æä»¬ççï¼å½æä½3åæä½4éæåºæ¶ä¼äº§çä»ä¹ææï¼åå©è¿ä¸ªéæåºï¼å¯ä»¥é¡ºä¾¿è¯´ææ§å¶ä¾èµæ§ï¼ãä¸é¢æ¯æä½3åæä½4éæåºåï¼ç¨åºçæ§è¡æ¶åºå¾ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-8923bdc498c7bf46..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/456/format/webp" alt="img"></p>
<p>image</p>
<p>å¨ç¨åºä¸­ï¼æä½3åæä½4å­å¨æ§å¶ä¾èµå³ç³»ãå½ä»£ç ä¸­å­å¨æ§å¶ä¾èµæ§æ¶ï¼ä¼å½±åæä»¤åºåæ§è¡çå¹¶è¡åº¦ãä¸ºæ­¤ï¼ç¼è¯å¨åå¤çå¨ä¼éç¨çæµï¼Speculationï¼æ§è¡æ¥åææ§å¶ç¸å³æ§å¯¹å¹¶è¡åº¦çå½±åãä»¥å¤çå¨ççæµæ§è¡ä¸ºä¾ï¼æ§è¡çº¿ç¨ B çå¤çå¨å¯ä»¥æåè¯»åå¹¶è®¡ç® a*aï¼ç¶åæè®¡ç®ç»æä¸´æ¶ä¿å­å°ä¸ä¸ªåä¸ºéæåºç¼å²ï¼reorder buffer ROBï¼çç¡¬ä»¶ç¼å­ä¸­ãå½æ¥ä¸æ¥æä½3çæ¡ä»¶å¤æ­ä¸ºçæ¶ï¼å°±æè¯¥è®¡ç®ç»æåå¥åéiä¸­ã</p>
<p>ä»å¾ä¸­æä»¬å¯ä»¥çåºï¼çæµæ§è¡å®è´¨ä¸å¯¹æä½3å4åäºéæåºãéæåºå¨è¿éç ´åäºå¤çº¿ç¨ç¨åºçè¯­ä¹ï¼</p>
<p>å¨åçº¿ç¨ç¨åºä¸­ï¼å¯¹å­å¨æ§å¶ä¾èµçæä½éæåºï¼ä¸ä¼æ¹åæ§è¡ç»æï¼è¿ä¹æ¯ as-if-serial è¯­ä¹åè®¸å¯¹å­å¨æ§å¶ä¾èµçæä½åéæåºçåå ï¼ï¼ä½å¨å¤çº¿ç¨ç¨åºä¸­ï¼å¯¹å­å¨æ§å¶ä¾èµçæä½éæåºï¼å¯è½ä¼æ¹åç¨åºçæ§è¡ç»æã</p>
<h2 id="4-ç¼è¯å¨æä»¤éæ"><a href="#4-ç¼è¯å¨æä»¤éæ" class="headerlink" title="4.ç¼è¯å¨æä»¤éæ"></a>4.ç¼è¯å¨æä»¤éæ</h2><p>ä¸é¢æä»¬ç®åçä¸ä¸ªç¼è¯å¨éæçä¾å­ï¼</p>
<p>çº¿ç¨ 1 çº¿ç¨ 2<br>1ï¼ x2 = a ; 3: x1 = b ;<br>2: b = 1; 4: a = 2 ;</p>
<p>ä¸¤ä¸ªçº¿ç¨åæ¶æ§è¡ï¼åå«æ1ã2ã3ã4åæ®µæ§è¡ä»£ç ï¼å¶ä¸­1ã2å±äºçº¿ç¨1 ï¼ 3ã4å±äºçº¿ç¨2 ï¼ä»ç¨åºçæ§è¡é¡ºåºä¸çï¼ä¼¼ä¹ä¸å¤ªå¯è½åºç°x1 = 1 åx2 = 2 çæåµï¼ä½å®éä¸è¿ç§æåµæ¯æå¯è½åç°çï¼å ä¸ºå¦æç¼è¯å¨å¯¹è¿æ®µç¨åºä»£ç æ§è¡éæä¼ååï¼å¯è½åºç°ä¸åæåµ</p>
<p>çº¿ç¨ 1 çº¿ç¨ 2<br>2: b = 1; 4: a = 2 ;<br>1ï¼x2 = a ; 3: x1 = b ;</p>
<p>è¿ç§æ§è¡é¡ºåºä¸å°±æå¯è½åºç°x1 = 1 åx2 = 2 çæåµï¼è¿ä¹å°±è¯´æå¨å¤çº¿ç¨ç¯å¢ä¸ï¼ç±äºç¼è¯å¨ä¼åéæçå­å¨ï¼ä¸¤ä¸ªçº¿ç¨ä¸­ä½¿ç¨çåéè½å¦ä¿è¯ä¸è´æ§æ¯æ æ³ç¡®å®çã</p>
<h2 id="5-æä»¤éå¹¶è¡çéæåº"><a href="#5-æä»¤éå¹¶è¡çéæåº" class="headerlink" title="5.æä»¤éå¹¶è¡çéæåº"></a>5.æä»¤éå¹¶è¡çéæåº</h2><p>æä»¤éå¹¶è¡çéæåºæ¯å¯¹CPUçæ§è½ä¼åï¼ä»æä»¤çæ§è¡è§åº¦æ¥è¯´ä¸æ¡æä»¤å¯ä»¥åä¸ºå¤ä¸ªæ­¥éª¤å®æï¼å¦ä¸:</p>
<ul>
<li>åæ IF</li>
<li>è¯ç ååå¯å­å¨æä½æ° ID</li>
<li>æ§è¡æèææå°åè®¡ç® EX</li>
<li>å­å¨å¨è®¿é® MEM</li>
<li>åå WB</li>
</ul>
<p>CPUå¨å·¥ä½æ¶ï¼éè¦å°ä¸è¿°æä»¤åä¸ºå¤ä¸ªæ­¥éª¤ä¾æ¬¡æ§è¡(æ³¨æç¡¬ä»¶ä¸åæå¯è½ä¸ä¸æ ·),ç±äºæ¯ä¸ä¸ªæ­¥ä¼ä½¿ç¨å°ä¸åçç¡¬ä»¶æä½ï¼æ¯å¦åææ¶ä¼åªæPCå¯å­å¨åå­å¨å¨ï¼è¯ç æ¶ä¼æ§è¡å°æä»¤å¯å­å¨ç»ï¼æ§è¡æ¶ä¼æ§è¡ALU(ç®æ¯é»è¾åå)ãååæ¶ä½¿ç¨å°å¯å­å¨ç»ãä¸ºäºæé«ç¡¬ä»¶å©ç¨çï¼CPUæä»¤æ¯ææµæ°´çº¿ææ¯æ¥æ§è¡çï¼å¦ä¸ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-be37ed816609d345?imageMogr2/auto-orient/strip%7CimageView2/2/w/543/format/webp" alt="img"></p>
<p>image</p>
<p>ä»å¾ä¸­å¯ä»¥çåºå½æä»¤1è¿æªæ§è¡å®ææ¶ï¼ç¬¬2æ¡æä»¤ä¾¿å©ç¨ç©ºé²çç¡¬ä»¶å¼å§æ§è¡ï¼è¿æ ·åæ¯æå¥½å¤çï¼å¦ææ¯ä¸ªæ­¥éª¤è±è´¹1msï¼é£ä¹å¦æç¬¬2æ¡æä»¤éè¦ç­å¾ç¬¬1æ¡æä»¤æ§è¡å®æååæ§è¡çè¯ï¼åéè¦ç­å¾5msï¼ä½å¦æä½¿ç¨æµæ°´çº¿ææ¯çè¯ï¼æä»¤2åªéç­å¾1mså°±å¯ä»¥å¼å§æ§è¡äºï¼è¿æ ·å°±è½å¤§å¤§æåCPUçæ§è¡æ§è½ãè½ç¶æµæ°´çº¿ææ¯å¯ä»¥å¤§å¤§æåCPUçæ§è½ï¼ä½ä¸å¹¸çæ¯ä¸æ¦åºç°æµæ°´ä¸­æ­ï¼ææç¡¬ä»¶è®¾å¤å°ä¼è¿å¥ä¸è½®åé¡¿æï¼å½åæ¬¡å¼¥è¡¥ä¸­æ­ç¹å¯è½éè¦å ä¸ªå¨æï¼è¿æ ·æ§è½æå¤±ä¹ä¼å¾å¤§ï¼å°±å¥½æ¯å·¥åç»è£ææºçæµæ°´çº¿ï¼ä¸æ¦æä¸ªé¶ä»¶ç»è£ä¸­æ­ï¼é£ä¹è¯¥é¶ä»¶å¾åçå·¥äººé½æå¯è½è¿å¥ä¸è½®æèå è½®ç­å¾ç»è£é¶ä»¶çè¿ç¨ãå æ­¤æä»¬éè¦å°½éé»æ­¢æä»¤ä¸­æ­çæåµï¼æä»¤éæå°±æ¯å¶ä¸­ä¸ç§ä¼åä¸­æ­çææ®µï¼æä»¬éè¿ä¸ä¸ªä¾å­æ¥éææä»¤éææ¯å¦ä½é»æ­¢æµæ°´çº¿ææ¯ä¸­æ­ç</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; b + c ;</span><br><span class="line">d &#x3D; e + f ;</span><br></pre></td></tr></table></figure>

<p>ä¸é¢éè¿æ±ç¼æä»¤å±ç¤ºäºä¸è¿°ä»£ç å¨CPUæ§è¡çå¤çè¿ç¨</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-968efb02463da660?imageMogr2/auto-orient/strip%7CimageView2/2/w/817/format/webp" alt="img"></p>
<p>image</p>
<ul>
<li>LWæä»¤ è¡¨ç¤º loadï¼å¶ä¸­LW R1,bè¡¨ç¤ºæbçå¼å è½½å°å¯å­å¨R1ä¸­</li>
<li>LW R2,c è¡¨ç¤ºæcçå¼å è½½å°å¯å­å¨R2ä¸­</li>
<li>ADD æä»¤è¡¨ç¤ºå æ³ï¼æR1 ãR2çå¼ç¸å ï¼å¹¶å­å¥R3å¯å­å¨ä¸­ã</li>
<li>SW è¡¨ç¤º store å³å° R3å¯å­å¨çå¼ä¿æå°åéaä¸­</li>
<li>LW R4,e è¡¨ç¤ºæeçå¼å è½½å°å¯å­å¨R4ä¸­</li>
<li>LW R5,f è¡¨ç¤ºæfçå¼å è½½å°å¯å­å¨R5ä¸­</li>
<li>SUB æä»¤è¡¨ç¤ºåæ³ï¼æR4 ãR5çå¼ç¸åï¼å¹¶å­å¥R6å¯å­å¨ä¸­ã</li>
<li>SW d,R6 è¡¨ç¤ºå°R6å¯å­å¨çå¼ä¿æå°åédä¸­</li>
</ul>
<p>ä¸è¿°ä¾¿æ¯æ±ç¼æä»¤çæ§è¡è¿ç¨ï¼å¨æäºæä»¤ä¸å­å¨Xçæ å¿ï¼Xä»£è¡¨ä¸­æ­çå«ä¹ï¼ä¹å°±æ¯åªè¦æXçå°æ¹å°±ä¼å¯¼è´æä»¤æµæ°´çº¿ææ¯åé¡¿ï¼åæ¶ä¹ä¼å½±ååç»­æä»¤çæ§è¡ï¼å¯è½éè¦ç»è¿1ä¸ªæå ä¸ªæä»¤å¨ææå¯è½æ¢å¤æ­£å¸¸ï¼é£ä¸ºä»ä¹åé¡¿å¢ï¼è¿æ¯å ä¸ºé¨åæ°æ®è¿æ²¡åå¤å¥½ï¼å¦æ§è¡ADDæä»¤æ¶ï¼éè¦ä½¿ç¨å°åé¢æä»¤çæ°æ®R1ï¼R2ï¼èæ­¤æ¶R2çMEMæä½æ²¡æå®æï¼å³æªæ·è´å°å­å¨å¨ä¸­ï¼è¿æ ·å æ³è®¡ç®å°±æ æ³è¿è¡ï¼å¿é¡»ç­å°MEMæä½å®æåæè½æ§è¡ï¼ä¹å°±å æ­¤èåé¡¿äºï¼å¶ä»æä»¤ä¹æ¯ç±»ä¼¼çæåµãåé¢éè¿°è¿ï¼åé¡¿ä¼é æCPUæ§è½ä¸éï¼å æ­¤æä»¬åºè¯¥æ³åæ³æ¶é¤è¿äºåé¡¿ï¼è¿æ¶å°±éè¦ä½¿ç¨å°æä»¤éæäºï¼å¦ä¸å¾ï¼æ¢ç¶ADDæä»¤éè¦ç­å¾ï¼é£æä»¬å°±å©ç¨ç­å¾çæ¶é´åäºå«çäºæï¼å¦æ<code>LW R4,e</code> å <code>LW R5,f</code> ç§»å¨å°åé¢æ§è¡ï¼æ¯ç«<code>LW R4,e</code> å <code>LW R5,f</code>æ§è¡å¹¶æ²¡ææ°æ®ä¾èµå³ç³»ï¼å¯¹ä»ä»¬ææ°æ®ä¾èµå³ç³»ç<code>SUB R6,R5,R4</code>æä»¤å¨R4,R5å è½½å®æåææ§è¡çï¼æ²¡æå½±åï¼è¿ç¨å¦ä¸ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-5437272b8a7c272b?imageMogr2/auto-orient/strip%7CimageView2/2/w/934/format/webp" alt="img"></p>
<p>image</p>
<p>æ­£å¦ä¸å¾æç¤ºï¼ææçåé¡¿é½å®ç¾æ¶é¤äºï¼æä»¤æµæ°´çº¿ä¹æ éä¸­æ­äºï¼è¿æ ·CPUçæ§è½ä¹è½å¸¦æ¥å¾å¥½çæåï¼è¿å°±æ¯å¤çå¨æä»¤éæçä½ç¨ã</p>
<h2 id="6-åå­ç³»ç»çéæåº"><a href="#6-åå­ç³»ç»çéæåº" class="headerlink" title="6.åå­ç³»ç»çéæåº"></a>6.åå­ç³»ç»çéæåº</h2><p><strong>åå­ä½ç³»</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-4bf35e9b441a38e7..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/640/format/webp" alt="img"></p>
<p>image</p>
<p>å¾1.å¯¹äº2012 Sandy Bridgeæ ¸å¿æ¥è¯´ï¼åå­æ¨¡åå¯ä»¥å¤§è´æç§å¦ä¸è¿è¡åè§£ï¼</p>
<p><strong>1.å¯å­å¨ï¼</strong>å¨æ¯ä¸ªæ ¸å¿ä¸ï¼æ160ä¸ªç¨äºæ´æ°å144ä¸ªç¨äºæµ®ç¹çå¯å­å¨ååãè®¿é®è¿äºå¯å­å¨åªéè¦ä¸ä¸ªæ¶éå¨æï¼è¿ææäºå¯¹æ§è¡æ ¸å¿æ¥è¯´æå¿«çåå­ãç¼è¯å¨ä¼å°æ¬å°åéåå½æ°åæ°åéå°è¿äºå¯å­å¨ä¸ãå½ä½¿ç¨è¶çº¿ç¨ææ¯ï¼ <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Hyper-threading">hyperthreading</a> ï¼æ¶ï¼è¿äºå¯å­å¨å¯ä»¥å¨è¶çº¿ç¨ååä¸å±äº«ã</p>
<p><strong>2.åå­æåºç¼å²ï¼Memory Ordering Buffers (MOB)*<em>*</em> ï¼ï¼</strong>MOBç±ä¸ä¸ª64é¿åº¦çloadç¼å²å36é¿åº¦çstoreç¼å²ç»æãè¿äºç¼å²ç¨äºè®°å½ç­å¾ç¼å­å­ç³»ç»æ¶æ­£å¨æ§è¡çæä½ãstoreç¼å²æ¯ä¸ä¸ªå®å¨çç¸å³æ§éåï¼å¯ä»¥ç¨äºæç´¢å·²ç»å­å¨storeæä½ï¼è¿äºstoreæä½å¨ç­å¾L1ç¼å­çæ¶åè¢«éååãå¨æ°æ®ä¸ç¼å­å­ç³»ç»ä¼ è¾æ¶ï¼ ç¼å²å¯ä»¥è®©å¤çå¨å¼æ­¥è¿è½¬ãå½å¤çå¨å¼æ­¥è¯»æèå¼æ­¥åçæ¶åï¼ç»æå¯ä»¥ä¹±åºè¿åãä¸ºäºä½¿ä¹ä¸å·²åå¸çåå­æ¨¡åï¼ <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Memory_model_(programming)">memory model</a> ï¼ä¸è´ï¼MOBç¨äºæ¶é¤loadåstoreçé¡ºåºã</p>
<p><strong>3.Level 1 ç¼å­ï¼</strong>L1æ¯ä¸ä¸ªæ¬å°æ ¸å¿åçç¼å­ï¼è¢«åæç¬ç«ç32Kæ°æ®ç¼å­å32Kæä»¤ç¼å­ãè®¿é®éè¦3ä¸ªæ¶éå¨æï¼å¹¶ä¸å½æä»¤è¢«æ ¸å¿æµæ°´åæ¶ï¼ å¦ææ°æ®å·²ç»å¨L1ç¼å­ä¸­çè¯ï¼è®¿é®æ¶é´å¯ä»¥å¿½ç¥ã</p>
<p><strong>4.L2ç¼å­ï¼</strong>L2ç¼å­æ¯ä¸ä¸ªæ¬å°æ ¸å¿åçç¼å­ï¼è¢«è®¾è®¡ä¸ºL1ç¼å­ä¸å±äº«çL3ç¼å­ä¹é´çç¼å²ãL2ç¼å­å¤§å°ä¸º256Kï¼ä¸»è¦ä½ç¨æ¯ä½ä¸ºL1åL3ä¹é´çé«æåå­è®¿é®éåãL2ç¼å­åæ¶åå«æ°æ®åæä»¤ãL2ç¼å­çå»¶è¿ä¸º12ä¸ªæ¶éå¨æã</p>
<p><strong>5</strong>.<strong>L3ç¼å­ï¼</strong> å¨åææ§½çæææ ¸å¿é½å±äº«L3ç¼å­ãL3ç¼å­è¢«åä¸ºæ°ä¸ª2MBçæ®µï¼æ¯ä¸ä¸ªæ®µé½è¿æ¥å°æ§½ä¸çç¯å½¢ç½ç»ãæ¯ä¸ä¸ªæ ¸å¿ä¹è¿æ¥å°è¿ä¸ªç¯å½¢ç½ç»ä¸ãå°åéè¿hashçæ¹å¼æ å°å°æ®µä¸ä»¥è¾¾å°æ´å¤§çååéãæ ¹æ®ç¼å­å¤§å°ï¼å»¶è¿æå¯è½é«è¾¾38ä¸ªæ¶éå¨æãå¨ç¯ä¸æ¯å¢å ä¸ä¸ªèç¹å°æ¶èä¸ä¸ªé¢å¤çæ¶éå¨æãç¼å­å¤§å°æ ¹æ®æ®µçæ°éæå¤§å¯ä»¥è¾¾å°20MBãL3ç¼å­åæ¬äºå¨åä¸ä¸ªæ§½ä¸çææL1åL2ç¼å­ä¸­çæ°æ®ãè¿ç§è®¾è®¡æ¶èäºç©ºé´ï¼ä½æ¯ä½¿L3ç¼å­å¯ä»¥æ¦æªå¯¹L1åL2ç¼å­çè¯·æ±ï¼åè½»äºåæ ¸å¿ç§æçL1åL2ç¼å­çè´æã</p>
<p><strong>6.ä¸»åå­</strong>ï¼å¨ç¼å­å®å¨æ²¡å½ä¸­çæåµä¸ï¼DRAMééå°æ¯ä¸ªæ§½çå»¶è¿å¹³åä¸º65nsãå·ä½å»¶è¿å¤å°åå³äºå¾å¤å ç´ ï¼æ¯å¦ï¼ä¸ä¸æ¬¡å¯¹åä¸ç¼å­ è¡ä¸­æ°æ®çè®¿é®å°æå¤§éä½å»¶è¿ï¼èå½éååææååå­å·æ°å¨æå²çªæ¶å°æ¾èå¢å å»¶è¿ãæ¯ä¸ªæ§½ä½¿ç¨4ä¸ªåå­ééèåèµ·æ¥å¢å ååéï¼å¹¶éè¿å¨ç¬ç«åå­ééä¸æµæ°´çº¿åï¼ <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Pipelining">pipelining</a> ï¼å°éèè¿ç§å»¶è¿ã</p>
<p>*<em>7. *</em>**NUMAï¼**å¨ä¸ä¸ªå¤ææ§½çæå¡å¨ä¸ï¼ä¼ä½¿ç¨éä¸è´æ§åå­è®¿é®ï¼ <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Non-Uniform_Memory_Access">non-uniform memory access</a>ï¼ãæè°çéä¸è´æ§æ¯æï¼éè¦è®¿é®çåå­å¯è½å¨å¦ä¸ä¸ªææ§½ä¸ï¼å¹¶ä¸éè¿ <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/QPI">QPI</a> æ»çº¿è®¿é®éè¦é¢å¤è±è´¹40nsã Sandy Bridgeå¯¹äºä»¥å¾çå¼å®¹ç³»ç»æ¥è¯´ï¼å¨2ææ§½ç³»ç»ä¸æ¯ä¸ä¸ªå·¨å¤§çè¿æ­¥ãå¨ Sandy Bridgeä¸ï¼QPIæ»çº¿çè½åä»6.4GT/sæåå°8.0GT/sï¼å¹¶ä¸å¯ä»¥ä½¿ç¨ä¸¤æ¡çº¿è·¯ï¼æ¶é¤äºä»¥åç³»ç»çç¶é¢ãå¯¹äº Nehalem and Westmere æ¥è¯´ï¼QPIåªè½ä½¿ç¨åå­æ§å¶å¨ä¸ºä¸ä¸ªåç¬ææ§½åéçå¸¦å®½ä¸­ç40%ï¼è¿ä½¿è®¿é®è¿ç¨åå­æä¸ºä¸ä¸ªç¶é¢ãå¦å¤ï¼ç°å¨QPIé¾æ¥å¯ä»¥ä½¿ç¨é¢è¯»åè¯·æ±ï¼èåä¸ä»£ç³»ç»ä¸è¡ã</p>
<p><strong>å³èåº¦ï¼Associativity Levelsï¼</strong></p>
<p>ç¼å­æ¯ä¸ä¸ªä¾èµäºhashè¡¨çé«æç¡¬ä»¶ãä½¿ç¨hashå½æ°å¸¸å¸¸åªæ¯å°å°åä¸­ä½ä½bit è¿è¡æ å° ï¼ä»¥å®ç°ç¼å­ç´¢å¼ãhashè¡¨éè¦æè§£å³å¯¹äºåä¸ä½ç½®å²çªçæºå¶ã å³èåº¦å°±æ¯hashè¡¨ä¸­æ§½ï¼slotï¼çæ°éï¼ä¹è¢«ç§°ä¸ºç»ï¼waysï¼åéåï¼setsï¼ï¼å¯ä»¥ç¨æ¥å­å¨ä¸ä¸ªåå­å°åçhashçæ¬ãå³èåº¦çå¤å°éè¦å¨å­å¨æ°æ®çå®¹éï¼èçµéåæ¥è¯¢æ¶é´ä¹é´å¯»æ¾å¹³è¡¡ãï¼æ ¡å¯¹æ³¨ï¼å³èåº¦è¶é«ï¼æ§½çæ°éè¶å¤ï¼hashå²çªè¶å°ï¼æ¥è¯¢éåº¦è¶å¿«ï¼</p>
<p>å¯¹äºSandy Bridgeï¼L1åL2æ¯8è·¯ç»ç¸è¿ ï¼L3æ¯12è·¯ç»ç¸è¿ ãï¼For Sandy Bridge the L1D and L2 are 8-way associative, the L3 is 12-way associative.ï¼</p>
<p><strong>ç¼å­ä¸è´æ§</strong></p>
<p>ç±äºä¸äºç¼å­å¨åæ ¸æ¬å°ï¼æä»¬éè¦ä¸äºæ¹æ³ä¿è¯ä¸è´æ§ï¼ä½¿æææ ¸å¿çåå­è§å¾ä¸è´ãå¯¹äºä¸»æµç³»ç»æ¥è¯´ï¼åå­å­ç³»ç»éè¦èèâçå®çæ¥æºï¼source of truthï¼âãå¦ææ°æ®åªä»ç¼å­ä¸­æ¥ï¼é£ä¹å®æ°¸è¿ä¸ä¼è¿æï¼å½æ°æ®åæ¶å¨ç¼å­åä¸»åå­ä¸­å­å¨æ¶ï¼ç¼å­ä¸­å­çæ¯ä¸»æ·è´ï¼master copyï¼ãè¿ç§åå­ç®¡çè¢«ç§°ä¸ºå-åï¼<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://www.webopedia.com/TERM/W/write_back_cache.html">write-back</a>ï¼ï¼å¨æ­¤æ¹å¼ä¸ï¼å½æ°çç¼å­è¡å ç¨æ§è¡ï¼å¯¼è´æ§è¡è¢«é©±éæ¶ï¼ç¼å­æ°æ®åªä¼è¢«ååä¸»åå­ä¸­ãx86æ¶æçæ¯ä¸ªç¼å­åçå¤§å°ä¸º64 bytesï¼ç§°ä¸ºç¼å­è¡ï¼ <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/CPU_cache%23Cache_Entries">cache-line</a>ï¼ãå¶å®ç§ç±»çå¤çå¨çç¼å­è¡å¤§å°å¯è½ä¸åãæ´å¤§çç¼å­è¡å®¹ééä½å»¶è¿ï¼ä½æ¯éè¦æ´å¤§çå¸¦å®½<em>ï¼**æ ¡å¯¹</em>æ³¨ï¼æ°æ®æ»çº¿å¸¦å®½ï¼ã</p>
<p>å¯¹äºä¸åææ§½çCPUï¼L1åL2çæ°æ®å¹¶ä¸å±äº«ï¼ä¸è¬éè¿MESIåè®®ä¿è¯Cacheçä¸è´æ§ï¼ä½éè¦ä»åºä»£ä»·ã</p>
<p>å¨MESIåè®®ä¸­ï¼æ¯ä¸ªCache lineæ4ç§ç¶æï¼åå«æ¯ï¼</p>
<p>1ãM(Modified)è¿è¡æ°æ®ææï¼ä½æ¯è¢«ä¿®æ¹äºï¼ååå­ä¸­çæ°æ®ä¸ä¸è´ï¼æ°æ®åªå­å¨äºæ¬Cacheä¸­</p>
<p>2ãE(Exclusive)è¿è¡æ°æ®ææï¼ååå­ä¸­çæ°æ®ä¸è´ï¼æ°æ®åªå­å¨äºæ¬Cacheä¸­</p>
<p>3ãS(Shared)è¿è¡æ°æ®ææï¼ååå­ä¸­çæ°æ®ä¸è´ï¼æ°æ®åå¸å¨å¾å¤Cacheä¸­</p>
<p>4ãI(Invalid)è¿è¡æ°æ®æ æ</p>
<p>æ¯ä¸ªCoreçCacheæ§å¶å¨ä¸ä»ç¥éèªå·±çè¯»åæä½ï¼ä¹çå¬å¶å®Cacheçè¯»åæä½ï¼åå¦æ4ä¸ªCoreï¼1ãCore1ä»åå­ä¸­å è½½äºåéXï¼å¼ä¸º10ï¼è¿æ¶Core1ä¸­ç¼å­åéXçcache lineçç¶ææ¯Eï¼2ãCore2ä¹ä»åå­ä¸­å è½½äºåéXï¼è¿æ¶Core1åCore2ç¼å­åéXçcache lineç¶æè½¬åæSï¼3ãCore3ä¹ä»åå­ä¸­å è½½äºåéXï¼ç¶åæXè®¾ç½®æäº20ï¼è¿æ¶Core3ä¸­ç¼å­åéXçcache lineç¶æè½¬åæMï¼å¶å®Coreå¯¹åºçcache lineåæIï¼æ æï¼</p>
<p>å½ç¶äºï¼ä¸åçå¤çå¨åé¨ç»èä¹æ¯ä¸ä¸æ ·çï¼æ¯å¦Intelçcore i7å¤çå¨ä½¿ç¨ä»MESIä¸­æ¼ååºçMESIFåè®®ï¼F(Forward)ä»Shareä¸­æ¼åèæ¥ï¼ä¸ä¸ªcache lineå¦ææ¯Fç¶æï¼å¯ä»¥ææ°æ®ç´æ¥ä¼ ç»å¶å®åæ ¸ï¼è¿éå°±ä¸çº ç»äºã</p>
<p>CPUå¨cache lineç¶æçè½¬åæé´æ¯é»å¡çï¼ç»è¿é¿æ¶é´çä¼åï¼å¨å¯å­å¨åL1ç¼å­ä¹é´æ·»å äºLoadBufferãStoreBufferæ¥éä½é»å¡æ¶é´ï¼LoadBufferãStoreBufferï¼åç§°æåºç¼å²(Memoryordering Buffers (MOB))ï¼Loadç¼å²64é¿åº¦ï¼storeç¼å²36é¿åº¦ï¼Bufferä¸L1è¿è¡æ°æ®ä¼ è¾æ¶ï¼CPUæ é¡»ç­å¾ã</p>
<p>1ãCPUæ§è¡loadè¯»æ°æ®æ¶ï¼æè¯»è¯·æ±æ¾å°LoadBufferï¼è¿æ ·å°±ä¸ç¨ç­å¾å¶å®CPUååºï¼åè¿è¡ä¸é¢æä½ï¼ç¨ååå¤çè¿ä¸ªè¯»è¯·æ±çç»æã2ãCPUæ§è¡storeåæ°æ®æ¶ï¼ææ°æ®åå°StoreBufferä¸­ï¼å¾å°æä¸ªéåçæ¶é´ç¹ï¼æStoreBufferçæ°æ®å·å°ä¸»å­ä¸­ã</p>
<p>å ä¸ºStoreBufferçå­å¨ï¼CPUå¨åæ°æ®æ¶ï¼çå®æ°æ®å¹¶ä¸ä¼ç«å³è¡¨ç°å°åå­ä¸­ï¼æä»¥å¯¹äºå¶å®CPUæ¯ä¸å¯è§çï¼åæ ·çéçï¼LoadBufferä¸­çè¯·æ±ä¹æ æ³æ¿å°å¶å®CPUè®¾ç½®çææ°æ°æ®ï¼</p>
<p>ç±äºStoreBufferåLoadBufferæ¯å¼æ­¥æ§è¡çï¼æä»¥å¨å¤é¢çæ¥ï¼åååè¯»ï¼è¿æ¯åè¯»ååï¼æ²¡æä¸¥æ ¼çåºå®é¡ºåºã</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-34f6833a2aecf7e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>TBD1.png</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-c3f236a86305e485.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>TBD2.png</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-71c39fa7338093a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>TBD3.png</p>
<p>MESIåè®®ä¸­æä¸¤ä¸ªè¡ä¸ºæçä¼æ¯è¾ä½ï¼</p>
<ol>
<li>å½cache lineç¶æä¸ºInvalidæ¶ï¼éè¦åå¥æ°æ®ã</li>
<li>æcache lineçç¶æåä¸ºinvalid</li>
</ol>
<p>CPUéè¿store bufferåinvalid queue(ç¨æ¥å®ç°LoadBuffer)æ¥éä½å»¶æ¶ã<br>å½å¨invalidç¶æè¿è¡åå¥æ¶ï¼é¦åä¼ç»å¶å®CPUæ ¸åéinvalidæ¶æ¯ï¼ç¶åæå½ååå¥çæ°æ®åå¥å°store bufferä¸­ãç¶åå¨æä¸ªæ¶å»å¨çæ­£çåå¥å°cache lineä¸­ãç±äºä¸æ¯é©¬ä¸åå¥å°cache lineä¸­ï¼æä»¥å½åæ ¸å¦æè¦è¯»cache lineä¸­çæ°æ®ï¼éè¦åæ«æstore bufferï¼åæ¶å¶å®CPUæ ¸æ¯çä¸å°å½åæ ¸store bufferä¸­çæ°æ®çãé¤éstore bufferä¸­çæ°æ®è¢«å·å°cacheä¸­ã<br>å¯¹äºinvalid queueï¼å½æ¶å°invalidæ¶æ¯æ¶ï¼cache lineä¸ä¼é©¬ä¸åæinvalidç¶æï¼èæ¯ææ¶æ¯åå¥invalid queueä¸­ãåstore bufferä¸åçæ¯å½åæ ¸æ¯æ æ³æ«æinvalid queueçã<br>ä¸ºäºä¿è¯æ°æ®çä¸è´æ§ï¼è¿å°±éè¦memory barrieräºãstore barrierä¼æstore bufferä¸­çæ°æ®å·å°cacheä¸­ï¼read barrierä¼æ§è¡invalid queueä¸­çæ¶æ¯ã</p>
<blockquote>
<p><strong>æ³¨æ</strong><br>è¦ä¿è¯æ°æ®çä¸è´æ§ï¼ä»ä»æMESIåè®®è¿ä¸å¤ï¼éå¸¸è¿éè¦memory barrierçéåã</p>
</blockquote>
<h2 id="7-memory-barrier"><a href="#7-memory-barrier" class="headerlink" title="7.memory barrier"></a>7.memory barrier</h2><p>memory barrierçä½ç¨æä¸¤ä¸ª</p>
<ul>
<li>ä¿è¯æ°æ®çå¯è§æ§<br>æä»¬ç¥éï¼åå­ä¸­çæ°æ®é¤äºå¨åå­ä¸­çå¯æ¬ï¼è¿æå¯è½å¨åä¸ªæ ¸çCPUä¸­ï¼å½æä¸ªæ ¸ä¿®æ¹äºå¯¹åºcacheä¸­çæ°æ®åï¼è¿æ¶å¶å®æ ¸ä¸­å¯¹åºåå­å°åçæ°æ®è¿æä¸»å­ä¸­çæ°æ®å°±ä¸æ¯ææ°çäºï¼å¶å®æ ¸ä¸ºäºè½å¤è¯»åå°ææ°çæ°æ®ï¼éè¦æ§è¡memory barrieræä»¤ï¼æstore bufferä¸­çä¿®æ¹åå°ä¸»å­ä¸­ã</li>
<li>é²æ­¢æä»¤ä¹é´çéæåº<br>åé¢è®²å°ä¸æ¡æä»¤çæ§è¡ä¼åä¸ºå ä¸ªæ­¥éª¤ï¼ä¹å°±æ¯pipelineï¼ä¸ºäºå¾å°æ´é«çæ§è½ï¼ç¼è¯å¨æèå¤çå¨æå¯è½ä¼æ¹åæä»¤çæ§è¡é¡ºåºï¼ä»¥æ­¤æ¥æé«æä»¤æ§è¡çå¹¶è¡åº¦ãä¸ç®¡æ¯ç¼è¯å¨è¿æ¯å¤çå¨çéæåºï¼é½è¦éµå®as-if-serialè¯­ä¹ãas-if-serialè¯´çæ¯ï¼ä¸ç®¡æä¹éæåºï¼å¨åçº¿ç¨ä¸­æ§è¡è¿äºæä»¤ï¼å¶ç»æåºè¯¥æ¯ä¸æ ·çãå¨å¤çº¿ç¨çæåµä¸ï¼éè¦memory barrieræ¥ä¿è¯æ´ä½çé¡ºåºï¼å¦åä¼åºç°ææ³ä¸å°çç»æã</li>
</ul>
<p>ä¸åçå¤çå¨æ¶æçmemory barrierä¹ä¸å¤ªä¸æ ·ï¼ä»¥Intel x86ä¸ºä¾ï¼æä¸ç§memory barrier</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-2a352e8feda958db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>TBD4.png</p>
<h4 id="store-barrier"><a href="#store-barrier" class="headerlink" title="store barrier"></a>store barrier</h4><p>å¯¹åº<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://x86.renejeschke.de/html/file_module_x86_id_289.html">sfence</a>æä»¤</p>
<ol>
<li>ä¿è¯äºsfenceååstoreæä»¤çé¡ºåºï¼é²æ­¢éæåºã</li>
<li>éè¿å·æ°store bufferä¿è¯äºsfenceä¹åçstoreæä»¤å¨å±å¯è§ä¹åï¼sfenceä¹åçstoreè¦æä»¤è¦åå¨å±å¯è§ã</li>
</ol>
<h4 id="load-barrier"><a href="#load-barrier" class="headerlink" title="load barrier"></a>load barrier</h4><p>å¯¹åº<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://x86.renejeschke.de/html/file_module_x86_id_155.html">lfence</a>æä»¤ï¼</p>
<ol>
<li>ä¿è¯äºlfenceååçloadæä»¤çé¡ºåºï¼é²æ­¢éæåºã</li>
<li>å·æ°load bufferã</li>
</ol>
<h4 id="full-barrier"><a href="#full-barrier" class="headerlink" title="full barrier"></a>full barrier</h4><p>å¯¹åº<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://x86.renejeschke.de/html/file_module_x86_id_170.html">mfence</a>æä»¤</p>
<ol>
<li>ä¿è¯äºmfenceååçstoreåloadæä»¤çé¡ºåºï¼é²æ­¢éæåºã</li>
<li>ä¿è¯äºmfenceä¹åçstoreæä»¤å¨å±å¯è§ä¹åï¼mfenceä¹åçstoreæä»¤è¦åå¨å±å¯è§ã</li>
</ol>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-630f6cf743669bde.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>TBD5.png</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-2e6be31b00237551.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>TBD6.png</p>
<h2 id="8-JDK-1-7-åå­å±éå®ç°"><a href="#8-JDK-1-7-åå­å±éå®ç°" class="headerlink" title="8. JDK 1.7 åå­å±éå®ç°"></a>8. JDK 1.7 åå­å±éå®ç°</h2><p>JVMçä»£ç ã</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-c8fa442e07c46eb5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/980/format/webp" alt="img"></p>
<p>1.png</p>
<p>æ§è¡å®èµå¼æä½åï¼ç´§æ¥çæ§è¡<code>OrderAccess::storeload()</code>ï¼è¿åæ¯å¥ï¼</p>
<p>å¶å®è¿å°±æ¯ç»å¸¸ä¼å¿µå¨çåå­å±éï¼ä¹ååªç¥éå¿µï¼å´ä¸ç¥éæ¯å¦ä½å®ç°çãä»CPUç¼å­ç»æåæä¸­å·²ç»ç¥éï¼ä¸ä¸ªloadæä½éè¦è¿å¥LoadBufferï¼ç¶ååå»åå­å è½½ï¼ä¸ä¸ªstoreæä½éè¦è¿å¥StoreBufferï¼ç¶åååå¥ç¼å­ï¼è¿ä¸¤ä¸ªæä½é½æ¯å¼æ­¥çï¼ä¼å¯¼è´ä¸æ­£ç¡®çæä»¤éæåºï¼æä»¥å¨JVMä¸­å®ä¹äºä¸ç³»åçåå­å±éæ¥æå®æä»¤çæ§è¡é¡ºåºã</p>
<p>JVMä¸­å®ä¹çåå­å±éå¦ä¸ï¼JDK1.7çå®ç°</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-50d8710d40c2e318.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/982/format/webp" alt="img"></p>
<p>2.png</p>
<p>ä¸é¢æ¯å¸¸è§å¤çå¨åè®¸çéæåºç±»åçåè¡¨ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-3b5c9c9c1518cf87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/775/format/webp" alt="img"></p>
<p>11.png</p>
<p>ä¸è¡¨ååæ ¼ä¸­ç âNâ è¡¨ç¤ºå¤çå¨ä¸åè®¸ä¸¤ä¸ªæä½éæåºï¼âYâ è¡¨ç¤ºåè®¸éæåºã</p>
<p>ä»ä¸è¡¨æä»¬å¯ä»¥çåºï¼å¸¸è§çå¤çå¨é½åè®¸ Store-Load éæåºï¼å¸¸è§çå¤çå¨é½ä¸åè®¸å¯¹å­å¨æ°æ®ä¾èµçæä½åéæåºãsparc-TSO å x86 æ¥æç¸å¯¹è¾å¼ºçå¤çå¨åå­æ¨¡åï¼å®ä»¬ä»åè®¸å¯¹å-è¯»æä½åéæåºï¼å ä¸ºå®ä»¬é½ä½¿ç¨äºåç¼å²åºï¼ã</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-a2b96aad8dc32627.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/952/format/webp" alt="img"></p>
<p>12.png</p>
<p>Store Barrier<br>sfenceæä»¤å®ç°äºStore Barrierï¼ç¸å½äºStoreStore Barriersã<br>å¼ºå¶ææå¨sfenceæä»¤ä¹åçstoreæä»¤ï¼é½å¨è¯¥sfenceæä»¤æ§è¡ä¹åè¢«æ§è¡ï¼åéç¼å­å¤±æä¿¡å·ï¼å¹¶æstore bufferä¸­çæ°æ®å·åºå°CPUçL1 Cacheä¸­ï¼ææå¨sfenceæä»¤ä¹åçstoreæä»¤ï¼é½å¨è¯¥sfenceæä»¤æ§è¡ä¹åè¢«æ§è¡ãå³ï¼ç¦æ­¢å¯¹sfenceæä»¤ååstoreæä»¤çéæåºè·¨è¶sfenceæä»¤ï¼ä½¿ææStore Barrierä¹ååççåå­æ´æ°é½æ¯å¯è§çã<br>è¿éçâå¯è§âï¼æä¿®æ¹å¼å¯è§ï¼åå­å¯è§æ§ï¼ä¸æä½ç»æå¯è§ï¼ç¦ç¨éæåºï¼ãä¸åã</p>
<p>åå­å±éçæ åä¸­ï¼è®¨è®ºçæ¯ç¼å­ä¸åå­é´çç¸å¹²æ§ï¼å®éä¸ï¼åæ ·éç¨äºå¯å­å¨ä¸ç¼å­ãçè³å¯å­å¨ä¸åå­é´ç­å¤çº§ç¼å­ä¹é´ãx86æ¶æä½¿ç¨äºMESIåè®®çä¸ä¸ªåç§ï¼ç±åè®®ä¿è¯ä¸å±ç¼å­ä¸åå­é´çç¸å³æ§ï¼ååå­å±éåªéè¦ä¿è¯store bufferï¼å¯ä»¥è®¤ä¸ºæ¯å¯å­å¨ä¸L1 Cacheé´çä¸å±ç¼å­ï¼ä¸L1 Cacheé´çç¸å¹²æ§ãä¸åã</p>
<p>Load Barrier<br>lfenceæä»¤å®ç°äºLoad Barrierï¼ç¸å½äºLoadLoad Barriersã<br>å¼ºå¶ææå¨lfenceæä»¤ä¹åçloadæä»¤ï¼é½å¨è¯¥lfenceæä»¤æ§è¡ä¹åè¢«æ§è¡ï¼å¹¶ä¸ä¸ç´ç­å°load bufferè¢«è¯¥CPUè¯»å®æè½æ§è¡ä¹åçloadæä»¤ï¼åç°ç¼å­å¤±æååèµ·çå·å¥ï¼ãå³ï¼ç¦æ­¢å¯¹lfenceæä»¤ååloadæä»¤çéæåºè·¨è¶lfenceæä»¤ï¼éåStore Barrierï¼ä½¿ææStore Barrierä¹ååççåå­æ´æ°ï¼å¯¹Load Barrierä¹åçloadæä½é½æ¯å¯è§çã</p>
<p>Full Barrier<br>mfenceæä»¤å®ç°äºFull Barrierï¼ç¸å½äºStoreLoad Barriersã<br>mfenceæä»¤ç»¼åäºsfenceæä»¤ä¸lfenceæä»¤çä½ç¨ï¼å¼ºå¶ææå¨mfenceæä»¤ä¹åçstore/loadæä»¤ï¼é½å¨è¯¥mfenceæä»¤æ§è¡ä¹åè¢«æ§è¡ï¼ææå¨mfenceæä»¤ä¹åçstore/loadæä»¤ï¼é½å¨è¯¥mfenceæä»¤æ§è¡ä¹åè¢«æ§è¡ãå³ï¼ç¦æ­¢å¯¹mfenceæä»¤ååstore/loadæä»¤çéæåºè·¨è¶mfenceæä»¤ï¼ä½¿ææFull Barrierä¹ååççæä½ï¼å¯¹ææFull Barrierä¹åçæä½é½æ¯å¯è§çã</p>
<p>1ãloadloadå±éï¼load1ï¼loadloadï¼ load2ï¼2ãloadstoreå±éï¼loadï¼loadstoreï¼ storeï¼</p>
<p>è¿ä¸¤ä¸ªå±éé½éè¿<code>acquire()</code>æ¹æ³å®ç°</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-0f2dac73f616939c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/992/format/webp" alt="img"></p>
<p>3.png</p>
<p>å¶ä¸­<code>__asm__</code>ï¼è¡¨ç¤ºæ±ç¼ä»£ç çå¼å§ãvolatileï¼ä¹ååæè¿äºï¼ç¦æ­¢ç¼è¯å¨å¯¹ä»£ç è¿è¡ä¼åã.æåçâmemoryâæ¯ç¼è¯å¨å±éçä½ç¨ã</p>
<p>å¨LoadBufferä¸­æå¥è¯¥å±éï¼æ¸ç©ºå±éä¹åçloadæä½ï¼ç¶åæè½æ§è¡å±éä¹åçæä½ï¼å¯ä»¥ä¿è¯loadæä½çæ°æ®å¨ä¸ä¸ªstoreæä»¤ä¹ååå¤å¥½</p>
<p>3ãstorestoreå±éï¼store1ï¼storestoreï¼ store2ï¼éè¿ârelease()âæ¹æ³å®ç°ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-e01c9d3b6e89706a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/806/format/webp" alt="img"></p>
<p>4.png</p>
<p>å¨StoreBufferä¸­æå¥è¯¥å±éï¼æ¸ç©ºå±éä¹åçstoreæä½ï¼ç¶åæè½æ§è¡å±éä¹åçstoreæä½ï¼ä¿è¯store1åå¥çæ°æ®å¨æ§è¡store2æ¶å¯¹å¶å®CPUå¯è§ã</p>
<p>4ãstoreloadå±éï¼storeï¼storeloadï¼ loadï¼å¯¹javaä¸­çvolatileåéè¿è¡èµå¼ä¹åï¼æå¥çå°±æ¯è¿ä¸ªå±éï¼éè¿âfence()âæ¹æ³å®ç°ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-f954c5ce9b25b838.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/981/format/webp" alt="img"></p>
<p>5.png</p>
<p>çå°è¿ä¸ªææ²¡æå¾å´å¥ï¼</p>
<p>éè¿<code>os::is_MP()</code>åå¤æ­æ¯ä¸æ¯å¤æ ¸ï¼å¦æåªæä¸ä¸ªCPUçè¯ï¼å°±ä¸å­å¨è¿äºé®é¢äºã</p>
<p>storeloadå±éï¼å®å¨ç±ä¸é¢è¿äºæä»¤å®ç°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__asm__ volatile (<span class="string">&quot;lock; addl <span class="variable">$0</span>,0(%%rsp)&quot;</span> : : : <span class="string">&quot;cc&quot;</span>, <span class="string">&quot;memory&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>ä¸ºäºè¯éªè¿äºæä»¤å°åºæä»ä¹ç¨ï¼æä»¬ååç¹c++ä»£ç ç¼è¯ä¸ä¸</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> foo = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// insert code here...</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="keyword">int</span> a = foo + <span class="number">10</span>;</span><br><span class="line">    <span class="comment">// __asm__ volatile (&quot;lock; addl $0,0(%%rsp)&quot; : : : &quot;cc&quot;, &quot;memory&quot;);</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="keyword">int</span> b = foo + <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäºåéaåbä¸è¢«ç¼è¯å¨ä¼åæï¼è¿éä½¿ç¨äºvolatileè¿è¡ä¿®é¥°ï¼ç¼è¯åçæ±ç¼æä»¤å¦ä¸ï¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-fa8df2c676df466f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/985/format/webp" alt="img"></p>
<p>9.png</p>
<p>ä»ç¼è¯åçä»£ç å¯ä»¥åç°ï¼ç¬¬äºæ¬¡ä½¿ç¨fooåéæ¶ï¼æ²¡æä»åå­éæ°å è½½ï¼ä½¿ç¨äºå¯å­å¨çå¼ã</p>
<p>æ<code>__asm__ volatile ***</code>æä»¤å ä¸ä¹åéæ°ç¼è¯</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-759208c8b2491c7b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/983/format/webp" alt="img"></p>
<p>10.png</p>
<p>ç¸æ¯ä¹åï¼è¿éå¤äºä¸¤ä¸ªæä»¤ï¼ä¸ä¸ªlockï¼ä¸ä¸ªaddlãlockæä»¤çä½ç¨æ¯ï¼å¨æ§è¡lockåé¢æä»¤æ¶ï¼ä¼è®¾ç½®å¤çå¨çLOCK#ä¿¡å·ï¼è¿ä¸ªä¿¡å·ä¼éå®æ»çº¿ï¼é»æ­¢å¶å®CPUéè¿æ»çº¿è®¿é®åå­ï¼ç´å°è¿äºæä»¤æ§è¡ç»æï¼ï¼è¿æ¡æä»¤çæ§è¡åæåå­æä½ï¼ä¹åçè¯»åè¯·æ±é½ä¸è½è¶è¿lockæä»¤è¿è¡éæï¼ç¸å½äºä¸ä¸ªåå­å±éã</p>
<p>è¿æä¸ä¸ªï¼ç¬¬äºæ¬¡ä½¿ç¨fooåéæ¶ï¼ä»åå­ä¸­éæ°å è½½ï¼ä¿è¯å¯ä»¥æ¿å°fooåéçææ°å¼ï¼è¿æ¯ç±å¦ä¸æä»¤å®ç°</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__asm__ <span class="title">volatile</span> <span class="params">( : : : <span class="string">&quot;cc&quot;</span>, <span class="string">&quot;memory&quot;</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>åæ ·æ¯ç¼è¯å¨å±éï¼éç¥ç¼è¯å¨éæ°çæå è½½æä»¤(ä¸å¯ä»¥ä»ç¼å­å¯å­å¨ä¸­å)ã</p>
<h4 id="è¯»åvolatileåé"><a href="#è¯»åvolatileåé" class="headerlink" title="è¯»åvolatileåé"></a>è¯»åvolatileåé</h4><p>åæ ·å¨<code>bytecodeInterpreter.cpp</code>æä»¶ä¸­ï¼æ¾å°getstaticå­èç æä»¤çè§£éå¨å®ç°ã</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-5d21e8f2d703b92b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/994/format/webp" alt="img"></p>
<p>7.png</p>
<p>éè¿<code>obj-&gt;obj_field_acquire(field_offset)</code>è·ååéå¼</p>
<p><img src="https://upload-images.jianshu.io/upload_images/10803273-0622f8f730f8ebd6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/990/format/webp" alt="img"></p>
<p>8.png</p>
<p>æç»éè¿<code>OrderAccess::load_acquire</code>å®ç°</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> jint <span class="title">OrderAccess::load_acquire</span><span class="params">(<span class="keyword">volatile</span> jint* p)</span> </span>&#123; <span class="keyword">return</span> *p; &#125;</span><br></pre></td></tr></table></figure>

<p>åºå±åºäºC++çvolatileå®ç°ï¼å ä¸ºvolatileèªå¸¦äºç¼è¯å¨å±éçåè½ï¼æ»è½æ¿å°åå­ä¸­çææ°å¼ã</p>
<p>9äººç¹èµ</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/nb/23803512">5ç¯æç« æå®JVM</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92%E5%BA%8F/" data-id="ckmn1li26000in8a86u3g4wao" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Makefile-tutorial" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/Makefile-tutorial/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.811Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#Makefileæä»¶æ ¼å¼</p>
<p>##æ¦è¿°</p>
<p>Makefileæä»¶ç±ä¸ç³»åè§åï¼rulesï¼ææï¼æ¯æ¡è§åçå½¢å¼å¦ä¸ï¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;target: &lt;prerequisites</span><br><span class="line">[tab]  &lt;commands&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ç¬¬ä¸è¡åå·åé¢çé¨åï¼å«åâç®æ âï¼targetï¼ï¼åå·åé¢çé¨åå«åâåç½®æ¡ä»¶âï¼prerequisitesï¼ï¼ç¬¬äºè¡å¿é¡»ç±ä¸ä¸ªtabé®èµ·é¦ï¼åé¢è·çâå½ä»¤âï¼commandsï¼ã</p>
<p>âç®æ âæ¯å¿éçï¼ä¸å¯çç¥ï¼âåç½®æ¡ä»¶âåâå½ä»¤âé½æ¯å¯éçï¼ä½æ¯ä¸¤èä¹ä¸­å¿é¡»è³å°å­å¨ä¸ä¸ªã</p>
<p>æ¯æ¡è§åå°±æç¡®ä¸¤ä»¶äºï¼æå»ºç®æ çåç½®æ¡ä»¶æ¯ä»ä¹ï¼ä»¥åå¦ä½æå»ºã</p>
<p>##ç®æ ï¼targetï¼</p>
<p>ä¸ä¸ªç®æ ï¼targetï¼å°±ææä¸æ¡è§åãç®æ éå¸¸æ¯æä»¶åï¼ææMakeå½ä»¤æè¦æå»ºçå¯¹è±¡ï¼æ¯å¦ä¸æç a.txt ãç®æ å¯ä»¥æ¯ä¸ä¸ªæä»¶åï¼ä¹å¯ä»¥æ¯å¤ä¸ªæä»¶åï¼ä¹é´ç¨ç©ºæ ¼åéã</p>
<p>é¤äºæä»¶åï¼ç®æ è¿å¯ä»¥æ¯æä¸ªæä½çåå­ï¼è¿ç§°ä¸ºâä¼ªç®æ âï¼phony targetï¼ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm *.o</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç çç®æ æ¯cleanï¼å®ä¸æ¯æä»¶åï¼èæ¯ä¸ä¸ªæä½çåå­ï¼å±äºâä¼ªç®æ  âï¼ä½ç¨æ¯å é¤å¯¹è±¡æä»¶ã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ make  clean</span><br></pre></td></tr></table></figure>

<p>ä½æ¯ï¼å¦æå½åç®å½ä¸­ï¼æ­£å¥½æä¸ä¸ªæä»¶å«åcleanï¼é£ä¹è¿ä¸ªå½ä»¤ä¸ä¼æ§è¡ãå ä¸ºMakeåç°cleanæä»¶å·²ç»å­å¨ï¼å°±è®¤ä¸ºæ²¡æå¿è¦éæ°æå»ºäºï¼å°±ä¸ä¼æ§è¡æå®çrmå½ä»¤ã</p>
<p>ä¸ºäºé¿åè¿ç§æåµï¼å¯ä»¥æç¡®å£°æcleanæ¯âä¼ªç®æ âï¼åæ³å¦ä¸ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm *.o temp</span><br></pre></td></tr></table></figure>

<p>å£°æcleanæ¯âä¼ªç®æ âä¹åï¼makeå°±ä¸ä¼å»æ£æ¥æ¯å¦å­å¨ä¸ä¸ªå«åcleançæä»¶ï¼èæ¯æ¯æ¬¡è¿è¡é½æ§è¡å¯¹åºçå½ä»¤ãå.PHONYè¿æ ·çåç½®ç®æ åè¿æä¸å°ï¼å¯ä»¥æ¥ç<a target="_blank" rel="noopener" href="http://www.gnu.org/software/make/manual/html_node/Special-Targets.html#Special-Targets">æå</a>ã</p>
<p>å¦æMakeå½ä»¤è¿è¡æ¶æ²¡ææå®ç®æ ï¼é»è®¤ä¼æ§è¡Makefileæä»¶çç¬¬ä¸ä¸ªç®æ ã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ make</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç æ§è¡Makefileæä»¶çç¬¬ä¸ä¸ªç®æ ã</p>
<p>##åç½®æ¡ä»¶ï¼prerequisitesï¼</p>
<p>åç½®æ¡ä»¶éå¸¸æ¯ä¸ç»æä»¶åï¼ä¹é´ç¨ç©ºæ ¼åéãå®æå®äºâç®æ âæ¯å¦éæ°æå»ºçå¤æ­æ åï¼åªè¦æä¸ä¸ªåç½®æä»¶ä¸å­å¨ï¼æèæè¿æ´æ°ï¼åç½®æä»¶çlast-modificationæ¶é´æ³æ¯ç®æ çæ¶é´æ³æ°ï¼ï¼âç®æ âå°±éè¦éæ°æå»ºã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">result.txt: source.txt</span></span><br><span class="line">	cp source.txt result.txt</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç ä¸­ï¼æå»º result.txt çåç½®æ¡ä»¶æ¯ source.txt ãå¦æå½åç®å½ä¸­ï¼source.txt å·²ç»å­å¨ï¼é£ä¹<code>make result.txt</code>å¯ä»¥æ­£å¸¸è¿è¡ï¼å¦åmakeä¼è½¬åæå»ºç®æ source.txtï¼ç±äºmakefileä¸­æ²¡æè¿ä¸ªç®æ ï¼æ§è¡è¯¥å½ä»¤ä¼æ¥éã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make: *** No rule to make target <span class="string">&#x27;source.txt&#x27;</span>, needed by <span class="string">&#x27;result.txt&#x27;</span>.  Stop.</span><br></pre></td></tr></table></figure>
<p>å¿é¡»ååä¸æ¡è§åï¼æ¥çæ source.txt ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">source.txt:</span></span><br><span class="line">	echo <span class="string">&quot;this is the source&quot;</span> source.txt</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç ä¸­ï¼source.txtåé¢æ²¡æåç½®æ¡ä»¶ï¼å°±æå³çå®è·å¶ä»æä»¶é½æ å³ï¼åªè¦è¿ä¸ªæä»¶è¿ä¸å­å¨ï¼æ¯æ¬¡æå»ºç®æ source.txtï¼å®é½ä¼çæã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ make result.txt</span><br><span class="line">$ make result.txt</span><br></pre></td></tr></table></figure>

<p>ä¸é¢å½ä»¤è¿ç»­æ§è¡ä¸¤æ¬¡<code>make result.txt</code>ãç¬¬ä¸æ¬¡æ§è¡æ¶åç½®æ¡ä»¶ä¸æ»¡è¶³ï¼ä¼åè½¬åæå»ºåç½®æ¡ä»¶ï¼å³æ°å»º source.txtï¼ç¶ååç»§ç»­æå»º result.txtï¼å³å°source.txtå¤å¶ä¸ºresult.txtãç¬¬äºæ¬¡æ§è¡ï¼Makeåç°åç½®æ¡ä»¶ source.txt æ²¡ææ´æ°ï¼å³last-modificationæ¶é´æ³æ¯result.txtæ¶é´æ³æ©ï¼å°±ä¸ä¼æ§è¡ä»»ä½æä½ï¼å³ä¸ä¼éæ°çæresult.txtã</p>
<p>##å½ä»¤ï¼commandsï¼</p>
<p>å½ä»¤ï¼commandsï¼è¡¨ç¤ºå¦ä½æ´æ°ç®æ æä»¶ï¼ç±ä¸è¡æå¤è¡çShellå½ä»¤ç»æãå®æ¯æå»ºâç®æ âçå·ä½æä»¤ï¼å®çè¿è¡ç»æéå¸¸å°±æ¯çæç®æ æä»¶ã</p>
<p>æ¯è¡å½ä»¤ä¹åå¿é¡»æä¸ä¸ªtabé®ãå¦ææ³ç¨å¶ä»é®ï¼å¯ä»¥ç¨åç½®åé.RECIPEPREFIXå£°æã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.RECIPEPREFIX = &gt;</span><br><span class="line"><span class="section">all:</span></span><br><span class="line">echo Hello, world</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç ç¨.RECIPEPREFIXæå®ï¼å¤§äºå·ï¼&gt;ï¼æ¿ä»£tabé®ãæä»¥ï¼æ¯ä¸è¡å½ä»¤çèµ·é¦åæäºå¤§äºå·ï¼èä¸æ¯tabé®ã</p>
<p>éè¦æ³¨æçæ¯ï¼æ¯è¡å½ä»¤å¨ä¸ä¸ªåç¬çshellä¸­æ§è¡ãè¿äºShellä¹é´æ²¡æç»§æ¿å³ç³»ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">var-lost:</span></span><br><span class="line">	<span class="keyword">export</span> foo=bar</span><br><span class="line">	echo <span class="string">&quot;foo=[$$foo]&quot;</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç æ§è¡åï¼<code>make var-lost</code>ï¼ï¼åä¸å°fooçå¼ãå ä¸ºä¸¤è¡å½ä»¤å¨ä¸¤ä¸ªä¸åçè¿ç¨æ§è¡ãä¸ä¸ªè§£å³åæ³æ¯å°ä¸¤è¡å½ä»¤åå¨ä¸è¡ï¼ä¸­é´ç¨åå·åéã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">var-kept:</span></span><br><span class="line">	<span class="keyword">export</span> foo=bar; echo <span class="string">&quot;foo=[$$foo]&quot;</span></span><br></pre></td></tr></table></figure>

<p>å½ä»¤å¤ªé¿å¯ä»¥ä½¿ç¨â\âåæ¢è¡ç¬¦ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">var-kept:</span></span><br><span class="line">	<span class="keyword">export</span> foo=bar; \</span><br><span class="line">	echo <span class="string">&quot;foo=[$$foo]&quot;</span></span><br></pre></td></tr></table></figure>

<p>æåä¸ä¸ªæ¹æ³æ¯å ä¸<code>.ONESHELL:</code>å½ä»¤ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.ONESHELL:</span></span><br><span class="line"><span class="section">var-kept:</span></span><br><span class="line">	<span class="keyword">export</span> foo=bar; </span><br><span class="line">	echo <span class="string">&quot;foo=[$$foo]&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Makefileæä»¶çè¯­æ³"><a href="#Makefileæä»¶çè¯­æ³" class="headerlink" title="Makefileæä»¶çè¯­æ³"></a>Makefileæä»¶çè¯­æ³</h2><h3 id="æ³¨é"><a href="#æ³¨é" class="headerlink" title="æ³¨é"></a>æ³¨é</h3><p>äºå·ï¼#ï¼å¨Makefileä¸­è¡¨ç¤ºæ³¨éã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¿æ¯æ³¨é</span><br><span class="line"><span class="section">sult.txt: source.txt</span></span><br><span class="line"><span class="comment"># è¿æ¯æ³¨é</span></span><br><span class="line">	cp source.txt result.txt <span class="comment"># è¿ä¹æ¯æ³¨é</span></span><br></pre></td></tr></table></figure>

<h3 id="åå£°ï¼echoingï¼"><a href="#åå£°ï¼echoingï¼" class="headerlink" title="åå£°ï¼echoingï¼"></a>åå£°ï¼echoingï¼</h3><p>æ­£å¸¸æåµä¸ï¼makeä¼æå°æ¯æ¡å½ä»¤ï¼ç¶ååæ§è¡ï¼è¿å°±å«ååå£°ï¼echoingï¼ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">test:</span></span><br><span class="line">	<span class="comment"># è¿æ¯æµè¯</span></span><br></pre></td></tr></table></figure>

<p>æ§è¡ä¸é¢çè§åï¼ä¼å¾å°ä¸é¢çç»æã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$make</span> <span class="built_in">test</span></span><br><span class="line"><span class="comment"># è¿æ¯æµè¯</span></span><br></pre></td></tr></table></figure>

<p>å¨å½ä»¤çåé¢å ä¸@ï¼å°±å¯ä»¥å³é­åå£°ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">test:</span></span><br><span class="line">	@<span class="comment"># è¿æ¯æµè¯</span></span><br></pre></td></tr></table></figure>

<p>ç°å¨åæ§è¡<code>make test</code>ï¼å°±ä¸ä¼æä»»ä½è¾åºã</p>
<p>ç±äºå¨æå»ºè¿ç¨ä¸­ï¼éè¦äºè§£å½åå¨æ§è¡åªæ¡å½ä»¤ï¼æä»¥éå¸¸åªå¨æ³¨éåçº¯æ¾ç¤ºçechoå½ä»¤åé¢å ä¸@ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">test:</span></span><br><span class="line">	@<span class="comment"># è¿æ¯æµè¯</span></span><br><span class="line">	@echo TODO</span><br></pre></td></tr></table></figure>

<h3 id="ééç¬¦"><a href="#ééç¬¦" class="headerlink" title="ééç¬¦"></a>ééç¬¦</h3><p>ééç¬¦ï¼wildcardï¼ç¨æ¥æå®ä¸ç»ç¬¦åæ¡ä»¶çæä»¶åãMakefile çééç¬¦ä¸ Bash ä¸è´ï¼ä¸»è¦ææå·ï¼*ï¼ãé®å·ï¼ï¼ï¼å [â¦] ãæ¯å¦ï¼ *.o è¡¨ç¤ºææåç¼åä¸ºoçæä»¶ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f *.o</span><br></pre></td></tr></table></figure>

<h3 id="æ¨¡å¼å¹é"><a href="#æ¨¡å¼å¹é" class="headerlink" title="æ¨¡å¼å¹é"></a>æ¨¡å¼å¹é</h3><p>Makeå½ä»¤åè®¸å¯¹æä»¶åï¼è¿è¡ç±»ä¼¼æ­£åè¿ç®çå¹éï¼ä¸»è¦ç¨å°çå¹éç¬¦æ¯%ãæ¯å¦ï¼åå®å½åç®å½ä¸æ f1.c å f2.c ä¸¤ä¸ªæºç æä»¶ï¼éè¦å°å®ä»¬ç¼è¯ä¸ºå¯¹åºçå¯¹è±¡æä»¶ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">%.o: %.c</span></span><br></pre></td></tr></table></figure>

<p>ç­åäºä¸é¢çåæ³ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">f1.o: f1.c</span></span><br><span class="line"><span class="section">f2.o: f2.c</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç¨å¹éç¬¦%ï¼å¯ä»¥å°å¤§éåç±»åçæä»¶ï¼åªç¨ä¸æ¡è§åå°±å®ææå»ºã</p>
<h3 id="åéåèµå¼ç¬¦"><a href="#åéåèµå¼ç¬¦" class="headerlink" title="åéåèµå¼ç¬¦"></a>åéåèµå¼ç¬¦</h3><p>Makefile åè®¸ä½¿ç¨ç­å·èªå®ä¹åéã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">txt = Hello World</span><br><span class="line"><span class="built_in">test</span>:</span><br><span class="line">	@<span class="built_in">echo</span> $(txt)</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç ä¸­ï¼åé txt ç­äº Hello Worldãè°ç¨æ¶ï¼åééè¦æ¾å¨ $( ) ä¹ä¸­ã</p>
<p>è°ç¨Shellåéï¼éè¦å¨ç¾åç¬¦å·åï¼åå ä¸ä¸ªç¾åç¬¦å·ï¼è¿æ¯å ä¸ºMakeå½ä»¤ä¼å¯¹ç¾åç¬¦å·è½¬ä¹ã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span>:</span><br><span class="line">	@<span class="built_in">echo</span> $<span class="variable">$HOME</span></span><br></pre></td></tr></table></figure>

<p>ææ¶ï¼åéçå¼å¯è½æåå¦ä¸ä¸ªåéã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1 = $(v2)</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç ä¸­ï¼åé v1 çå¼æ¯å¦ä¸ä¸ªåé v2ãè¿æ¶ä¼äº§çä¸ä¸ªé®é¢ï¼v1 çå¼å°åºå¨å®ä¹æ¶æ©å±ï¼éææ©å±ï¼ï¼è¿æ¯å¨è¿è¡æ¶æ©å±ï¼å¨ææ©å±ï¼ï¼å¦æ v2 çå¼æ¯å¨æçï¼è¿ä¸¤ç§æ©å±æ¹å¼çç»æå¯è½ä¼å·®å¼å¾å¤§ã</p>
<p>ä¸ºäºè§£å³ç±»ä¼¼é®é¢ï¼Makefileä¸å±æä¾äºåä¸ªèµå¼è¿ç®ç¬¦ ï¼=ã:=ãï¼=ã+=ï¼ï¼å®ä»¬çåºå«è¯·ç<a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/448910/makefile-variable-assignment">StackOverflow</a>ã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">VARIABLE = value</span><br><span class="line"><span class="comment"># å¨æ§è¡æ¶æ©å±ï¼åè®¸éå½æ©å±ã</span></span><br><span class="line">VARIABLE := value</span><br><span class="line"><span class="comment"># å¨å®ä¹æ¶æ©å±ã</span></span><br><span class="line">VARIABLE ?= value</span><br><span class="line"><span class="comment"># åªæå¨è¯¥åéä¸ºç©ºæ¶æè®¾ç½®å¼ã</span></span><br><span class="line">VARIABLE += value</span><br><span class="line"><span class="comment"># å°å¼è¿½å å°åéçå°¾ç«¯ã</span></span><br></pre></td></tr></table></figure>

<h3 id="åç½®åéï¼Implicit-Variablesï¼"><a href="#åç½®åéï¼Implicit-Variablesï¼" class="headerlink" title="åç½®åéï¼Implicit Variablesï¼"></a>åç½®åéï¼Implicit Variablesï¼</h3><p>Makeå½ä»¤æä¾ä¸ç³»ååç½®åéï¼æ¯å¦ï¼$(CC) æåå½åä½¿ç¨çç¼è¯å¨ï¼$(MAKE) æåå½åä½¿ç¨çMakeå·¥å·ãè¿ä¸»è¦æ¯ä¸ºäºè·¨å¹³å°çå¼å®¹æ§ï¼è¯¦ç»çåç½®åéæ¸åè§<a target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html">æå</a>ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">output:</span></span><br><span class="line">	<span class="variable">$(CC)</span> -o output input.c</span><br></pre></td></tr></table></figure>
<h3 id="èªå¨åéï¼Automatic-Variablesï¼"><a href="#èªå¨åéï¼Automatic-Variablesï¼" class="headerlink" title="èªå¨åéï¼Automatic Variablesï¼"></a>èªå¨åéï¼Automatic Variablesï¼</h3><p>Makeå½ä»¤è¿æä¾ä¸äºèªå¨åéï¼å®ä»¬çå¼ä¸å½åè§åæå³ãä¸»è¦æä»¥ä¸å ä¸ªã</p>
<p>ï¼1ï¼$@</p>
<p>$@æä»£å½åç®æ ï¼å°±æ¯Makeå½ä»¤å½åæå»ºçé£ä¸ªç®æ ãæ¯å¦ï¼make fooç $@ å°±æä»£fooã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.txt b.txt: </span><br><span class="line">	touch <span class="variable">$@</span></span><br></pre></td></tr></table></figure>

<p>ç­åäºä¸é¢çåæ³ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">a.txt:</span></span><br><span class="line">	touch a.txt</span><br><span class="line"><span class="section">b.txt:</span></span><br><span class="line">	touch b.txt</span><br></pre></td></tr></table></figure>

<p>ï¼2ï¼$&lt;</p>
<p>$&lt; æä»£ç¬¬ä¸ä¸ªåç½®æ¡ä»¶ãæ¯å¦ï¼è§åä¸º t: p1 p2ï¼é£ä¹$&lt; å°±æä»£p1ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">a.txt: b.txt c.txt</span></span><br><span class="line">	cp <span class="variable">$&lt;</span> <span class="variable">$@</span> </span><br></pre></td></tr></table></figure>

<p>ç­åäºä¸é¢çåæ³ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">a.txt: b.txt c.txt</span></span><br><span class="line">	cp b.txt a.txt </span><br></pre></td></tr></table></figure>

<p>ï¼3ï¼$?</p>
<p>$? æä»£æ¯ç®æ æ´æ°çææåç½®æ¡ä»¶ï¼ä¹é´ä»¥ç©ºæ ¼åéãæ¯å¦ï¼è§åä¸º t: p1 p2ï¼å¶ä¸­ p2 çæ¶é´æ³æ¯ t æ°ï¼$?å°±æä»£p2ã</p>
<p>ï¼4ï¼$^</p>
<p>$^ æä»£ææåç½®æ¡ä»¶ï¼ä¹é´ä»¥ç©ºæ ¼åéãæ¯å¦ï¼è§åä¸º t: p1 p2ï¼é£ä¹ $^ å°±æä»£ p1 p2 ã</p>
<p>ï¼5ï¼$*</p>
<p>$* æä»£å¹éç¬¦ % å¹éçé¨åï¼ æ¯å¦% å¹é f1.txt ä¸­çf1 ï¼$* å°±è¡¨ç¤º f1ã</p>
<p>ï¼6ï¼$(@D) å $(@F)</p>
<p>$(@D) å $(@F) åå«æå $@ çç®å½ååæä»¶åãæ¯å¦ï¼$@æ¯ src/input.cï¼é£ä¹$(@D) çå¼ä¸º src ï¼$(@F) çå¼ä¸º input.cã</p>
<p>ï¼7ï¼$(&lt;D) å $(&lt;F)</p>
<p>$(&lt;D) å $(&lt;F) åå«æå $&lt; çç®å½ååæä»¶åã</p>
<p>ææçèªå¨åéæ¸åï¼è¯·çæåãä¸é¢æ¯èªå¨åéçä¸ä¸ªä¾å­ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">dest/%.txt: src/%.txt</span></span><br><span class="line">	@[ -d dest ] || mkdir dest</span><br><span class="line">	cp <span class="variable">$&lt;</span> <span class="variable">$@</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç å° src ç®å½ä¸ç txt æä»¶ï¼æ·è´å° dest ç®å½ä¸ãé¦åå¤æ­ dest ç®å½æ¯å¦å­å¨ï¼å¦æä¸å­å¨å°±æ°å»ºï¼ç¶åï¼$&lt; æä»£åç½®æä»¶ï¼src/%.txtï¼ï¼ â$@ æä»£ç®æ æä»¶ï¼dest/%.txtï¼ã</p>
<h3 id="å¤æ­åå¾ªç¯"><a href="#å¤æ­åå¾ªç¯" class="headerlink" title="å¤æ­åå¾ªç¯"></a>å¤æ­åå¾ªç¯</h3><p>Makefileä½¿ç¨ Bash è¯­æ³ï¼å®æå¤æ­åå¾ªç¯ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(CC)</span>,gcc)</span><br><span class="line">	libs=<span class="variable">$(libs_for_gcc)</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	libs=<span class="variable">$(normal_libs)</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç å¤æ­å½åç¼è¯å¨æ¯å¦ gcc ï¼ç¶åæå®ä¸åçåºæä»¶ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LIST = one two three</span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	for i in <span class="variable">$(LIST)</span>; do \</span><br><span class="line">		echo $$i; \</span><br><span class="line">	done</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­åäº</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	for i in one two three; do \</span><br><span class="line">		echo $i; \</span><br><span class="line">	done</span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç çè¿è¡ç»æã</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">one</span><br><span class="line">two</span><br><span class="line">three</span><br></pre></td></tr></table></figure>

<h3 id="å½æ°"><a href="#å½æ°" class="headerlink" title="å½æ°"></a>å½æ°</h3><p>Makefile è¿å¯ä»¥ä½¿ç¨å½æ°ï¼æ ¼å¼å¦ä¸ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(function arguments)</span></span><br><span class="line"><span class="comment"># æè</span></span><br><span class="line">$&#123;function arguments&#125;</span><br></pre></td></tr></table></figure>

<p>Makefileæä¾äºè®¸å¤<a target="_blank" rel="noopener" href="http://www.gnu.org/software/make/manual/html_node/Functions.html">åç½®å½æ°</a>ï¼å¯ä¾è°ç¨ãä¸é¢æ¯å ä¸ªå¸¸ç¨çåç½®å½æ°ã</p>
<p>ï¼1ï¼shell å½æ°</p>
<p>shell å½æ°ç¨æ¥æ§è¡ shell å½ä»¤</p>
<p>â```makefile<br>srcfiles := $(shell echo src/{00..99}.txt)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ï¼2ï¼wildcard å½æ°</span><br><span class="line"></span><br><span class="line">wildcard å½æ°ç¨æ¥å¨ Makefile ä¸­ï¼æ¿æ¢ Bash çééç¬¦ã</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;makefile</span><br><span class="line">srcfiles :&#x3D; $(wildcard src&#x2F;*.txt)</span><br></pre></td></tr></table></figure>

<p>ï¼3ï¼subst å½æ°</p>
<p>subst å½æ°ç¨æ¥ææ¬æ¿æ¢ï¼æ ¼å¼å¦ä¸ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">subst</span> from,to,text)</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢çä¾å­å°å­ç¬¦ä¸²âfeet on the streetâæ¿æ¢æâfEEt on the strEEtâã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">subst</span> ee,EE,feet on the street)</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢æ¯ä¸ä¸ªç¨å¾®å¤æçä¾å­ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">comma:= ,</span><br><span class="line">empty:=</span><br><span class="line">\<span class="comment"># spaceåéç¨ä¸¤ä¸ªç©ºåéä½ä¸ºæ è¯ç¬¦ï¼å½ä¸­æ¯ä¸ä¸ªç©ºæ ¼</span></span><br><span class="line">space:= <span class="variable">$(empty)</span> <span class="variable">$(empty)</span></span><br><span class="line">foo:= a b c</span><br><span class="line">bar:= <span class="variable">$(<span class="built_in">subst</span> <span class="variable">$(space)</span>,<span class="variable">$(comma)</span>,<span class="variable">$(foo)</span>)</span></span><br><span class="line">\<span class="comment"># bar is now `a,b,c&#x27;.</span></span><br></pre></td></tr></table></figure>

<p>ï¼4ï¼patsubstå½æ°</p>
<p>patsubst å½æ°ç¨äºæ¨¡å¼å¹éçæ¿æ¢ï¼æ ¼å¼å¦ä¸ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">patsubst</span> pattern,replacement,text)</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢çä¾å­å°æä»¶åâx.c.c bar.câï¼æ¿æ¢æâx.c.o bar.oâã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">patsubst</span> %.c,%.o,x.c.c bar.c)</span></span><br></pre></td></tr></table></figure>

<p>ï¼5ï¼æ¿æ¢åç¼å</p>
<p>æ¿æ¢åç¼åå½æ°çåæ³æ¯ï¼åéå + åå· + åç¼åæ¿æ¢è§åãå®å®éä¸patsubstå½æ°çä¸ç§ç®åå½¢å¼ã</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">min: $(OUTPUT:.js=.min.js)</span></span><br></pre></td></tr></table></figure>

<p>ä¸é¢ä»£ç çæææ¯ï¼å°åéOUTPUTä¸­çåç¼å .js å¨é¨æ¿æ¢æ .min.js ã</p>
<p>#Makefile ç®ä»</p>
<p>Makefile æ¯å make å½ä»¤ä¸èµ·éåä½¿ç¨ç.</p>
<p>å¾å¤å¤§åé¡¹ç®çç¼è¯é½æ¯éè¿ Makefile æ¥ç»ç»ç, å¦ææ²¡æ Makefile, é£å¾å¤é¡¹ç®ä¸­åç§åºåä»£ç ä¹é´çä¾èµå³ç³»ä¸ç¥ä¼å¤å¤æ.</p>
<p>Makefileçç»ç»æµç¨çè½åå¦æ­¤ä¹å¼º, ä¸ä»å¯ä»¥ç¨æ¥ç¼è¯é¡¹ç®, è¿å¯ä»¥ç¨æ¥ç»ç»æä»¬å¹³æ¶çä¸äºæ¥å¸¸æä½. è¿ä¸ªéè¦å¤§å®¶åæ¥èªå·±çæ³è±¡å.</p>
<p>æ¬ç¯åå®¢æ¯åºäº <a target="_blank" rel="noopener" href="http://bbs.chinaunix.net/forum.php?mod=viewthread&tid=408225">{ç²¾å} è·æä¸èµ·å Makefile</a> èæ´çç, æäºå å, è¿½å äºä¸äºç¤ºä¾.</p>
<p>éå¸¸æè°¢ gunguymadman_cu æä¾å¦æ­¤è¯¦å°½çMakefileä»ç», è¿æ­£æ¯æä¸ç´å¯»æ¾çMakefileä¸­æææ¡£.</p>
<h2 id="1-1-Makefile-ä¸»è¦é¨å"><a href="#1-1-Makefile-ä¸»è¦é¨å" class="headerlink" title="1.1 Makefile ä¸»è¦é¨å"></a>1.1 Makefile ä¸»è¦é¨å</h2><p>Makefileåºæ¬æ ¼å¼å¦ä¸:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">target ... : prerequisites1 [space] prerequisites2 ...</span><br><span class="line">[tab] command</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p>å¶ä¸­,</p>
<ul>
<li>target    - ç®æ æä»¶, å¯ä»¥æ¯ Object File, ä¹å¯ä»¥æ¯å¯æ§è¡æä»¶</li>
<li>prerequisites - çæ target æéè¦çæä»¶æèç®æ </li>
<li>command    - makeéè¦æ§è¡çå½ä»¤ (ä»»æçshellå½ä»¤), Makefileä¸­çå½ä»¤å¿é¡»ä»¥ [tab] å¼å¤´</li>
</ul>
<ol>
<li>æ¾ç¤ºè§å :: è¯´æå¦ä½çæä¸ä¸ªæå¤ä¸ªç®æ æä»¶(åæ¬ çæçæä»¶, æä»¶çä¾èµæä»¶, çæçå½ä»¤)</li>
<li>éæ¦è§å :: makeçèªå¨æ¨å¯¼åè½ææ§è¡çè§å</li>
<li>åéå®ä¹ :: Makefileä¸­å®ä¹çåé</li>
<li>æä»¶æç¤º :: Makefileä¸­å¼ç¨å¶ä»Makefile; æå®Makefileä¸­ææé¨å; å®ä¹ä¸ä¸ªå¤è¡å½ä»¤</li>
<li>æ³¨é   :: Makefileåªæè¡æ³¨é â#â, å¦æè¦ä½¿ç¨æèè¾åºâ#âå­ç¬¦, éè¦è¿è¡è½¬ä¹, â#â</li>
</ol>
<p>##GNU make çå·¥ä½æ¹å¼</p>
<ol>
<li>è¯»å¥ä¸»Makefile (ä¸»Makefileä¸­å¯ä»¥å¼ç¨å¶ä»Makefile)</li>
<li>è¯»å¥è¢«includeçå¶ä»Makefile</li>
<li>åå§åæä»¶ä¸­çåé</li>
<li>æ¨å¯¼éæ¦è§å, å¹¶åæææè§å</li>
<li>ä¸ºææçç®æ æä»¶åå»ºä¾èµå³ç³»é¾</li>
<li>æ ¹æ®ä¾èµå³ç³», å³å®åªäºç®æ è¦éæ°çæ</li>
<li>æ§è¡çæå½ä»¤</li>
</ol>
<h2 id="2-Makefile-åçº§è¯­æ³"><a href="#2-Makefile-åçº§è¯­æ³" class="headerlink" title="2. Makefile åçº§è¯­æ³"></a><strong>2. Makefile åçº§è¯­æ³</strong></h2><h3 id="2-1-Makefile-è§å"><a href="#2-1-Makefile-è§å" class="headerlink" title="2.1 Makefile è§å"></a><strong>2.1 Makefile è§å</strong></h3><h4 id="2-1-1-è§åè¯­æ³"><a href="#2-1-1-è§åè¯­æ³" class="headerlink" title="2.1.1 è§åè¯­æ³"></a><strong>2.1.1 è§åè¯­æ³</strong></h4><p>è§åä¸»è¦æ2é¨å: ä¾èµå³ç³» å çæç®æ çæ¹æ³.</p>
<p>è¯­æ³æä»¥ä¸2ç§:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target ... : prerequisites ...</span><br><span class="line">    command</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p>æè</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target ... : prerequisites ; command</span><br><span class="line">    command</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p>*<strong>æ³¨*</strong> commandå¤ªé¿, å¯ä»¥ç¨ â&quot; ä½ä¸ºæ¢è¡ç¬¦</p>
<h4 id="2-1-2-è§åä¸­çééç¬¦"><a href="#2-1-2-è§åä¸­çééç¬¦" class="headerlink" title="2.1.2 è§åä¸­çééç¬¦"></a><strong>2.1.2 è§åä¸­çééç¬¦</strong></h4><ul>
<li>*   :: è¡¨ç¤ºä»»æä¸ä¸ªæå¤ä¸ªå­ç¬¦</li>
<li>?   :: è¡¨ç¤ºä»»æä¸ä¸ªå­ç¬¦</li>
<li>[â¦] :: ex. [abcd] è¡¨ç¤ºa,b,c,dä¸­ä»»æä¸ä¸ªå­ç¬¦, [^abcd]è¡¨ç¤ºé¤a,b,c,dä»¥å¤çå­ç¬¦, [0-9]è¡¨ç¤º 0~9ä¸­ä»»æä¸ä¸ªæ°å­</li>
<li>~   :: è¡¨ç¤ºç¨æ·çhomeç®å½</li>
</ul>
<h4 id="2-1-3-è·¯å¾æç´¢"><a href="#2-1-3-è·¯å¾æç´¢" class="headerlink" title="2.1.3 è·¯å¾æç´¢"></a><strong>2.1.3 è·¯å¾æç´¢</strong></h4><p>å½ä¸ä¸ªMakefileä¸­æ¶åå°å¤§éæºæä»¶æ¶(è¿äºæºæä»¶åMakefileææå¯è½ä¸å¨åä¸ä¸ªç®å½ä¸­),</p>
<p>è¿æ¶, æå¥½å°æºæä»¶çè·¯å¾æç¡®å¨Makefileä¸­, ä¾¿äºç¼è¯æ¶æ¥æ¾. Makefileä¸­æä¸ªç¹æ®çåé <strong>VPATH</strong> å°±æ¯å®æè¿ä¸ªåè½ç.</p>
<p>æå®äº <strong>VPATH</strong> ä¹å, å¦æå½åç®å½ä¸­æ²¡ææ¾å°ç¸åºæä»¶æä¾èµçæä»¶, Makefile åå° <strong>VPATH</strong> æå®çè·¯å¾ä¸­åå»æ¥æ¾..</p>
<p><strong>VPATH</strong> ä½¿ç¨æ¹æ³:</p>
<ul>
<li>vpath <directories>      :: å½åç®å½ä¸­æ¾ä¸å°æä»¶æ¶, å°±ä»<directories>ä¸­æç´¢</li>
<li>vpath <pattern> <directories> :: ç¬¦å<pattern>æ ¼å¼çæä»¶, å°±ä»<directories>ä¸­æç´¢</li>
<li>vpath <pattern>        :: æ¸é¤ç¬¦å<pattern>æ ¼å¼çæä»¶æç´¢è·¯å¾</li>
<li>vpath             :: æ¸é¤ææå·²ç»è®¾ç½®å¥½çæä»¶è·¯å¾</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># ç¤ºä¾1 - å½åç®å½ä¸­æ¾ä¸å°æä»¶æ¶, æé¡ºåºä» srcç®å½ ..&#x2F;parent-dirç®å½ä¸­æ¥æ¾æä»¶</span><br><span class="line">VPATH src:..&#x2F;parent-dir   </span><br><span class="line"></span><br><span class="line"># ç¤ºä¾2 - .hç»å°¾çæä»¶é½ä» .&#x2F;header ç®å½ä¸­æ¥æ¾</span><br><span class="line">VPATH %.h .&#x2F;header</span><br><span class="line"></span><br><span class="line"># ç¤ºä¾3 - æ¸é¤ç¤ºä¾2ä¸­è®¾ç½®çè§å</span><br><span class="line">VPATH %.h</span><br><span class="line"></span><br><span class="line"># ç¤ºä¾4 - æ¸é¤ææVPATHçè®¾ç½®</span><br><span class="line">VPATH</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="Makefile-tutorial.assets/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-2-Makefile-ä¸­çåé"><a href="#2-2-Makefile-ä¸­çåé" class="headerlink" title="2.2 Makefile ä¸­çåé"></a><strong>2.2 Makefile ä¸­çåé</strong></h3><h4 id="2-2-1-åéå®ä¹-or"><a href="#2-2-1-åéå®ä¹-or" class="headerlink" title="2.2.1 åéå®ä¹ ( = or := )"></a><strong>2.2.1 åéå®ä¹ ( = or := )</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OBJS &#x3D; programA.o programB.o</span><br><span class="line">OBJS-ADD &#x3D; $(OBJS) programC.o</span><br><span class="line"># æè</span><br><span class="line">OBJS :&#x3D; programA.o programB.o</span><br><span class="line">OBJS-ADD :&#x3D; $(OBJS) programC.o</span><br></pre></td></tr></table></figure>

<p>å¶ä¸­ = å := çåºå«å¨äº, := åªè½ä½¿ç¨åé¢å®ä¹å¥½çåé, = å¯ä»¥ä½¿ç¨åé¢å®ä¹çåé</p>
<p><strong>æµè¯ =</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Makefileåå®¹</span><br><span class="line">OBJS2 &#x3D; $(OBJS1) programC.o</span><br><span class="line">OBJS1 &#x3D; programA.o programB.o</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(OBJS2)</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make, å¯ä»¥çåºè½ç¶ OBJS1 æ¯å¨ OBJS2 ä¹åå®ä¹ç, ä½å¨ OBJS2ä¸­å¯ä»¥æåä½¿ç¨</span><br><span class="line">$ make</span><br><span class="line">programA.o programB.o programC.o</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>æµè¯ :=</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Makefileåå®¹</span><br><span class="line">OBJS2 :&#x3D; $(OBJS1) programC.o</span><br><span class="line">OBJS1 :&#x3D; programA.o programB.o</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(OBJS2)</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make, å¯ä»¥çåº OBJS2 ä¸­ç $(OBJS1) ä¸ºç©º</span><br><span class="line">$ make</span><br><span class="line">programC.o</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="2-2-2-åéæ¿æ¢"><a href="#2-2-2-åéæ¿æ¢" class="headerlink" title="2.2.2 åéæ¿æ¢"></a><strong>2.2.2 åéæ¿æ¢</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Makefileåå®¹</span><br><span class="line">SRCS :&#x3D; programA.c programB.c programC.c</span><br><span class="line">OBJS :&#x3D; $(SRCS:%.c&#x3D;%.o)</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo &quot;SRCS: &quot; $(SRCS)</span><br><span class="line">    @echo &quot;OBJS: &quot; $(OBJS)</span><br><span class="line"></span><br><span class="line"># bashä¸­è¿è¡make</span><br><span class="line">$ make</span><br><span class="line">SRCS:  programA.c programB.c programC.c</span><br><span class="line">OBJS:  programA.o programB.o programC.o</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="2-2-3-åéè¿½å å¼"><a href="#2-2-3-åéè¿½å å¼" class="headerlink" title="2.2.3 åéè¿½å å¼ +="></a><strong>2.2.3 åéè¿½å å¼ +=</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Makefileåå®¹</span><br><span class="line">SRCS :&#x3D; programA.c programB.c programC.c</span><br><span class="line">SRCS +&#x3D; programD.c</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo &quot;SRCS: &quot; $(SRCS)</span><br><span class="line"></span><br><span class="line"># bashä¸­è¿è¡make</span><br><span class="line">$ make</span><br><span class="line">SRCS:  programA.c programB.c programC.c programD.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="2-2-4-åéè¦ç-override"><a href="#2-2-4-åéè¦ç-override" class="headerlink" title="2.2.4 åéè¦ç override"></a><strong>2.2.4 åéè¦ç override</strong></h4><p>ä½ç¨æ¯ä½¿ Makefileä¸­å®ä¹çåéè½å¤è¦ç make å½ä»¤åæ°ä¸­æå®çåé</p>
<p>è¯­æ³:</p>
<ul>
<li>override <variable> = <value></li>
<li>override <variable> := <value></li>
<li>override <variable> += <value></li>
</ul>
<p>ä¸é¢éè¿ä¸ä¸ªä¾å­ä½ä¼ override çä½ç¨ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># Makefileåå®¹ (æ²¡æç¨override)</span><br><span class="line">SRCS :&#x3D; programA.c programB.c programC.c</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo &quot;SRCS: &quot; $(SRCS)</span><br><span class="line"></span><br><span class="line"># bashä¸­è¿è¡make</span><br><span class="line">$ make SRCS&#x3D;nothing</span><br><span class="line">SRCS:  nothing</span><br><span class="line"></span><br><span class="line">#################################################</span><br><span class="line"></span><br><span class="line"># Makefileåå®¹ (ç¨override)</span><br><span class="line">override SRCS :&#x3D; programA.c programB.c programC.c</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo &quot;SRCS: &quot; $(SRCS)</span><br><span class="line"></span><br><span class="line"># bashä¸­è¿è¡make</span><br><span class="line">$ make SRCS&#x3D;nothing</span><br><span class="line">SRCS:  programA.c programB.c programC.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="2-2-5-ç®æ åé"><a href="#2-2-5-ç®æ åé" class="headerlink" title="2.2.5 ç®æ åé"></a><strong>2.2.5 ç®æ åé</strong></h4><p>ä½ç¨æ¯ä½¿åéçä½ç¨åä»éäºè¿ä¸ªç®æ (target), èä¸åä¹åä¾å­ä¸­å®ä¹çåé, å¯¹æ´ä¸ªMakefileé½ææ.</p>
<p>è¯­æ³:</p>
<ul>
<li>&lt;target â¦&gt; :: <variable-assignment></li>
<li>&lt;target â¦&gt; :: override <variable-assignment> (overrideä½ç¨åè§ åéè¦ççä»ç»)</li>
</ul>
<p>ç¤ºä¾:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">SRCS :&#x3D; programA.c programB.c programC.c</span><br><span class="line"></span><br><span class="line">target1: TARGET1-SRCS :&#x3D; programD.c</span><br><span class="line">target1:</span><br><span class="line">    @echo &quot;SRCS: &quot; $(SRCS)</span><br><span class="line">    @echo &quot;SRCS: &quot; $(TARGET1-SRCS)</span><br><span class="line"></span><br><span class="line">target2:</span><br><span class="line">    @echo &quot;SRCS: &quot; $(SRCS)</span><br><span class="line">    @echo &quot;SRCS: &quot; $(TARGET1-SRCS)</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡make</span><br><span class="line">$ make target1</span><br><span class="line">SRCS:  programA.c programB.c programC.c</span><br><span class="line">SRCS:  programD.c</span><br><span class="line"></span><br><span class="line">$ make target2     &lt;-- target2ä¸­æ¾ç¤ºä¸äº $(TARGET1-SRCS)</span><br><span class="line">SRCS:  programA.c programB.c programC.c</span><br><span class="line">SRCS:</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-3-Makefile-å½ä»¤åç¼"><a href="#2-3-Makefile-å½ä»¤åç¼" class="headerlink" title="2.3 Makefile å½ä»¤åç¼"></a><strong>2.3 Makefile å½ä»¤åç¼</strong></h3><p>Makefile ä¸­ä¹¦åshellå½ä»¤æ¶å¯ä»¥å 2ç§åç¼ @ å -, æèä¸ç¨åç¼.</p>
<p>3ç§æ ¼å¼çshellå½ä»¤åºå«å¦ä¸:</p>
<ul>
<li>ä¸ç¨åç¼ :: è¾åºæ§è¡çå½ä»¤ä»¥åå½ä»¤æ§è¡çç»æ, åºéçè¯åæ­¢æ§è¡</li>
<li>åç¼ @  :: åªè¾åºå½ä»¤æ§è¡çç»æ, åºéçè¯åæ­¢æ§è¡</li>
<li>åç¼ -  :: å½ä»¤æ§è¡æéçè¯, å¿½ç¥éè¯¯, ç»§ç»­æ§è¡</li>
</ul>
<p>ç¤ºä¾:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹ (ä¸ç¨åç¼)</span><br><span class="line">all:</span><br><span class="line">    echo &quot;æ²¡æåç¼&quot;</span><br><span class="line">    cat this_file_not_exist</span><br><span class="line">    echo &quot;éè¯¯ä¹åçå½ä»¤&quot;       &lt;-- è¿æ¡å½ä»¤ä¸ä¼è¢«æ§è¡</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">echo &quot;æ²¡æåç¼&quot;             &lt;-- å½ä»¤æ¬èº«æ¾ç¤ºåºæ¥</span><br><span class="line">æ²¡æåç¼                    &lt;-- å½ä»¤æ§è¡ç»ææ¾ç¤ºåºæ¥</span><br><span class="line">cat this_file_not_exist</span><br><span class="line">cat: this_file_not_exist: No such file or directory</span><br><span class="line">make: *** [all] Error 1</span><br><span class="line"></span><br><span class="line">###########################################################</span><br><span class="line"></span><br><span class="line"># Makefile åå®¹ (åç¼ @)</span><br><span class="line">all:</span><br><span class="line">    @echo &quot;æ²¡æåç¼&quot;</span><br><span class="line">    @cat this_file_not_exist</span><br><span class="line">    @echo &quot;éè¯¯ä¹åçå½ä»¤&quot;       &lt;-- è¿æ¡å½ä»¤ä¸ä¼è¢«æ§è¡</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">æ²¡æåç¼                         &lt;-- åªæå½ä»¤æ§è¡çç»æ, ä¸æ¾ç¤ºå½ä»¤æ¬èº«</span><br><span class="line">cat: this_file_not_exist: No such file or directory</span><br><span class="line">make: *** [all] Error 1</span><br><span class="line"></span><br><span class="line">###########################################################</span><br><span class="line"></span><br><span class="line"># Makefile åå®¹ (åç¼ -)</span><br><span class="line">all:</span><br><span class="line">    -echo &quot;æ²¡æåç¼&quot;</span><br><span class="line">    -cat this_file_not_exist</span><br><span class="line">    -echo &quot;éè¯¯ä¹åçå½ä»¤&quot;       &lt;-- è¿æ¡å½ä»¤ä¼è¢«æ§è¡</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">echo &quot;æ²¡æåç¼&quot;             &lt;-- å½ä»¤æ¬èº«æ¾ç¤ºåºæ¥</span><br><span class="line">æ²¡æåç¼                    &lt;-- å½ä»¤æ§è¡ç»ææ¾ç¤ºåºæ¥</span><br><span class="line">cat this_file_not_exist</span><br><span class="line">cat: this_file_not_exist: No such file or directory</span><br><span class="line">make: [all] Error 1 (ignored)</span><br><span class="line">echo &quot;éè¯¯ä¹åçå½ä»¤&quot;       &lt;-- åºéä¹åçå½ä»¤ä¹ä¼æ¾ç¤º</span><br><span class="line">éè¯¯ä¹åçå½ä»¤              &lt;-- åºéä¹åçå½ä»¤ä¹ä¼æ§è¡</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-4-ä¼ªç®æ "><a href="#2-4-ä¼ªç®æ " class="headerlink" title="2.4 ä¼ªç®æ "></a><strong>2.4 ä¼ªç®æ </strong></h3><p>ä¼ªç®æ å¹¶ä¸æ¯ä¸ä¸ªâç®æ (target)â, ä¸åçæ­£çç®æ é£æ ·ä¼çæä¸ä¸ªç®æ æä»¶.</p>
<p>å¸åçä¼ªç®æ æ¯ Makefile ä¸­ç¨æ¥æ¸çç¼è¯è¿ç¨ä¸­ä¸­é´æä»¶ç clean ä¼ªç®æ , ä¸è¬æ ¼å¼å¦ä¸:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.PHONY: clean   &lt;-- è¿å¥æ²¡æä¹è¡, ä½æ¯æå¥½å ä¸</span><br><span class="line">clean:</span><br><span class="line">    -rm -f *.o</span><br></pre></td></tr></table></figure>

<h3 id="2-5-å¼ç¨å¶ä»ç-Makefile"><a href="#2-5-å¼ç¨å¶ä»ç-Makefile" class="headerlink" title="2.5 å¼ç¨å¶ä»ç Makefile"></a><strong>2.5 å¼ç¨å¶ä»ç Makefile</strong></h3><p>è¯­æ³: include <filename> (filename å¯ä»¥åå«ééç¬¦åè·¯å¾)</p>
<p>ç¤ºä¾:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo &quot;ä¸» Makefile begin&quot;</span><br><span class="line">    @make other-all</span><br><span class="line">    @echo &quot;ä¸» Makefile end&quot;</span><br><span class="line"></span><br><span class="line">include .&#x2F;other&#x2F;Makefile</span><br><span class="line"></span><br><span class="line"># .&#x2F;other&#x2F;Makefile åå®¹</span><br><span class="line">other-all:</span><br><span class="line">    @echo &quot;other makefile begin&quot;</span><br><span class="line">    @echo &quot;other makefile end&quot;</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make</span><br><span class="line">$ ll</span><br><span class="line">total 20K</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin  125 Sep 23 16:13 Makefile</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin  11K Sep 23 16:15 makefile.org   &lt;-- è¿ä¸ªæä»¶ä¸ç¨ç®¡</span><br><span class="line">drwxr-xr-x 2 wangyubin wangyubin 4.0K Sep 23 16:11 other</span><br><span class="line">$ ll other&#x2F;</span><br><span class="line">total 4.0K</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin 71 Sep 23 16:11 Makefile</span><br><span class="line"></span><br><span class="line">$ make</span><br><span class="line">ä¸» Makefile begin</span><br><span class="line">make[1]: Entering directory &#96;&#x2F;path&#x2F;to&#x2F;test&#x2F;makefile&#39;</span><br><span class="line">other makefile begin</span><br><span class="line">other makefile end</span><br><span class="line">make[1]: Leaving directory &#96;&#x2F;path&#x2F;to&#x2F;test&#x2F;makefile&#39;</span><br><span class="line">ä¸» Makefile end</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-6-æ¥çCæä»¶çä¾èµå³ç³»"><a href="#2-6-æ¥çCæä»¶çä¾èµå³ç³»" class="headerlink" title="2.6 æ¥çCæä»¶çä¾èµå³ç³»"></a><strong>2.6 æ¥çCæä»¶çä¾èµå³ç³»</strong></h3><p>å Makefile çæ¶å, éè¦ç¡®å®æ¯ä¸ªç®æ çä¾èµå³ç³».</p>
<p>GNUæä¾ä¸ä¸ªæºå¶å¯ä»¥æ¥çCä»£ç æä»¶ä¾èµé£äºæä»¶, è¿æ ·æä»¬å¨å Makefile ç®æ çæ¶åå°±ä¸ç¨æå¼Cæºç æ¥çå¶ä¾èµé£äºæä»¶äº.</p>
<p>æ¯å¦, ä¸é¢å½ä»¤æ¾ç¤ºåæ ¸æºç ä¸­ virt/kvm/kvm_main.c ä¸­çä¾èµå³ç³»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd virt&#x2F;kvm&#x2F;</span><br><span class="line">$ gcc -MM kvm_main.c </span><br><span class="line">kvm_main.o: kvm_main.c iodev.h coalesced_mmio.h async_pf.h   &lt;-- è¿å¥å°±å¯ä»¥å å° Makefile ä¸­ä½ä¸ºç¼è¯ kvm_main.o çä¾èµå³ç³»</span><br></pre></td></tr></table></figure>

<h3 id="2-7-make-éåºç "><a href="#2-7-make-éåºç " class="headerlink" title="2.7 make éåºç "></a><strong>2.7 make éåºç </strong></h3><p>Makefileçéåºç æä»¥ä¸3ç§ï¼</p>
<ul>
<li>0 :: è¡¨ç¤ºæåæ§è¡</li>
<li>1 :: è¡¨ç¤ºmakeå½ä»¤åºç°äºéè¯¯</li>
<li>2 :: ä½¿ç¨äº â-qâ éé¡¹, å¹¶ä¸makeä½¿å¾ä¸äºç®æ ä¸éè¦æ´æ°</li>
</ul>
<h3 id="2-8-æå®-Makefileï¼-æå®ç¹å®ç®æ "><a href="#2-8-æå®-Makefileï¼-æå®ç¹å®ç®æ " class="headerlink" title="2.8 æå® Makefileï¼ æå®ç¹å®ç®æ "></a><strong>2.8 æå® Makefileï¼ æå®ç¹å®ç®æ </strong></h3><p>é»è®¤æ§è¡ make å½ä»¤æ¶, GNU makeå¨å½åç®å½ä¸ä¾æ¬¡æç´¢ä¸é¢3ä¸ªæä»¶ âGNUmakefileâ, âmakefileâ, âMakefileâ,</p>
<p>æ¾å°å¯¹åºæä»¶ä¹å, å°±å¼å§æ§è¡æ­¤æä»¶ä¸­çç¬¬ä¸ä¸ªç®æ (target). å¦ææ¾ä¸å°è¿3ä¸ªæä»¶å°±æ¥é.</p>
<p>éé»è®¤æåµä¸, å¯ä»¥å¨ make å½ä»¤ä¸­æå®ç¹å®ç Makefile åç¹å®ç ç®æ .</p>
<p>ç¤ºä¾ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># Makefileæä»¶åæ¹ä¸º MyMake, åå®¹</span><br><span class="line">target1:</span><br><span class="line">    @echo &quot;target [1]  begin&quot;</span><br><span class="line">    @echo &quot;target [1]  end&quot;</span><br><span class="line"></span><br><span class="line">target2:</span><br><span class="line">    @echo &quot;target [2]  begin&quot;</span><br><span class="line">    @echo &quot;target [2]  end&quot;</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ ls</span><br><span class="line">Makefile</span><br><span class="line">$ mv Makefile MyMake</span><br><span class="line">$ ls</span><br><span class="line">MyMake</span><br><span class="line">$ make                     &lt;-- æ¾ä¸å°é»è®¤ç Makefile</span><br><span class="line">make: *** No targets specified and no makefile found.  Stop.</span><br><span class="line">$ make -f MyMake           &lt;-- æå®ç¹å®çMakefile</span><br><span class="line">target [1]  begin</span><br><span class="line">target [1]  end</span><br><span class="line">$ make -f MyMake target2   &lt;-- æå®ç¹å®çç®æ (target)</span><br><span class="line">target [2]  begin</span><br><span class="line">target [2]  end</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-9-make-åæ°ä»ç»"><a href="#2-9-make-åæ°ä»ç»" class="headerlink" title="2.9 make åæ°ä»ç»"></a><strong>2.9 make åæ°ä»ç»</strong></h3><p>make çåæ°æå¾å¤, å¯ä»¥éè¿ make -h å»æ¥ç, ä¸é¢åªä»ç»å ä¸ªæè®¤ä¸ºæ¯è¾æç¨ç.</p>
<table>
<thead>
<tr>
<th><strong>åæ°</strong></th>
<th><strong>å«ä¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td>âdebug[=<options>]</td>
<td>è¾åºmakeçè°è¯ä¿¡æ¯, options å¯ä»¥æ¯ a, b, v</td>
</tr>
<tr>
<td>-j âjobs</td>
<td>åæ¶è¿è¡çå½ä»¤çä¸ªæ°, ä¹å°±æ¯å¤çº¿ç¨æ§è¡ Makefile</td>
</tr>
<tr>
<td>-r âno-builtin-rules</td>
<td>ç¦æ­¢ä½¿ç¨ä»»ä½éå«è§å</td>
</tr>
<tr>
<td>-R âno-builtin-variabes</td>
<td>ç¦æ­¢ä½¿ç¨ä»»ä½ä½ç¨äºåéä¸çéå«è§å</td>
</tr>
<tr>
<td>-B âalways-make</td>
<td>åè®¾ææç®æ é½ææ´æ°, å³å¼ºå¶éç¼è¯</td>
</tr>
</tbody></table>
<h3 id="2-10-Makefile-éå«è§å"><a href="#2-10-Makefile-éå«è§å" class="headerlink" title="2.10 Makefile éå«è§å"></a><strong>2.10 Makefile éå«è§å</strong></h3><p>è¿éåªåä¸ä¸ªåç¼è¯Cç¸å³ç.</p>
<p>ç¼è¯Cæ¶ï¼<n>.o çç®æ ä¼èªå¨æ¨å¯¼ä¸º <n>.c</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Makefile ä¸­</span><br><span class="line">main : main.o</span><br><span class="line">    gcc -o main main.o</span><br><span class="line"></span><br><span class="line">#ä¼èªå¨åä¸º:</span><br><span class="line">main : main.o</span><br><span class="line">    gcc -o main main.o</span><br><span class="line"></span><br><span class="line">main.o: main.c    &lt;-- main.o è¿ä¸ªç®æ æ¯éå«çæç</span><br><span class="line">    gcc -c main.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-11-éå«è§åä¸­ç-å½ä»¤åé-å-å½ä»¤åæ°åé"><a href="#2-11-éå«è§åä¸­ç-å½ä»¤åé-å-å½ä»¤åæ°åé" class="headerlink" title="2.11 éå«è§åä¸­ç å½ä»¤åé å å½ä»¤åæ°åé"></a><strong>2.11 éå«è§åä¸­ç å½ä»¤åé å å½ä»¤åæ°åé</strong></h3><h4 id="2-11-1-å½ä»¤åé-ä¹¦åMakefileå¯ä»¥ç´æ¥å-shellæ¶ç¨è¿äºåé"><a href="#2-11-1-å½ä»¤åé-ä¹¦åMakefileå¯ä»¥ç´æ¥å-shellæ¶ç¨è¿äºåé" class="headerlink" title="2.11.1 å½ä»¤åé, ä¹¦åMakefileå¯ä»¥ç´æ¥å shellæ¶ç¨è¿äºåé."></a><strong>2.11.1 å½ä»¤åé, ä¹¦åMakefileå¯ä»¥ç´æ¥å shellæ¶ç¨è¿äºåé.</strong></h4><p>ä¸é¢åªååºä¸äºCç¸å³ç</p>
<table>
<thead>
<tr>
<th><strong>åéå</strong></th>
<th><strong>å«ä¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td>RM</td>
<td>rm -f</td>
</tr>
<tr>
<td>AR</td>
<td>ar</td>
</tr>
<tr>
<td>CC</td>
<td>cc</td>
</tr>
<tr>
<td>CXX</td>
<td>g++</td>
</tr>
</tbody></table>
<p>ç¤ºä¾:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(RM)</span><br><span class="line">    @echo $(AR)</span><br><span class="line">    @echo $(CC)</span><br><span class="line">    @echo $(CXX)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡make, æ¾ç¤ºåä¸ªåéçå¼</span><br><span class="line">$ make</span><br><span class="line">rm -f</span><br><span class="line">ar</span><br><span class="line">cc</span><br><span class="line">g++</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="2-11-2-å½ä»¤åæ°åé"><a href="#2-11-2-å½ä»¤åæ°åé" class="headerlink" title="2.11.2 å½ä»¤åæ°åé"></a><strong>2.11.2 å½ä»¤åæ°åé</strong></h4><table>
<thead>
<tr>
<th><strong>åéå</strong></th>
<th><strong>å«ä¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ARFLAGS</td>
<td>ARå½ä»¤çåæ°</td>
</tr>
<tr>
<td>CFLAGS</td>
<td>Cè¯­è¨ç¼è¯å¨çåæ°</td>
</tr>
<tr>
<td>CXXFLAGS</td>
<td>C++è¯­è¨ç¼è¯å¨çåæ°</td>
</tr>
</tbody></table>
<p>ç¤ºä¾: ä¸é¢ä»¥ CFLAGS ä¸ºä¾æ¼ç¤º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># test.c åå®¹</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    printf (&quot;Hello Makefile\n&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Makefile åå®¹</span><br><span class="line">test: test.o</span><br><span class="line">    $(CC) -o test test.o</span><br><span class="line"></span><br><span class="line"># bash ä¸­ç¨ make æ¥æµè¯</span><br><span class="line">$ ll</span><br><span class="line">total 24K</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin  69 Sep 23 17:31 Makefile</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin 14K Sep 23 19:51 makefile.org   &lt;-- è¯·å¿½ç¥è¿ä¸ªæä»¶</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin 392 Sep 23 17:31 test.c</span><br><span class="line"></span><br><span class="line">$ make</span><br><span class="line">cc    -c -o test.o test.c</span><br><span class="line">cc -o test test.o               &lt;-- è¿ä¸ªæ¯èªå¨æ¨å¯¼ç</span><br><span class="line"></span><br><span class="line">$ rm -f test test.o</span><br><span class="line"></span><br><span class="line">$ make CFLAGS&#x3D;-Wall             &lt;-- å½ä»¤ä¸­å çç¼è¯å¨åæ°èªå¨è¿½å å¥ä¸é¢çç¼è¯ä¸­äº</span><br><span class="line">cc -Wall   -c -o test.o test.c</span><br><span class="line">cc -o test test.o</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="2-12-èªå¨åé"><a href="#2-12-èªå¨åé" class="headerlink" title="2.12 èªå¨åé"></a><strong>2.12 èªå¨åé</strong></h3><p>Makefile ä¸­å¾å¤æ¶åéè¿èªå¨åéæ¥ç®åä¹¦å, åä¸ªèªå¨åéçå«ä¹å¦ä¸:</p>
<table>
<thead>
<tr>
<th><strong>èªå¨åé</strong></th>
<th><strong>å«ä¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td>$@</td>
<td>ç®æ éå</td>
</tr>
<tr>
<td>$%</td>
<td>å½ç®æ æ¯å½æ°åºæä»¶æ¶, è¡¨ç¤ºå¶ä¸­çç®æ æä»¶å</td>
</tr>
<tr>
<td>$&lt;</td>
<td>ç¬¬ä¸ä¸ªä¾èµç®æ . å¦æä¾èµç®æ æ¯å¤ä¸ª, éä¸ªè¡¨ç¤ºä¾èµç®æ </td>
</tr>
<tr>
<td>$?</td>
<td>æ¯ç®æ æ°çä¾èµç®æ çéå</td>
</tr>
<tr>
<td>$^</td>
<td>ææä¾èµç®æ çéå, ä¼å»é¤éå¤çä¾èµç®æ </td>
</tr>
<tr>
<td>$+</td>
<td>ææä¾èµç®æ çéå, ä¸ä¼å»é¤éå¤çä¾èµç®æ </td>
</tr>
<tr>
<td>$*</td>
<td>è¿ä¸ªæ¯GNU makeç¹æç, å¶å®çmakeä¸ä¸å®æ¯æ</td>
</tr>
</tbody></table>
<h2 id="3-Makefile-é«çº§è¯­æ³"><a href="#3-Makefile-é«çº§è¯­æ³" class="headerlink" title="3. Makefile é«çº§è¯­æ³"></a><strong>3. Makefile é«çº§è¯­æ³</strong></h2><h3 id="3-1-åµå¥Makefile"><a href="#3-1-åµå¥Makefile" class="headerlink" title="3.1 åµå¥Makefile"></a><strong>3.1 åµå¥Makefile</strong></h3><p>å¨ Makefile åçº§è¯­æ³ä¸­å·²ç»æå°è¿å¼ç¨å¶å® Makefileçæ¹æ³. è¿éæå¦ä¸ç§åæ³, å¹¶ä¸å¯ä»¥åå¼ç¨çå¶å® Makefile ä¼ éåæ°.</p>
<p>ç¤ºä¾: (ä¸ä¼ éåæ°, åªæ¯è°ç¨å­æä»¶å¤¹ other ä¸­çMakefile)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo &quot;ä¸» Makefile begin&quot;</span><br><span class="line">    @cd .&#x2F;other &amp;&amp; make</span><br><span class="line">    @echo &quot;ä¸» Makefile end&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># .&#x2F;other&#x2F;Makefile åå®¹</span><br><span class="line">other-all:</span><br><span class="line">    @echo &quot;other makefile begin&quot;</span><br><span class="line">    @echo &quot;other makefile end&quot;</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make</span><br><span class="line">$ ll</span><br><span class="line">total 28K</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin  104 Sep 23 20:43 Makefile</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin  17K Sep 23 20:44 makefile.org   &lt;-- è¿ä¸ªæä»¶ä¸ç¨ç®¡</span><br><span class="line">drwxr-xr-x 2 wangyubin wangyubin 4.0K Sep 23 20:42 other</span><br><span class="line">$ ll other&#x2F;</span><br><span class="line">total 4.0K</span><br><span class="line">-rw-r--r-- 1 wangyubin wangyubin 71 Sep 23 16:11 Makefile</span><br><span class="line"></span><br><span class="line">$ make</span><br><span class="line">ä¸» Makefile begin</span><br><span class="line">make[1]: Entering directory &#96;&#x2F;path&#x2F;to&#x2F;test&#x2F;makefile&#x2F;other&#39;</span><br><span class="line">other makefile begin</span><br><span class="line">other makefile end</span><br><span class="line">make[1]: Leaving directory &#96;&#x2F;path&#x2F;to&#x2F;test&#x2F;makefile&#x2F;other&#39;</span><br><span class="line">ä¸» Makefile end</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p>ç¤ºä¾: (ç¨exportä¼ éåæ°)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">export VALUE1 :&#x3D; export.c    &lt;-- ç¨äº export, æ­¤åéè½å¤ä¼ éå° .&#x2F;other&#x2F;Makefile ä¸­</span><br><span class="line">VALUE2 :&#x3D; no-export.c        &lt;-- æ­¤åéä¸è½ä¼ éå° .&#x2F;other&#x2F;Makefile ä¸­</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo &quot;ä¸» Makefile begin&quot;</span><br><span class="line">    @cd .&#x2F;other &amp;&amp; make</span><br><span class="line">    @echo &quot;ä¸» Makefile end&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># .&#x2F;other&#x2F;Makefile åå®¹</span><br><span class="line">other-all:</span><br><span class="line">    @echo &quot;other makefile begin&quot;</span><br><span class="line">    @echo &quot;VALUE1: &quot; $(VALUE1)</span><br><span class="line">    @echo &quot;VALUE2: &quot; $(VALUE2)</span><br><span class="line">    @echo &quot;other makefile end&quot;</span><br><span class="line"></span><br><span class="line"># bashä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">ä¸» Makefile begin</span><br><span class="line">make[1]: Entering directory &#96;&#x2F;path&#x2F;to&#x2F;test&#x2F;makefile&#x2F;other&#39;</span><br><span class="line">other makefile begin</span><br><span class="line">VALUE1:  export.c        &lt;-- VALUE1 ä¼ éæå</span><br><span class="line">VALUE2:                  &lt;-- VALUE2 ä¼ éå¤±è´¥</span><br><span class="line">other makefile end</span><br><span class="line">make[1]: Leaving directory &#96;&#x2F;path&#x2F;to&#x2F;test&#x2F;makefile&#x2F;other&#39;</span><br><span class="line">ä¸» Makefile end</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p>*<strong>è¡¥å*</strong> export è¯­æ³æ ¼å¼å¦ä¸:</p>
<ul>
<li>export variable = value</li>
<li>export variable := value</li>
<li>export variable += value</li>
</ul>
<h3 id="3-2-å®ä¹å½ä»¤å"><a href="#3-2-å®ä¹å½ä»¤å" class="headerlink" title="3.2 å®ä¹å½ä»¤å"></a><strong>3.2 å®ä¹å½ä»¤å</strong></h3><p>å½ä»¤åæç¹åæ¯ä¸ªå½æ°, å°è¿ç»­çç¸åçå½ä»¤åæä¸æ¡, åå° Makefile ä¸­çä»£ç é, ä¾¿äºä»¥åç»´æ¤.</p>
<p><strong>è¯­æ³:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">define &lt;command-name&gt;</span><br><span class="line">command</span><br><span class="line">...</span><br><span class="line">endef</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">define run-hello-makefile</span><br><span class="line">@echo -n &quot;Hello&quot;</span><br><span class="line">@echo &quot; Makefile!&quot;</span><br><span class="line">@echo &quot;è¿éå¯ä»¥æ§è¡å¤æ¡ Shell å½ä»¤!&quot;</span><br><span class="line">endef</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    $(run-hello-makefile)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bash ä¸­è¿è¡make</span><br><span class="line">$ make</span><br><span class="line">Hello Makefile!</span><br><span class="line">è¿éå¯ä»¥æ§è¡å¤æ¡ Shell å½ä»¤!</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="3-3-æ¡ä»¶å¤æ­"><a href="#3-3-æ¡ä»¶å¤æ­" class="headerlink" title="3.3 æ¡ä»¶å¤æ­"></a><strong>3.3 æ¡ä»¶å¤æ­</strong></h3><p>æ¡ä»¶å¤æ­çå³é®å­ä¸»è¦æ <strong>ifeq ifneq ifdef ifndef</strong></p>
<p><strong>è¯­æ³:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;conditional-directive&gt;</span><br><span class="line">&lt;text-if-true&gt;</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line"># æè</span><br><span class="line">&lt;conditional-directive&gt;</span><br><span class="line">&lt;text-if-true&gt;</span><br><span class="line">else</span><br><span class="line">&lt;text-if-false&gt;</span><br><span class="line">endif</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>ç¤ºä¾:</strong> ifeqçä¾å­, ifneqåifeqçä½¿ç¨æ¹æ³ç±»ä¼¼, å°±æ¯åå</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">ifeq (&quot;aa&quot;, &quot;bb&quot;)</span><br><span class="line">    @echo &quot;equal&quot;</span><br><span class="line">else</span><br><span class="line">    @echo &quot;not equal&quot;</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">not equal</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>ç¤ºä¾:</strong> ifdefçä¾å­, ifndefåifdefçä½¿ç¨æ¹æ³ç±»ä¼¼, å°±æ¯åå</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">SRCS :&#x3D; program.c</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">ifdef SRCS</span><br><span class="line">    @echo $(SRCS)</span><br><span class="line">else</span><br><span class="line">    @echo &quot;no SRCS&quot;</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">program.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="3-4-Makefile-ä¸­çå½æ°"><a href="#3-4-Makefile-ä¸­çå½æ°" class="headerlink" title="3.4 Makefile ä¸­çå½æ°"></a><strong>3.4 Makefile ä¸­çå½æ°</strong></h3><p>Makefile ä¸­èªå¸¦äºä¸äºå½æ°, å©ç¨è¿äºå½æ°å¯ä»¥ç®å Makefile çç¼å.</p>
<p>å½æ°è°ç¨è¯­æ³å¦ä¸:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(&lt;function&gt; &lt;arguments&gt;)</span><br><span class="line"># æè</span><br><span class="line">$&#123;&lt;function&gt; &lt;arguments&gt;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><function> æ¯å½æ°å</li>
<li><arguments> æ¯å½æ°åæ°</li>
</ul>
<h4 id="3-4-1-å­ç¬¦ä¸²å½æ°"><a href="#3-4-1-å­ç¬¦ä¸²å½æ°" class="headerlink" title="3.4.1 å­ç¬¦ä¸²å½æ°"></a><strong>3.4.1 å­ç¬¦ä¸²å½æ°</strong></h4><p><strong>å­ç¬¦ä¸²æ¿æ¢å½æ°: $(subst ,,)</strong></p>
<p>åè½: æå­ç¬¦ä¸²<text> ä¸­ç <from> æ¿æ¢ä¸º <to></p>
<p>è¿å: æ¿æ¢è¿çå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(subst t,e,maktfilt)  &lt;-- å°tæ¿æ¢ä¸ºe</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">makefile</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>æ¨¡å¼å­ç¬¦ä¸²æ¿æ¢å½æ°: $(patsubst ,,)</strong></p>
<p>åè½: æ¥æ¾<text>ä¸­çåè¯(åè¯ä»¥âç©ºæ ¼â, âtabâ, âæ¢è¡âæ¥åå²) æ¯å¦ç¬¦å <pattern>, ç¬¦åçè¯, ç¨ <replacement> æ¿ä»£.</p>
<p>è¿å: æ¿æ¢è¿çå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(patsubst %.c,%.o,programA.c programB.c)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">programA.o programB.o</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>å»ç©ºæ ¼å½æ°: $(strip )</strong></p>
<p>åè½: å»æ <string> å­ç¬¦ä¸²ä¸­å¼å¤´åç»å°¾çç©ºå­ç¬¦</p>
<p>è¿å: è¢«å»æç©ºæ ¼çå­ç¬¦ä¸²å¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">VAL :&#x3D; &quot;       aa  bb  cc &quot;</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo &quot;å»é¤ç©ºæ ¼å: &quot; $(VAL)</span><br><span class="line">    @echo &quot;å»é¤ç©ºæ ¼å: &quot; $(strip $(VAL))</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">å»é¤ç©ºæ ¼å:         aa  bb  cc </span><br><span class="line">å»é¤ç©ºæ ¼å:   aa bb cc</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>æ¥æ¾å­ç¬¦ä¸²å½æ°: $(findstring ,)</strong></p>
<p>åè½: å¨å­ç¬¦ä¸² <in> ä¸­æ¥æ¾ <find> å­ç¬¦ä¸²</p>
<p>è¿å: å¦ææ¾å°, è¿å <find> å­ç¬¦ä¸², å¦åè¿åç©ºå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">VAL :&#x3D; &quot;       aa  bb  cc &quot;</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(findstring aa,$(VAL))</span><br><span class="line">    @echo $(findstring ab,$(VAL))</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">aa</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>è¿æ»¤å½æ°: $(filter ,)</strong></p>
<p>åè½: ä»¥ <pattern> æ¨¡å¼è¿æ»¤å­ç¬¦ä¸² <text>, <em>ä¿ç</em> ç¬¦åæ¨¡å¼ <pattern> çåè¯, å¯ä»¥æå¤ä¸ªæ¨¡å¼</p>
<p>è¿å: ç¬¦åæ¨¡å¼ <pattern> çå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(filter %.o %.a,program.c program.o program.a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">program.o program.a</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>åè¿æ»¤å½æ°: $(filter-out ,)</strong></p>
<p>åè½: ä»¥ <pattern> æ¨¡å¼è¿æ»¤å­ç¬¦ä¸² <text>, <em>å»é¤</em> ç¬¦åæ¨¡å¼ <pattern> çåè¯, å¯ä»¥æå¤ä¸ªæ¨¡å¼</p>
<p>è¿å: ä¸ç¬¦åæ¨¡å¼ <pattern> çå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(filter-out %.o %.a,program.c program.o program.a)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">program.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>æåºå½æ°: $(sort )</strong></p>
<p>åè½: ç»å­ç¬¦ä¸² <list> ä¸­çåè¯æåº (ååº)</p>
<p>è¿å: æåºåçå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(sort bac abc acb cab)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">abc acb bac cab</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>ååè¯å½æ°: $(word ,)</strong></p>
<p>åè½: åå­ç¬¦ä¸² <text> ä¸­ç ç¬¬<n>ä¸ªåè¯ (nä»1å¼å§)</p>
<p>è¿å: <text> ä¸­çç¬¬<n>ä¸ªåè¯, å¦æ<n> æ¯ <text> ä¸­åè¯ä¸ªæ°è¦å¤§, åè¿åç©ºå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(word 1,aa bb cc dd)</span><br><span class="line">    @echo $(word 5,aa bb cc dd)</span><br><span class="line">    @echo $(word 4,aa bb cc dd)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">aa</span><br><span class="line"></span><br><span class="line">dd</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>ååè¯ä¸²å½æ°: $(wordlist ,,)</strong></p>
<p>åè½: ä»å­ç¬¦ä¸²<text>ä¸­åä»<s>å¼å§å°<e>çåè¯ä¸². <s>å<e>æ¯ä¸ä¸ªæ°å­.</p>
<p>è¿å: ä»<s>å°<e>çå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(wordlist 1,3,aa bb cc dd)</span><br><span class="line">    @echo $(word 5,6,aa bb cc dd)</span><br><span class="line">    @echo $(word 2,5,aa bb cc dd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">aa bb cc</span><br><span class="line"></span><br><span class="line">bb</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>åè¯ä¸ªæ°ç»è®¡å½æ°: $(words )</strong></p>
<p>åè½: ç»è®¡å­ç¬¦ä¸² <text> ä¸­åè¯çä¸ªæ°</p>
<p>è¿å: åè¯ä¸ªæ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(words aa bb cc dd)</span><br><span class="line">    @echo $(words aabbccdd)</span><br><span class="line">    @echo $(words )</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>é¦åè¯å½æ°: $(firstword )</strong></p>
<p>åè½: åå­ç¬¦ä¸² <text> ä¸­çç¬¬ä¸ä¸ªåè¯</p>
<p>è¿å: å­ç¬¦ä¸² <text> ä¸­çç¬¬ä¸ä¸ªåè¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(firstword aa bb cc dd)</span><br><span class="line">    @echo $(firstword aabbccdd)</span><br><span class="line">    @echo $(firstword )</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">aa</span><br><span class="line">aabbccdd</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="3-4-2-æä»¶åå½æ°"><a href="#3-4-2-æä»¶åå½æ°" class="headerlink" title="3.4.2 æä»¶åå½æ°"></a><strong>3.4.2 æä»¶åå½æ°</strong></h4><p><strong>åç®å½å½æ°: $(dir )</strong></p>
<p>åè½: ä»æä»¶ååºå <names> ä¸­ååºç®å½é¨å</p>
<p>è¿å: æä»¶ååºå <names> ä¸­çç®å½é¨å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(dir &#x2F;home&#x2F;a.c .&#x2F;bb.c ..&#x2F;c.c d.c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">&#x2F;home&#x2F; .&#x2F; ..&#x2F; .&#x2F;</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>åæä»¶å½æ°: $(notdir )</strong></p>
<p>åè½: ä»æä»¶ååºå <names> ä¸­ååºéç®å½é¨å</p>
<p>è¿å: æä»¶ååºå <names> ä¸­çéç®å½é¨å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(notdir &#x2F;home&#x2F;a.c .&#x2F;bb.c ..&#x2F;c.c d.c)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">a.c bb.c c.c d.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>ååç¼å½æ°: $(suffix )</strong></p>
<p>åè½: ä»æä»¶ååºå <names> ä¸­ååºåä¸ªæä»¶åçåç¼</p>
<p>è¿å: æä»¶ååºå <names> ä¸­åä¸ªæä»¶åçåç¼, æ²¡æåç¼åè¿åç©ºå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(suffix &#x2F;home&#x2F;a.c .&#x2F;b.o ..&#x2F;c.a d)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">.c .o .a</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>ååç¼å½æ°: $(basename )</strong></p>
<p>åè½: ä»æä»¶ååºå <names> ä¸­ååºåä¸ªæä»¶åçåç¼</p>
<p>è¿å: æä»¶ååºå <names> ä¸­åä¸ªæä»¶åçåç¼, æ²¡æåç¼åè¿åç©ºå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(basename &#x2F;home&#x2F;a.c .&#x2F;b.o ..&#x2F;c.a &#x2F;home&#x2F;.d .e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">&#x2F;home&#x2F;a .&#x2F;b ..&#x2F;c &#x2F;home&#x2F;</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>å åç¼å½æ°: $(addsuffix ,)</strong></p>
<p>åè½: æåç¼ <suffix> å å° <names> ä¸­çæ¯ä¸ªåè¯åé¢</p>
<p>è¿å: å è¿åç¼çæä»¶ååºå</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(addsuffix .c,&#x2F;home&#x2F;a b .&#x2F;c.o ..&#x2F;d.c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">&#x2F;home&#x2F;a.c b.c .&#x2F;c.o.c ..&#x2F;d.c.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>å åç¼å½æ°: $(addprefix ,)</strong></p>
<p>åè½: æåç¼ <prefix> å å° <names> ä¸­çæ¯ä¸ªåè¯åé¢</p>
<p>è¿å: å è¿åç¼çæä»¶ååºå</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(addprefix test_,&#x2F;home&#x2F;a.c b.c .&#x2F;d.c)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">test_&#x2F;home&#x2F;a.c test_b.c test_.&#x2F;d.c</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>è¿æ¥å½æ°: $(join ,)</strong></p>
<p>åè½: <list2> ä¸­å¯¹åºçåè¯å å° <list1> åé¢</p>
<p>è¿å: è¿æ¥åçå­ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    @echo $(join a b c d,1 2 3 4)</span><br><span class="line">    @echo $(join a b c d,1 2 3 4 5)</span><br><span class="line">    @echo $(join a b c d e,1 2 3 4)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">a1 b2 c3 d4</span><br><span class="line">a1 b2 c3 d4 5</span><br><span class="line">a1 b2 c3 d4 e</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="3-4-3-foreach"><a href="#3-4-3-foreach" class="headerlink" title="3.4.3 foreach"></a><strong>3.4.3 foreach</strong></h4><p><strong>è¯­æ³:</strong></p>
<p>$(foreach <var>,<list>,<text>)</p>
<p><strong>ç¤ºä¾:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">targets :&#x3D; a b c d</span><br><span class="line">objects :&#x3D; $(foreach i,$(targets),$(i).o)</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(targets)</span><br><span class="line">    @echo $(objects)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">a b c d</span><br><span class="line">a.o b.o c.o d.o</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="3-4-4-if"><a href="#3-4-4-if" class="headerlink" title="3.4.4 if"></a><strong>3.4.4 if</strong></h4><p>è¿éçifæ¯ä¸ªå½æ°, ååé¢çæ¡ä»¶å¤æ­ä¸ä¸æ ·, åé¢çæ¡ä»¶å¤æ­å±äºMakefileçå³é®å­</p>
<p><strong>è¯­æ³:</strong></p>
<p>$(if <condition>,<then-part>)</p>
<p>$(if <condition>,<then-part>,<else-part>)</p>
<p><strong>ç¤ºä¾:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">val :&#x3D; a</span><br><span class="line">objects :&#x3D; $(if $(val),$(val).o,nothing)</span><br><span class="line">no-objects :&#x3D; $(if $(no-val),$(val).o,nothing)</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(objects)</span><br><span class="line">    @echo $(no-objects)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">a.o</span><br><span class="line">nothing</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="3-4-5-call-åå»ºæ°çåæ°åå½æ°"><a href="#3-4-5-call-åå»ºæ°çåæ°åå½æ°" class="headerlink" title="3.4.5 call - åå»ºæ°çåæ°åå½æ°"></a><strong>3.4.5 call - åå»ºæ°çåæ°åå½æ°</strong></h4><p><strong>è¯­æ³:</strong></p>
<p>$(call <expression>,<parm1>,<parm2>,<parm3>â¦)</p>
<p><strong>ç¤ºä¾:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">log &#x3D; &quot;&#x3D;&#x3D;&#x3D;&#x3D;debug&#x3D;&#x3D;&#x3D;&#x3D;&quot; $(1) &quot;&#x3D;&#x3D;&#x3D;&#x3D;end&#x3D;&#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    @echo $(call log,&quot;æ­£å¨ Make&quot;)</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;debug&#x3D;&#x3D;&#x3D;&#x3D; æ­£å¨ Make &#x3D;&#x3D;&#x3D;&#x3D;end&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="3-4-6-origin-å¤æ­åéçæ¥æº"><a href="#3-4-6-origin-å¤æ­åéçæ¥æº" class="headerlink" title="3.4.6 origin - å¤æ­åéçæ¥æº"></a><strong>3.4.6 origin - å¤æ­åéçæ¥æº</strong></h4><p><strong>è¯­æ³:</strong></p>
<p>$(origin <variable>)</p>
<p>è¿åå¼æå¦ä¸ç±»å:</p>
<table>
<thead>
<tr>
<th><strong>ç±»å</strong></th>
<th><strong>å«ä¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td>undefined</td>
<td><variable> æ²¡æå®ä¹è¿</td>
</tr>
<tr>
<td>default</td>
<td><variable> æ¯ä¸ªé»è®¤çå®ä¹, æ¯å¦ CC åé</td>
</tr>
<tr>
<td>environment</td>
<td><variable> æ¯ä¸ªç¯å¢åé, å¹¶ä¸ makeæ¶æ²¡æä½¿ç¨ -e åæ°</td>
</tr>
<tr>
<td>file</td>
<td><variable> å®ä¹å¨Makefileä¸­</td>
</tr>
<tr>
<td>command line</td>
<td><variable> å®ä¹å¨å½ä»¤è¡ä¸­</td>
</tr>
<tr>
<td>override</td>
<td><variable> è¢« override éæ°å®ä¹è¿</td>
</tr>
<tr>
<td>automatic</td>
<td><variable> æ¯èªå¨ååé</td>
</tr>
</tbody></table>
<p><strong>ç¤ºä¾:</strong></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Makefile åå®¹</span></span><br><span class="line">val-in-file := test-file</span><br><span class="line"><span class="keyword">override</span> val-override := test-override</span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> not-define)</span>    <span class="comment"># not-define æ²¡æå®ä¹</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> CC)</span>            <span class="comment"># CC æ¯Makefileé»è®¤å®ä¹çåé</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> PATH)</span>         <span class="comment"># PATH æ¯ bash ç¯å¢åé</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> val-in-<span class="built_in">file</span>)</span>    <span class="comment"># æ­¤Makefileä¸­å®ä¹çåé</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> val-in-cmd)</span>    <span class="comment"># è¿ä¸ªåéä¼å å¨ make çåæ°ä¸­</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> val-override)</span> <span class="comment"># æ­¤Makefileä¸­å®ä¹çoverrideåé</span></span><br><span class="line">    @echo <span class="variable">$(<span class="built_in">origin</span> @)</span>             <span class="comment"># èªå¨åé, å·ä½åé¢çä»ç»</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bash ä¸­æ§è¡ make</span></span><br><span class="line">$ make val-in-cmd=val-cmd</span><br><span class="line">undefined</span><br><span class="line">default</span><br><span class="line">environment</span><br><span class="line">file</span><br><span class="line">command line</span><br><span class="line"><span class="keyword">override</span></span><br><span class="line">automatic</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h4 id="3-4-7-shell"><a href="#3-4-7-shell" class="headerlink" title="3.4.7 shell"></a><strong>3.4.7 shell</strong></h4><p><strong>è¯­æ³:</strong></p>
<p>$(shell <shell command>)</p>
<p>å®çä½ç¨å°±æ¯æ§è¡ä¸ä¸ªshellå½ä»¤, å¹¶å°shellå½ä»¤çç»æä½ä¸ºå½æ°çè¿å.</p>
<p>ä½ç¨å <code>&lt;shell command&gt;</code> ä¸æ ·, <strong>`</strong> æ¯åå¼å·</p>
<h4 id="3-4-8-make-æ§å¶å½æ°"><a href="#3-4-8-make-æ§å¶å½æ°" class="headerlink" title="3.4.8 make æ§å¶å½æ°"></a><strong>3.4.8 make æ§å¶å½æ°</strong></h4><p><strong>äº§çä¸ä¸ªè´å½éè¯¯: $(error )</strong></p>
<p>åè½: è¾åºéè¯¯ä¿¡æ¯, åæ­¢Makefileçè¿è¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    $(error there is an error!)</span><br><span class="line">    @echo &quot;è¿éä¸ä¼æ§è¡!&quot;</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">Makefile:2: *** there is an error!.  Stop.</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<p><strong>è¾åºè­¦å: $(warning )</strong></p>
<p>åè½: è¾åºè­¦åä¿¡æ¯, Makefileç»§ç»­è¿è¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Makefile åå®¹</span><br><span class="line">all:</span><br><span class="line">    $(warning there is an warning!)</span><br><span class="line">    @echo &quot;è¿éä¼æ§è¡!&quot;</span><br><span class="line"></span><br><span class="line"># bash ä¸­æ§è¡ make</span><br><span class="line">$ make</span><br><span class="line">Makefile:2: there is an warning!</span><br><span class="line">è¿éä¼æ§è¡!</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="å¤å¶ä»£ç "></a></p>
<h3 id="3-5-Makefileä¸­ä¸äºGNUçº¦å®ä¿æçä¼ªç®æ "><a href="#3-5-Makefileä¸­ä¸äºGNUçº¦å®ä¿æçä¼ªç®æ " class="headerlink" title="3.5 Makefileä¸­ä¸äºGNUçº¦å®ä¿æçä¼ªç®æ "></a><strong>3.5 Makefileä¸­ä¸äºGNUçº¦å®ä¿æçä¼ªç®æ </strong></h3><p>å¦ææè¿å¨Linuxä¸, ä»æºç å®è£è½¯ä»¶çç»åçè¯, å°±ä¼å¯¹ make clean, make install æ¯è¾çæ.</p>
<p>å clean, install è¿äºä¼ªç®æ , å¹¿ä¸ºäººç¥, ä¸ç¨è§£éå°±å¤§å®¶ç¥éæ¯ä»ä¹ææäº.</p>
<p>ä¸é¢åä¸¾ä¸äºå¸¸ç¨çä¼ªç®æ , å¦æå¨èªå·±é¡¹ç®çMakefileåçä½¿ç¨è¿äºä¼ªç®æ çè¯, å¯ä»¥è®©æä»¬èªå·±çMakefileçèµ·æ¥æ´ä¸ä¸, åµåµ :)</p>
<table>
<thead>
<tr>
<th><strong>ä¼ªç®æ </strong></th>
<th><strong>å«ä¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td>all</td>
<td>ææç®æ çç®æ ï¼å¶åè½ä¸è¬æ¯ç¼è¯ææçç®æ </td>
</tr>
<tr>
<td>clean</td>
<td>å é¤ææè¢«makeåå»ºçæä»¶</td>
</tr>
<tr>
<td>install</td>
<td>å®è£å·²ç¼è¯å¥½çç¨åºï¼å¶å®å°±æ¯æç®æ å¯æ§è¡æä»¶æ·è´å°æå®çç®å½ä¸­å»</td>
</tr>
<tr>
<td>print</td>
<td>ååºæ¹åè¿çæºæä»¶</td>
</tr>
<tr>
<td>tar</td>
<td>ææºç¨åºæåå¤ä»½. ä¹å°±æ¯ä¸ä¸ªtaræä»¶</td>
</tr>
<tr>
<td>dist</td>
<td>åå»ºä¸ä¸ªåç¼©æä»¶, ä¸è¬æ¯ætaræä»¶åæZæä»¶. ææ¯gzæä»¶</td>
</tr>
<tr>
<td>TAGS</td>
<td>æ´æ°ææçç®æ , ä»¥å¤å®æ´å°éç¼è¯ä½¿ç¨</td>
</tr>
<tr>
<td>check æ test</td>
<td>ä¸è¬ç¨æ¥æµè¯makefileçæµç¨</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/Makefile-tutorial/" data-id="ckmn1li29000ln8a8fqtr577b" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-gitignoreä½¿ç¨æ¹æ³" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/gitignore%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T06:02:27.796Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="gitignoreä½¿ç¨æ¹æ³"><a href="#gitignoreä½¿ç¨æ¹æ³" class="headerlink" title=".gitignoreä½¿ç¨æ¹æ³"></a>.gitignoreä½¿ç¨æ¹æ³</h1><h2 id="gitå¿½ç¥æä»¶çåå"><a href="#gitå¿½ç¥æä»¶çåå" class="headerlink" title="gitå¿½ç¥æä»¶çåå"></a>gitå¿½ç¥æä»¶çåå</h2><ul>
<li><p>å¿½ç¥æä½ç³»ç»èªå¨çæçæä»¶ï¼æ¯å¦ç¼©ç¥å¾ç­ï¼</p>
</li>
<li><p>å¿½ç¥ç¼è¯çæçä¸­é´æä»¶ãå¯æ§è¡æä»¶ç­ï¼ä¹å°±æ¯å¦æä¸ä¸ªæä»¶æ¯éè¿å¦ä¸ä¸ªæä»¶èªå¨çæçï¼é£èªå¨çæçæä»¶å°±æ²¡å¿è¦æ¾è¿çæ¬åºï¼æ¯å¦Javaç¼è¯äº§çç.classæä»¶ï¼</p>
</li>
<li><p>å¿½ç¥ä½ èªå·±çå¸¦æææä¿¡æ¯çéç½®æä»¶ï¼æ¯å¦å­æ¾å£ä»¤çéç½®æä»¶ã </p>
</li>
</ul>
<h2 id="gitå¿½ç¥è§åçä¼åçº§"><a href="#gitå¿½ç¥è§åçä¼åçº§" class="headerlink" title="gitå¿½ç¥è§åçä¼åçº§"></a>gitå¿½ç¥è§åçä¼åçº§</h2><p>å¨ .gitingore æä»¶ä¸­ï¼æ¯ä¸è¡æå®ä¸ä¸ªå¿½ç¥è§åï¼Gitæ£æ¥å¿½ç¥è§åçæ¶åæå¤ä¸ªæ¥æºï¼å®çä¼åçº§å¦ä¸ï¼ç±é«å°ä½ï¼ï¼</p>
<ul>
<li>ä»å½ä»¤è¡ä¸­è¯»åå¯ç¨çå¿½ç¥è§å</li>
<li>å½åç®å½å®ä¹çè§å</li>
<li>ç¶çº§ç®å½å®ä¹çè§åï¼ä¾æ¬¡éæ¨</li>
<li>$GIT_DIR/info/exclude æä»¶ä¸­å®ä¹çè§å</li>
<li>core.excludesfileä¸­å®ä¹çå¨å±è§å </li>
</ul>
<h2 id="gitignoreå¿½ç¥è§åçå¹éè¯­æ³"><a href="#gitignoreå¿½ç¥è§åçå¹éè¯­æ³" class="headerlink" title=".gitignoreå¿½ç¥è§åçå¹éè¯­æ³"></a>.gitignoreå¿½ç¥è§åçå¹éè¯­æ³</h2><p>å¨ .gitignore æä»¶ä¸­ï¼æ¯ä¸è¡çå¿½ç¥è§åçè¯­æ³å¦ä¸ï¼</p>
<ul>
<li>ç©ºæ ¼ä¸å¹éä»»ææä»¶ï¼å¯ä½ä¸ºåéç¬¦ï¼å¯ç¨åææ è½¬ä¹</li>
<li>ä»¥âï¼âå¼å¤´çè¡é½ä¼è¢« Git å¿½ç¥ãå³#å¼å¤´çæä»¶æ è¯æ³¨éï¼å¯ä»¥ä½¿ç¨åææ è¿è¡è½¬ä¹ã</li>
<li>å¯ä»¥ä½¿ç¨æ åçglobæ¨¡å¼å¹éãæè°çglobæ¨¡å¼æ¯æshellæä½¿ç¨çç®åäºçæ­£åè¡¨è¾¾å¼ã</li>
<li>ä»¥ææ â/âå¼å¤´è¡¨ç¤ºç®å½ï¼â/âç»æçæ¨¡å¼åªå¹éæä»¶å¤¹ä»¥åå¨è¯¥æä»¶å¤¹è·¯å¾ä¸çåå®¹ï¼ä½æ¯ä¸å¹éè¯¥æä»¶ï¼â/âå¼å§çæ¨¡å¼å¹éé¡¹ç®æ ¹ç®å½ï¼å¦æä¸ä¸ªæ¨¡å¼ä¸åå«ææ ï¼åå®å¹éç¸å¯¹äºå½å .gitignore æä»¶è·¯å¾çåå®¹ï¼å¦æè¯¥æ¨¡å¼ä¸å¨ .gitignore æä»¶ä¸­ï¼åç¸å¯¹äºé¡¹ç®æ ¹ç®å½ã</li>
<li>ä»¥æå·â*âééå¤ä¸ªå­ç¬¦ï¼å³å¹éå¤ä¸ªä»»æå­ç¬¦ï¼ä½¿ç¨ä¸¤ä¸ªæå·â**â è¡¨ç¤ºå¹éä»»æä¸­é´ç®å½ï¼æ¯å¦a/**/zå¯ä»¥å¹é a/z, a/b/z æ a/b/c/zç­ã</li>
<li>ä»¥é®å·â?âééåä¸ªå­ç¬¦ï¼å³å¹éä¸ä¸ªä»»æå­ç¬¦ï¼</li>
<li>ä»¥æ¹æ¬å·â[]âåå«åä¸ªå­ç¬¦çå¹éåè¡¨ï¼å³å¹éä»»ä½ä¸ä¸ªåå¨æ¹æ¬å·ä¸­çå­ç¬¦ãæ¯å¦[abc]è¡¨ç¤ºè¦ä¹å¹éä¸ä¸ªaï¼è¦ä¹å¹éä¸ä¸ªbï¼è¦ä¹å¹éä¸ä¸ªcï¼å¦æå¨æ¹æ¬å·ä¸­ä½¿ç¨ç­åçº¿åéä¸¤ä¸ªå­ç¬¦ï¼è¡¨ç¤ºææå¨è¿ä¸¤ä¸ªå­ç¬¦èå´åçé½å¯ä»¥å¹éãæ¯å¦[0-9]è¡¨ç¤ºå¹éææ0å°9çæ°å­ï¼[a-z]è¡¨ç¤ºå¹éä»»æçå°åå­æ¯ã</li>
<li>ä»¥å¹å·â!âè¡¨ç¤ºä¸å¿½ç¥(è·è¸ª)å¹éå°çæä»¶æç®å½ï¼å³è¦å¿½ç¥æå®æ¨¡å¼ä»¥å¤çæä»¶æç®å½ï¼å¯ä»¥å¨æ¨¡å¼åå ä¸æå¹å·ï¼!ï¼ååãéè¦ç¹å«æ³¨æçæ¯ï¼å¦ææä»¶çç¶ç®å½å·²ç»è¢«åé¢çè§åæé¤æäºï¼é£ä¹å¯¹è¿ä¸ªæä»¶ç¨â!âè§åæ¯ä¸èµ·ä½ç¨çããå¯ä»¥ä½¿ç¨åææ è¿è¡è½¬ä¹ã</li>
</ul>
<p>éè¦è°¨è®°ï¼gitå¯¹äº.ignoreéç½®æä»¶æ¯æè¡ä»ä¸å°ä¸è¿è¡è§åå¹éçï¼æå³çå¦æåé¢çè§åå¹éçèå´æ´å¤§ï¼ååé¢çè§åå°ä¸ä¼çæï¼</p>
<h2 id="gitignoreå¿½ç¥è§åç®åè¯´æ"><a href="#gitignoreå¿½ç¥è§åç®åè¯´æ" class="headerlink" title=".gitignoreå¿½ç¥è§åç®åè¯´æ"></a>.gitignoreå¿½ç¥è§åç®åè¯´æ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#        		è¡¨ç¤ºæ­¤ä¸ºæ³¨é,å°è¢«Gitå¿½ç¥</span><br><span class="line">*.a       		è¡¨ç¤ºå¿½ç¥ææ .a ç»å°¾çæä»¶</span><br><span class="line">!lib.a     		è¡¨ç¤ºlib.aé¤å¤</span><br><span class="line">&#x2F;TODO      		è¡¨ç¤ºä»ä»å¿½ç¥é¡¹ç®æ ¹ç®å½ä¸ç TODO æä»¶ï¼ä¸åæ¬ subdir&#x2F;TODO</span><br><span class="line">build&#x2F;     		è¡¨ç¤ºå¿½ç¥ build&#x2F;ç®å½ä¸çæææä»¶ï¼è¿æ»¤æ´ä¸ªbuildæä»¶å¤¹ï¼</span><br><span class="line">doc&#x2F;*.txt    	è¡¨ç¤ºä¼å¿½ç¥doc&#x2F;notes.txtä½ä¸åæ¬ doc&#x2F;server&#x2F;arch.txt</span><br><span class="line">bin&#x2F;:      		è¡¨ç¤ºå¿½ç¥å½åè·¯å¾ä¸çbinæä»¶å¤¹ï¼è¯¥æä»¶å¤¹ä¸çææåå®¹é½ä¼è¢«å¿½ç¥ï¼ä¸å¿½ç¥ bin æä»¶</span><br><span class="line">&#x2F;bin:      		è¡¨ç¤ºå¿½ç¥æ ¹ç®å½ä¸çbinæä»¶</span><br><span class="line">&#x2F;*.c:      		è¡¨ç¤ºå¿½ç¥æ ¹ç®å½ä¸çcat.cï¼ä¸å¿½ç¥ build&#x2F;cat.c</span><br><span class="line">debug&#x2F;*.obj:  	è¡¨ç¤ºå¿½ç¥debug&#x2F;io.objï¼ä¸å¿½ç¥ debug&#x2F;common&#x2F;io.objåtools&#x2F;debug&#x2F;io.obj</span><br><span class="line">**&#x2F;foo:     	è¡¨ç¤ºå¿½ç¥&#x2F;foo,a&#x2F;foo,a&#x2F;b&#x2F;fooç­</span><br><span class="line">a&#x2F;**&#x2F;b:     	è¡¨ç¤ºå¿½ç¥a&#x2F;b, a&#x2F;x&#x2F;b,a&#x2F;x&#x2F;y&#x2F;bç­</span><br><span class="line">!&#x2F;bin&#x2F;run.sh  	è¡¨ç¤ºä¸å¿½ç¥binç®å½ä¸çrun.shæä»¶</span><br><span class="line">*.log:     		è¡¨ç¤ºå¿½ç¥ææ .log æä»¶</span><br><span class="line">config.php:   	è¡¨ç¤ºå¿½ç¥å½åè·¯å¾ç config.php æä»¶</span><br><span class="line"></span><br><span class="line">&#x2F;mtk&#x2F;			è¡¨ç¤ºè¿æ»¤æ´ä¸ªæä»¶å¤¹</span><br><span class="line">*.zip      		è¡¨ç¤ºè¿æ»¤ææ.zipæä»¶</span><br><span class="line">&#x2F;mtk&#x2F;do.c    	è¡¨ç¤ºè¿æ»¤æä¸ªå·ä½æä»¶</span><br><span class="line"></span><br><span class="line">è¢«è¿æ»¤æçæä»¶å°±ä¸ä¼åºç°å¨gitä»åºä¸­ï¼gitlabægithubï¼äºï¼å½ç¶æ¬å°åºä¸­è¿æï¼åªæ¯pushçæ¶åä¸ä¼ä¸ä¼ ãéè¦æ³¨æçæ¯ï¼gitignoreè¿å¯ä»¥æå®è¦å°åªäºæä»¶æ·»å å°çæ¬ç®¡çä¸­ï¼å¦ä¸ï¼</span><br><span class="line">!*.zip</span><br><span class="line">!&#x2F;mtk&#x2F;one.txt</span><br><span class="line">å¯ä¸çåºå«å°±æ¯è§åå¼å¤´å¤äºä¸ä¸ªæå¹å·ï¼Gitä¼å°æ»¡è¶³è¿ç±»è§åçæä»¶æ·»å å°çæ¬ç®¡çä¸­ãä¸ºä»ä¹è¦æä¸¤ç§è§åå¢ï¼</span><br><span class="line">æ³è±¡ä¸ä¸ªåºæ¯ï¼åå¦æä»¬åªéè¦ç®¡ç&#x2F;mtk&#x2F;ç®å½ä¸­çone.txtæä»¶ï¼è¿ä¸ªç®å½ä¸­çå¶ä»æä»¶é½ä¸éè¦ç®¡çï¼é£ä¹.gitignoreè§ååºåä¸ºï¼ï¼</span><br><span class="line">&#x2F;mtk&#x2F;*</span><br><span class="line">!&#x2F;mtk&#x2F;one.txt</span><br><span class="line">åè®¾æä»¬åªæè¿æ»¤è§åï¼èæ²¡ææ·»å è§åï¼é£ä¹æä»¬å°±éè¦æ&#x2F;mtk&#x2F;ç®å½ä¸é¤äºone.txtä»¥å¤çæææä»¶é½ååºæ¥ï¼</span><br><span class="line">æ³¨æä¸é¢ç&#x2F;mtk&#x2F;*ä¸è½åä¸º&#x2F;mtk&#x2F;ï¼å¦åç¶ç®å½è¢«åé¢çè§åæé¤æäºï¼one.txtæä»¶è½ç¶å äº!è¿æ»¤è§åï¼ä¹ä¸ä¼çæï¼å³ç¶ç®å½è¢«æé¤ï¼åï¼ä¸çæï¼ä½å½åç®å½æææä»¶è¢«æé¤ï¼ï¼ä»æ§çæï¼æä½¿ç¨ï¼åéè¦ç¡®è®¤ç¶ç®å½æ²¡æè¢«æé¤ï¼å¦æå½åç®å½çå¶ä»æä»¶é½éè¦æé¤ï¼å¯ä»¥ä½¿ç¨&#x2F;*çæ¹å¼æé¤å½åç®å½ä¸çæææä»¶ï¼åä½¿ç¨ï¼æ·»å ã</span><br><span class="line"></span><br><span class="line">è¿æä¸äºè§åå¦ä¸ï¼</span><br><span class="line">fd1&#x2F;*</span><br><span class="line">è¯´æï¼å¿½ç¥ç®å½ fd1 ä¸çå¨é¨åå®¹ï¼æ³¨æï¼ä¸ç®¡æ¯æ ¹ç®å½ä¸ç&#x2F;fd1&#x2F;ç®å½ï¼è¿æ¯æä¸ªå­ç®å½ &#x2F;child&#x2F;fd1&#x2F;ç®å½ï¼é½ä¼è¢«å¿½ç¥ï¼</span><br><span class="line">&#x2F;fd1&#x2F;*</span><br><span class="line">è¯´æï¼å¿½ç¥æ ¹ç®å½ä¸ç&#x2F;fd1&#x2F;ç®å½çå¨é¨åå®¹ï¼</span><br><span class="line">&#x2F;*</span><br><span class="line">!.gitignore</span><br><span class="line">!&#x2F;fw&#x2F;</span><br><span class="line">&#x2F;fw&#x2F;*</span><br><span class="line">!&#x2F;fw&#x2F;bin&#x2F;</span><br><span class="line">!&#x2F;fw&#x2F;sf&#x2F;</span><br><span class="line">è¯´æï¼å¿½ç¥å¨é¨åå®¹ï¼ä½æ¯ä¸å¿½ç¥ .gitignore æä»¶ãæ ¹ç®å½ä¸ç&#x2F;fw&#x2F;bin&#x2F;å&#x2F;fw&#x2F;sf&#x2F;ç®å½ï¼æ³¨æè¦åå¯¹bin&#x2F;çç¶ç®å½ä½¿ç¨!è§åï¼ä½¿å¶ä¸è¢«æé¤ã</span><br></pre></td></tr></table></figure>

<p> <strong>æ¸©é¦¨æç¤ºï¼</strong><br>å¦æä½ ä¸æå¨åå»º.gitignoreæä»¶ä¹åå°±pushäºé¡¹ç®ï¼é£ä¹å³ä½¿ä½ å¨.gitignoreæä»¶ä¸­åå¥æ°çè¿æ»¤è§åï¼è¿äºè§åä¹ä¸ä¼èµ·ä½ç¨ï¼Gitä»ç¶ä¼å¯¹æææä»¶è¿è¡çæ¬ç®¡çãç®åæ¥è¯´åºç°è¿ç§é®é¢çåå å°±æ¯Gitå·²ç»å¼å§ç®¡çè¿äºæä»¶äºï¼æä»¥ä½ æ æ³åéè¿è¿æ»¤è§åè¿æ»¤å®ä»¬ã.gitignoreåªè½å¿½ç¥é£äºåæ¥æ²¡æè¢«è¿½è¸ªçæä»¶ï¼å¦ææäºæä»¶å·²ç»è¢«çº³å¥äºçæ¬ç®¡çä¸­ï¼åä¿®æ¹.gitignoreæ¯æ æçãé£ä¹è§£å³æ¹æ³å°±æ¯åææ¬å°ç¼å­å é¤ï¼æ¹åææªè¢«è¿½è¸ªç¶æï¼ï¼ç¶ååæäº¤ï¼</p>
<p>git rm -r âcached .</p>
<p>git add .</p>
<p>git commit -m âupdate .gitignoreâ</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/24/gitignore%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" data-id="ckmn1lhzj0004n8a815nbcc4v" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/24/Python%20Cheatsheet/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/03/24/Python%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/03/24/tofino-command/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/03/24/%E5%AE%89%E8%A3%85mininet%E5%92%8Ctofino-model/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/03/24/TNA%20model/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 xbo<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>